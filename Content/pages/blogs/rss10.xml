<?xml version="1.0"?>
<rdf:RDF
	xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:foaf="http://xmlns.com/foaf/0.1/"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns="http://purl.org/rss/1.0/"
>
<channel rdf:about="http://www.cl.cam.ac.uk/projects/ocamllabs/blogs">
	<title>OCaml Labs updates</title>
	<link>http://www.cl.cam.ac.uk/projects/ocamllabs/blogs</link>
	<description>OCaml Labs updates - http://www.cl.cam.ac.uk/projects/ocamllabs/blogs</description>

	<items>
		<rdf:Seq>
			<rdf:li rdf:resource="http://openmirage.org/blog/welcome-to-our-summer-hackers" />
			<rdf:li rdf:resource="http://amirchaudhry.com/writing-planet-in-pure-ocaml" />
			<rdf:li rdf:resource="http://ocamllabs.github.com/compiler-hacking/2014/04/24/fifth-compiler-hacking-session" />
			<rdf:li rdf:resource="http://openmirage.org/blog/applying-for-gsoc2014" />
			<rdf:li rdf:resource="http://openmirage.org/blog/mirage-1.1-released" />
			<rdf:li rdf:resource="http://ocamllabs.github.com/compiler-hacking/2014/02/11/fourth-compiler-hacking-session" />
			<rdf:li rdf:resource="http://ocamllabs.github.com/compiler-hacking/2014/02/04/handler-case" />
			<rdf:li rdf:resource="http://pw374.github.io/posts/2014-01-06-09-24-25-functional-visitors.html" />
			<rdf:li rdf:resource="http://openmirage.org/blog/decks-n-drums" />
			<rdf:li rdf:resource="http://www.cl.cam.ac.uk/projects/ocamllabs/news/2013-12-29" />
			<rdf:li rdf:resource="http://openmirage.org/blog/mirage-1.0.3-released" />
			<rdf:li rdf:resource="http://openmirage.org/blog/announcing-mirage10" />
			<rdf:li rdf:resource="http://amirchaudhry.com/switching-from-bootstrap-to-zurb-foundation" />
			<rdf:li rdf:resource="http://amirchaudhry.com/announcing-new-ocamlorg" />
			<rdf:li rdf:resource="http://amirchaudhry.com/migration-plan-ocaml-org" />
			<rdf:li rdf:resource="http://ocamllabs.github.com/compiler-hacking/2013/10/30/third-compiler-hacking-session" />
			<rdf:li rdf:resource="http://amirchaudhry.com/fpdays-review" />
			<rdf:li rdf:resource="http://amirchaudhry.com/fpdays-ocaml-session" />
			<rdf:li rdf:resource="http://anil.recoil.org/2013/10/08/fpdays-real-world-ocaml" />
			<rdf:li rdf:resource="http://pw374.github.io/posts/2013-10-07-12-56-46-highpower-LEDs-for-superbright-light.html" />
			<rdf:li rdf:resource="http://anil.recoil.org/2013/10/06/travis-secure-ssh-integration" />
			<rdf:li rdf:resource="http://pw374.github.io/posts/2013-10-04-13-31-30-example-use-case-of-MPP.html" />
			<rdf:li rdf:resource="http://pw374.github.io/posts/2013-10-03-20-39-07-OPAMaging-MPP.html" />
			<rdf:li rdf:resource="http://pw374.github.io/posts/2013-10-03-20-35-12-using-mpp-two-different-ways.html" />
			<rdf:li rdf:resource="http://anil.recoil.org/2013/10/03/merlin-and-vim" />
			<rdf:li rdf:resource="http://www.syslog.cl.cam.ac.uk/?p=1562" />
			<rdf:li rdf:resource="http://anil.recoil.org/2013/09/30/travis-and-ocaml" />
			<rdf:li rdf:resource="http://pw374.github.io/posts/2013-09-26-20-15-24-odd-or-even.html" />
			<rdf:li rdf:resource="http://pw374.github.io/posts/2013-09-25-16-19-07-ones-or-zeros.html" />
			<rdf:li rdf:resource="http://www.syslog.cl.cam.ac.uk/?p=1461" />
			<rdf:li rdf:resource="http://pw374.github.io/posts/2013-09-24-14-19-56-on-the-implementation-of-opamdoc.html" />
			<rdf:li rdf:resource="http://amirchaudhry.com/ocamlorg-request-for-feedback" />
			<rdf:li rdf:resource="http://pw374.github.io/posts/2013-09-24-01-50-14-opamdoc-take1.html" />
			<rdf:li rdf:resource="http://www.syslog.cl.cam.ac.uk/?p=1347" />
			<rdf:li rdf:resource="http://anil.recoil.org/2013/09/20/opam-1-1-beta" />
			<rdf:li rdf:resource="http://hh360.user.srcf.net/blog/?p=352" />
			<rdf:li rdf:resource="http://ocamllabs.github.com/compiler-hacking/2013/09/17/compiler-hacking-july-2013" />
			<rdf:li rdf:resource="http://anil.recoil.org/2013/09/16/camlpdf-the-end-of-sucky-pdf-tools" />
			<rdf:li rdf:resource="http://hh360.user.srcf.net/blog/?p=153" />
			<rdf:li rdf:resource="http://anil.recoil.org/2013/09/09/ocamlot-autotriaging" />
		</rdf:Seq>
	</items>
</channel>

<item rdf:about="http://openmirage.org/blog/welcome-to-our-summer-hackers">
	<title>MirageOS: Welcome to the summer Mirage hackers</title>
	<link>http://openmirage.org/blog/welcome-to-our-summer-hackers</link>
	<content:encoded>&lt;div&gt;
      &lt;p&gt;Following our participation in the &lt;a href=&quot;http://openmirage.org/blog/applying-for-gsoc2014&quot;&gt;Google Summer of Code&lt;/a&gt; program, we've now finalised selections.  We've also got a number of other visitors joining us to hack on Mirage over the summer time, so here are introductions!&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;strong&gt;SSL support&lt;/strong&gt;: &lt;a href=&quot;https://github.com/hannesm&quot;&gt;Hannes Mehnert&lt;/a&gt; and &lt;a href=&quot;https://github.com/pqwy&quot;&gt;David Kaloper&lt;/a&gt; have been working hard on a safe &lt;a href=&quot;https://github.com/mirleft/ocaml-tls&quot;&gt;OCaml TLS&lt;/a&gt; implementation. They're going to hack on &lt;a href=&quot;https://github.com/mirage/mirage/issues/242&quot;&gt;integrating it all&lt;/a&gt; into working under Xen so we can make HTTPS requests (and our Twitter bot will finally be able to tweet!).  Both are also interested in formal verification of the result, and several loooong conversations with &lt;a href=&quot;http://www.cl.cam.ac.uk/~pes20/&quot;&gt;Peter Sewell&lt;/a&gt; will magically transform into machine specifications by summer's end, I'm reliably informed.&lt;/li&gt;
 &lt;li&gt;&lt;strong&gt;Cloud APIs&lt;/strong&gt;: &lt;a href=&quot;http://1000hippos.wordpress.com/&quot;&gt;Jyotsna Prakash&lt;/a&gt; will spend her summer break as part of &lt;a href=&quot;http://www.google-melange.com/gsoc/org2/google/gsoc2014/xen_project&quot;&gt;Google Summer of Code&lt;/a&gt; working on improving cloud provider APIs in OCaml (modelled from her notes on how the &lt;a href=&quot;https://github.com/avsm/ocaml-github&quot;&gt;GitHub&lt;/a&gt; bindings &lt;a href=&quot;http://1000hippos.wordpress.com/2014/04/24/ocaml-github/&quot;&gt;are built&lt;/a&gt;).  This will let the &lt;code&gt;mirage&lt;/code&gt; command-line tool have much more natural integration with remote cloud providers for executing the unikernels straight from a command-line.  If you see Jyotsna wandering around aimlessly muttering darkly about HTTP, JSON and REST, then the project is going well.&lt;/li&gt;
 &lt;li&gt;&lt;strong&gt;Network Stack fuzzing&lt;/strong&gt;: &lt;a href=&quot;http://www.somerandomidiot.com/&quot;&gt;Mindy Preston&lt;/a&gt; joins us for the summer after her &lt;a href=&quot;https://www.hackerschool.com/&quot;&gt;Hacker School&lt;/a&gt; stay, courtesy of the &lt;a href=&quot;https://opw.gnome.org&quot;&gt;OPW&lt;/a&gt; program.  She's been delving into the network stack running on EC2 and figuring out how to debug issues when the unikernel is running a cloud far, far away (see the post series here: &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/03/14/its-a-mirage/&quot;&gt;1&lt;/a&gt;, &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/03/24/advancing-toward-the-mirage/&quot;&gt;2&lt;/a&gt;, &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/04/02/tying-the-knot/&quot;&gt;3&lt;/a&gt;, &lt;a href=&quot;http://www.somerandomidiot.com/blog/2014/03/24/arriving-at-the-mirage/&quot;&gt;4&lt;/a&gt;).&lt;/li&gt;
 &lt;li&gt;&lt;strong&gt;Visualization&lt;/strong&gt;: &lt;a href=&quot;http://erratique.ch/contact.en&quot;&gt;Daniel Buenzli&lt;/a&gt; returns to Cambridge this summer to continue his work on extremely succinctly named graphics libaries.  His &lt;a href=&quot;https://github.com/dbuenzli/vz&quot;&gt;Vz&lt;/a&gt;, &lt;a href=&quot;https://github.com/dbuenzli/vg&quot;&gt;Vg&lt;/a&gt; and &lt;a href=&quot;https://github.com/dbuenzli/gg&quot;&gt;Gg&lt;/a&gt; libaries build a set of primitives for 2D graphics programming.  Since the libraries compile to JavaScript, we're planning to use this as the basis for &lt;a href=&quot;http://erratique.ch/software/vg/demos/rhtmlc&quot;&gt;visualization&lt;/a&gt; of Mirage applications via a built-in webserver.&lt;/li&gt;
 &lt;li&gt;&lt;strong&gt;Modular implicits&lt;/strong&gt;: &lt;a href=&quot;https://github.com/def-lkb&quot;&gt;Frederic Bour&lt;/a&gt;, author of the popular &lt;a href=&quot;https://github.com/the-lambda-church/merlin&quot;&gt;Merlin&lt;/a&gt; IDE tool is also in Cambridge this summer working on adding modular implicits to the core OCaml language. Taking inspiration from &lt;a href=&quot;http://www.mpi-sws.org/~dreyer/papers/mtc/main-long.pdf&quot;&gt;Modular Type-classes&lt;/a&gt; and Scala's &lt;a href=&quot;http://twitter.github.io/scala_school/advanced-types.html&quot;&gt;implicits&lt;/a&gt;,  modular implcits allow functions to take implicit module arguments which will be filled-in by the compiler by searching the environment for a module with the appropriate type. This enables ad-hoc polymorphism in a very similar way to Haskell's type classes.&lt;/li&gt;
 &lt;li&gt;&lt;strong&gt;Irminsule storage algorithms&lt;/strong&gt;: Benjamin Farinier (from &lt;a href=&quot;http://www.ens-lyon.eu/&quot;&gt;ENS Lyon&lt;/a&gt;) and Matthieu Journault (from &lt;a href=&quot;http://www.ens-cachan.fr/&quot;&gt;ENS Cachan&lt;/a&gt;) will work on datastructures for the &lt;a href=&quot;https://github.com/samoht/irminsule/wiki/Getting-Started&quot;&gt;Irminsule&lt;/a&gt; storage system that the next version of Mirage will use.  They'll be grabbing copies of the &lt;a href=&quot;http://www.amazon.co.uk/Purely-Functional-Structures-Chris-Okasaki/dp/0521663504&quot;&gt;Okasaki&lt;/a&gt; classic text and porting some of them into a branch-consistent form.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Of course, work continues apace by the rest of the team as usual, with a &lt;a href=&quot;http://www.openmirage.org/releases&quot;&gt;steady stream of releases&lt;/a&gt; that are building up to some exciting new features.  We'll be blogging about ARM support, PVHVM, Irminsule storage and SSL integration just as soon as they're pushed into the stable branches.  As always, &lt;a href=&quot;http://www.openmirage.org/community/&quot;&gt;get in touch&lt;/a&gt; via the IRC channel (&lt;code&gt;#mirage&lt;/code&gt; on Freenode) or the mailing lists with questions.&lt;/p&gt;

   &lt;/div&gt;</content:encoded>
	<dc:date>2014-05-08T18:00:00+00:00</dc:date>
	<dc:creator>Anil Madhavapeddy</dc:creator>
</item>
<item rdf:about="http://amirchaudhry.com/writing-planet-in-pure-ocaml">
	<title>Amir Chaudhry: Writing Planet in pure OCaml</title>
	<link>http://amirchaudhry.com/writing-planet-in-pure-ocaml</link>
	<content:encoded>&lt;p&gt;I've been learning OCaml for some time now but not really had a problem that
I wanted to solve. As such, my progress has been rather slow and sporadic
and I only make time for exercises when I'm travelling. In order to focus my
learning, I have to identify and tackle something specific. That's usually
the best way to advance and I recently found something I can work on.&lt;/p&gt;

&lt;p&gt;As I've been trying to write more blog posts, I want to be able to keep as
much content on my own site as possible and syndicate my posts out to other
sites I run. Put simply, I want to be able to take multiple feeds from
different sources and merge them into one feed, which will be served from
some other site. In addition, I also want to render that feed as HTML on a
webpage. All of this has to remain within the OCaml toolchain so it can be
used as part of &lt;a href=&quot;http://openmirage.org/&quot;&gt;Mirage&lt;/a&gt; (i.e. I can use it when
&lt;a href=&quot;http://amirchaudhry.com/from-jekyll-to-unikernel-in-fifty-lines&quot;&gt;building unikernels&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;What I'm describing might sound familiar and there's a well-known tool that
does this called &lt;a href=&quot;http://en.wikipedia.org/wiki/Planet_(software)&quot;&gt;Planet&lt;/a&gt;. It's a 'river of news' feed reader, which
aggregates feeds and can display posts on webpages and you can find the
&lt;a href=&quot;http://www.planetplanet.org&quot;&gt;original Planet&lt;/a&gt; and it's successor &lt;a href=&quot;http://intertwingly.net/code/venus/docs/index.html&quot;&gt;Venus&lt;/a&gt;, both written in Python.
However, Venus seems to be unmaintained as there are a number of
&lt;a href=&quot;https://github.com/rubys/venus/issues&quot;&gt;unresolved issues and pull requests&lt;/a&gt;, which have been
languishing for quite some time with no discussion. There does appear to be
a more active Ruby implementation called &lt;a href=&quot;http://feedreader.github.io/&quot;&gt;Pluto&lt;/a&gt;, with recent commits and
no reported issues.&lt;/p&gt;

&lt;!-- 
    \[Rant: Frankly, the naming of these versions leaves a lot to be desired.
    When you know exactly what you're supposed to Google for you're fine, but
    until then you're just on a random-walk through space websites. I'm
    lucky I managed to get to the Wikipedia page.\] 
--&gt;


&lt;h3&gt;Benefits of a Planet in pure OCaml&lt;/h3&gt;

&lt;p&gt;Although I could use the one of the above options, it would be much more
useful to keep everything within the OCaml ecosystem.  This way I can make
the best use of the &lt;a href=&quot;https://queue.acm.org/detail.cfm?id=2566628&quot;&gt;unikernel approach&lt;/a&gt; with Mirage (i.e lean,
single-purpose appliances). Obviously, the existing options don't lend
themselves to this approach and there are &lt;a href=&quot;https://forge.ocamlcore.org/tracker/index.php?func=detail&amp;aid=1349&amp;group_id=1&amp;atid=101&quot;&gt;known bugs&lt;/a&gt; as a lot has
changed on the web since Planet Venus (e.g the adoption of HTML5).
Having said that, I can learn a lot from the existing implementations and
I'm glad I'm not embarking into completely uncharted territory.&lt;/p&gt;

&lt;p&gt;In addition, the OCaml version doesn't need to (and &lt;em&gt;shouldn't&lt;/em&gt;) be written
as one monolithic library.  Instead, pulling together a collection of
smaller, reusable libraries that present clear interfaces to each other
would make things much more maintainable. This would bring substantially
greater benefits to everyone and &lt;a href=&quot;https://opam.ocaml.org/&quot;&gt;OPAM&lt;/a&gt; can manage the dependencies.&lt;/p&gt;

&lt;!--
    OPAM makes managing dependencies easy so having a number of single-
    purpose libraries is A Good Thing and costs almost nothing.  This 
    approach has already worked well with examples like an [IP address 
    library][ipaddr] and the [OCaml markdown library][OMD], which can be 
    used by multiple projects.
--&gt;


&lt;h3&gt;Breaking down the problem&lt;/h3&gt;

&lt;p&gt;The first cut is somewhat straightforward as we have a piece that deals with
the consumption and manipulation of feeds and another that takes the result
and emits HTML. This is also how the original Planet is put together, with a
library called &lt;a href=&quot;https://pypi.python.org/pypi/feedparser/&quot;&gt;feedparser&lt;/a&gt; and another for templating pages.&lt;/p&gt;

&lt;p&gt;For the feed-parsing aspect, I can break it down further by considering Atom
and RSS feeds separately and then even further by thinking about how to (1)
consume such feeds and (2) output them. Then there is the HTML component,
where it may be necessary to consider existing representations of HTML. These
are not new ideas and since I'm claiming that individual pieces might be
useful then it's worth finding out which ones are already available.&lt;/p&gt;

&lt;h4&gt;Existing components&lt;/h4&gt;

&lt;p&gt;The easiest way to find existing libraries is via the
&lt;a href=&quot;http://opam.ocaml.org/packages&quot;&gt;OPAM package list&lt;/a&gt;. Some quick searches for &lt;code&gt;RSS&lt;/code&gt;, &lt;code&gt;XML&lt;/code&gt;, &lt;code&gt;HTML&lt;/code&gt;
and &lt;code&gt;net&lt;/code&gt; bring up a lot of packages. The most relevant of these seem to be
&lt;a href=&quot;https://opam.ocaml.org/packages/xmlm/xmlm.1.2.0/&quot;&gt;xmlm&lt;/a&gt;, &lt;a href=&quot;https://opam.ocaml.org/packages/ocamlrss/ocamlrss.2.2.2/&quot;&gt;ocamlrss&lt;/a&gt;, &lt;a href=&quot;https://opam.ocaml.org/packages/cow/cow.0.9.1/&quot;&gt;cow&lt;/a&gt; and maybe &lt;a href=&quot;http://opam.ocaml.org/packages/xmldiff/xmldiff.0.1/&quot;&gt;xmldiff&lt;/a&gt;. I noticed that
nothing appears, when searching for &lt;code&gt;Atom&lt;/code&gt;, but I do know that &lt;code&gt;cow&lt;/code&gt; has an
Atom module for creating feeds. In terms of turning feeds into pages and
HTML, I'm aware of &lt;a href=&quot;https://github.com/ocaml/ocaml.org/blob/master/script/rss2html.ml&quot;&gt;rss2html&lt;/a&gt; used on the &lt;a href=&quot;http://ocaml.org&quot;&gt;OCaml&lt;/a&gt; website and parts of
&lt;a href=&quot;http://opam.ocaml.org/packages/ocamlnet/ocamlnet.3.7.3/&quot;&gt;ocamlnet&lt;/a&gt; that may be relevant (e.g &lt;code&gt;nethtml&lt;/code&gt; and &lt;code&gt;netstring&lt;/code&gt;) as well as
&lt;code&gt;cow&lt;/code&gt;.  There is likely to be other code I'm missing but this is useful as a
first pass.&lt;/p&gt;

&lt;p&gt;Overall, a number of components are already out there but it's not obvious
if they're compatible (e.g html) and there are still gaps (e.g atom). Since
I also want to minimise dependencies, I'll try and use whatever works but
may ultimately have to roll my own. Either way, I can learn from what
already exists. Perhaps I'm being overconfident but if I can break things
down sensibly and keep the scope constrained then this should be an
achievable project.&lt;/p&gt;

&lt;h3&gt;The first (baby) steps - an Atom parser&lt;/h3&gt;

&lt;p&gt;As this is an exercise for me to learn OCaml by solving a problem, I need to
break it down into bite-size pieces and take each one at a time. Practically
speaking, this means limiting the scope to be as narrow as possible while
still producing a useful result &lt;em&gt;for me&lt;/em&gt;.  That last part is important as I
have specific needs and it's likely that the first thing I make won't be
particularly interesting for many others.&lt;/p&gt;

&lt;p&gt;For my specific use-case, I'm only interested in dealing with Atom feeds as
that's what I use on my site and others I'm involved with. Initial feedback
is that creating an Atom parser will be the bulk of the work and I should
start by defining the types. To keep this manageable, I'm only going to deal
with my own feeds instead of attempting a fully compliant parser (in other
words, I'll only consider the subset of &lt;a href=&quot;https://tools.ietf.org/html/rfc4287&quot;&gt;RFC4287&lt;/a&gt; that's relevant to me).
Once I can parse, merge and write such feeds I should be able to iterate
from there.&lt;/p&gt;

&lt;p&gt;To make my requirements more concrete:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Only consider &lt;em&gt;my own&lt;/em&gt; Atom feeds for now&lt;/li&gt;
&lt;li&gt;Initially, be able to parse and emit just one Atom feed&lt;/li&gt;
&lt;li&gt;Then be able to merge 2+ feeds, specifically:

&lt;ul&gt;
&lt;li&gt;Use tag-based feeds from my personal site as starting points&lt;/li&gt;
&lt;li&gt;Be able to de-dupe content&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;No database or storage (construct it afresh every time)&lt;/li&gt;
&lt;li&gt;Minimise library dependencies&lt;/li&gt;
&lt;/ul&gt;


&lt;!-- 
    Perhaps these requirements are already too much and I may decide to dial
    it down even further (e.g just figure out how to consume *one* feed),
    but I won't really know until I get started. For example, I can imagine
    that I'll need one bunch of code to deal with Atom feeds and then
    perhaps I can make another (feedparser), that depends on it and others
    to deal with general feeds.
--&gt;


&lt;h4&gt;Timeframes and workflow&lt;/h4&gt;

&lt;p&gt;I've honestly no idea how long this might take and I'm treating it as a
side-project. I know there are many people out there who could produce a
working version of everything in a week or two but I'm not one of them (yet).
There are also &lt;em&gt;a lot&lt;/em&gt; of ancillary things I need to learn on the way, like
packaging, improving my knowledge of Git and dealing with build systems. If
I had to put a vague time frame on this, I'd be thinking in months rather
than weeks.  It might even be the case that others start work on parts of
this and ship things sooner but that's great as I'll probably be able to use
whatever they create and move further along the chain.&lt;/p&gt;

&lt;p&gt;In terms of workflow, everything will be done in the open, warts and all, and
I expect to make embarrassing mistakes as I go. You can follow along on my
freshly created &lt;a href=&quot;https://github.com/amirmc/ocamlatom&quot;&gt;OCaml Atom&lt;/a&gt; repo, and I'll be using the issue tracker as
the main way of dealing with bugs and features. Let the fun begin.&lt;/p&gt;

&lt;!-- acknowledgements --&gt;


&lt;hr /&gt;

&lt;p&gt;&lt;em&gt;Acknowledgements:&lt;/em&gt; Thanks to &lt;a href=&quot;http://erratique.ch&quot;&gt;Daniel&lt;/a&gt;, &lt;a href=&quot;http://ashishagarwal.org&quot;&gt;Ashish&lt;/a&gt;, &lt;a href=&quot;https://github.com/Chris00&quot;&gt;Christophe&lt;/a&gt;,
&lt;a href=&quot;http://philippewang.info/&quot;&gt;Philippe&lt;/a&gt; and &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas&lt;/a&gt; for discussions on an earlier draft of this post
and providing feedback on my approach.&lt;/p&gt;

&lt;!-- links --&gt;</content:encoded>
	<dc:date>2014-04-29T09:30:00+00:00</dc:date>
</item>
<item rdf:about="http://ocamllabs.github.com/compiler-hacking/2014/04/24/fifth-compiler-hacking-session">
	<title>Compiler Hacking: Fifth OCaml compiler hacking session</title>
	<link>http://ocamllabs.github.com/compiler-hacking/2014/04/24/fifth-compiler-hacking-session.html</link>
	<content:encoded>&lt;p&gt;It's time for the fifth Cambridge OCaml compiler-hacking session!  We'll be meeting in the &lt;a href=&quot;http://www.cl.cam.ac.uk/&quot;&gt;Computer Lab&lt;/a&gt; again next Tuesday evening.&lt;/p&gt;

&lt;p&gt;If you're planning to come along, it'd be helpful if you could &lt;a href=&quot;http://doodle.com/iapgw89dvmxhnb4e&quot;&gt;&lt;em&gt;indicate interest via Doodle&lt;/em&gt;&lt;/a&gt; and &lt;a href=&quot;http://lists.ocaml.org/listinfo/cam-compiler-hacking&quot;&gt;&lt;em&gt;sign up to the mailing list&lt;/em&gt;&lt;/a&gt; to receive updates:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Where&lt;/em&gt;: Room &lt;a href=&quot;http://www.cl.cam.ac.uk/research/dtg/openroommap/static/?s=FW11&amp;labels=1&quot;&gt;FW11&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/directions/&quot;&gt;Computer Laboratory, Madingley Road&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;When&lt;/em&gt;: 6pm, Tuesday 29th April&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Who&lt;/em&gt;: anyone interested in improving OCaml. Knowledge of OCaml programming will obviously be helpful, but prior experience of working on OCaml internals isn't necessary.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;What&lt;/em&gt;: fixing bugs, implementing new features, learning about OCaml internals&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Wiki&lt;/em&gt;: &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki&quot;&gt;https://github.com/ocamllabs/compiler-hacking/wiki&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We're defining &amp;quot;compiler&amp;quot; pretty broadly, to include anything that's part of the standard distribution, which means at least the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/libref/index.html&quot;&gt;standard library&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual024.html&quot;&gt;runtime&lt;/a&gt;, tools (&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/depend.html&quot;&gt;ocamldep&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc105&quot;&gt;ocamllex&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc107&quot;&gt;ocamlyacc&lt;/a&gt;, etc.), &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual032.html&quot;&gt;ocamlbuild&lt;/a&gt;, the &lt;a href=&quot;http://caml.inria.fr/resources/doc/index.en.html&quot;&gt;documentation&lt;/a&gt;, and the compiler itself. We'll have suggestions for &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;mini-projects&lt;/a&gt; for various levels of experience (see also some &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-previously-worked-on&quot;&gt;things we've worked on in previous sessions&lt;/a&gt;), but feel free to come along and work on whatever you fancy.&lt;/p&gt;

&lt;p&gt;We'll also be ordering pizza, so if you want to be counted for food you should aim to arrive by 6.30pm.&lt;/p&gt;</content:encoded>
	<dc:date>2014-04-24T00:16:01+00:00</dc:date>
	<dc:creator>OCaml Labs</dc:creator>
</item>
<item rdf:about="http://openmirage.org/blog/applying-for-gsoc2014">
	<title>MirageOS: MirageOS is in Google Summer of Code 2014</title>
	<link>http://openmirage.org/blog/applying-for-gsoc2014</link>
	<content:encoded>&lt;div&gt;
      &lt;p&gt;MirageOS will part of the &lt;a href=&quot;https://www.google-melange.com/gsoc/homepage/google/gsoc2014&quot;&gt;Google Summer of Code&lt;/a&gt; 2014
program, thanks to the Xen Project's participation!  It's been a few years
since I've mentored for GSoc, but I still have fond memories of some great
projects in the past (such as the legendary &lt;a href=&quot;http://vmgl.sourceforge.net/&quot;&gt;Quake testing&lt;/a&gt;
we were forced to do for hours on end).  I've already received a number of
queries about this year's program from potential students, so here's a few
things to note to become a successful applicant.&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;p&gt;Students still need to apply and be accepted. Your chances of being
 selected are much higher if you demonstrate some participation and
 code contributions (even minor) &lt;em&gt;before&lt;/em&gt; submitting an application.
 Thus, even if you don't have a copy of Xen around, roll up your sleeves
 and head over to the &lt;a href=&quot;http://openmirage.org/wiki/install&quot;&gt;installation instructions&lt;/a&gt;.&lt;/p&gt;
 &lt;/li&gt;
 &lt;li&gt;&lt;p&gt;Contributions do not have to be just code.  They can be documentation,
 help with packaging, wiki posts about a particular use, or test cases
 to improve code coverage.&lt;/p&gt;
 &lt;/li&gt;
 &lt;li&gt;&lt;p&gt;It's unlikely that we'll get students who are very familiar with both
 OCaml and Xen (if you are, definitely get in touch with us!).  You should
 therefore look over the &lt;a href=&quot;http://wiki.xen.org/wiki/GSoc_2014#Mirage_OS&quot;&gt;project ideas&lt;/a&gt;
 as a set of guidelines and not firm suggestions.  If you have a particular
 thing you'd like to do with Mirage (for example, work on the JavaScript
 backend, an &lt;a href=&quot;https://github.com/andrewray/iocamljs&quot;&gt;IPython interface&lt;/a&gt; or
 a particular protocol implementation such as XMPP, then that's fine.  Just
 get in touch with us on the &lt;a href=&quot;http://openmirage.org/community&quot;&gt;mailing lists&lt;/a&gt; or directly via
 e-mail, and we can work through them.&lt;/p&gt;
 &lt;/li&gt;
 &lt;li&gt;&lt;p&gt;Under some circumstances, we can provide resources such as a login to
 a Xen machine, or delegated credits on a cloud provider.  Don't let that
 stop you from applying for a project idea.  In general though, it's best
 to only depend on your own computer resources if practical to do so.&lt;/p&gt;
 &lt;/li&gt;
&lt;/ul&gt;

   &lt;/div&gt;</content:encoded>
	<dc:date>2014-02-25T18:00:00+00:00</dc:date>
	<dc:creator>Anil Madhavapeddy</dc:creator>
</item>
<item rdf:about="http://openmirage.org/blog/mirage-1.1-released">
	<title>MirageOS: Mirage 1.1.0: the eat-your-own-dogfood release</title>
	<link>http://openmirage.org/blog/mirage-1.1-released</link>
	<content:encoded>&lt;div&gt;
      &lt;p&gt;We've just released &lt;a href=&quot;https://github.com/ocaml/opam-repository/pull/1655&quot;&gt;Mirage 1.1.0&lt;/a&gt; into OPAM.  Once the
live site updates, you should be able to run &lt;code&gt;opam update -u&lt;/code&gt; and get the latest
version.  This release is the &quot;&lt;a href=&quot;http://en.wikipedia.org/wiki/Eating_your_own_dog_food&quot;&gt;eat our own
dogfood&lt;/a&gt;&quot; release; as I
mentioned earlier in January, a number of the Mirage developers have decided to
shift our own personal homepages onto Mirage.  There's nothing better than
using our own tools to find all the little annoyances and shortcomings, and so
Mirage 1.1.0 contains some significant usability and structural improvements
for building unikernels.&lt;/p&gt;
&lt;h4 id=&quot;Functionalcombinatorstobuilddevicedrivers&quot;&gt;Functional combinators to build device drivers&lt;/h4&gt;
&lt;p&gt;Mirage separates the
application logic from the concrete backend in use by writing the application
as an &lt;a href=&quot;https://realworldocaml.org/v1/en/html/functors.html&quot;&gt;OCaml functor&lt;/a&gt;
that is parameterized over module types that represent the device driver
signature.  All of the module types used in Mirage can be browsed in &lt;a href=&quot;https://github.com/mirage/mirage/blob/1.1.0/types/V1.mli&quot;&gt;one
source file&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In Mirage 1.1.0, &lt;a href=&quot;http://gazagnaire.org/&quot;&gt;Thomas Gazagnaire&lt;/a&gt; implemented a
a &lt;a href=&quot;https://github.com/mirage/mirage/blob/1.1.0/lib/mirage.mli#L28&quot;&gt;combinator library&lt;/a&gt;
that makes it easy to separate the definition of application logic from the details
of the device drivers that actually execute the code (be it a Unix binary or a
dedicated Xen kernel).  It lets us write code of this form
(taken from &lt;a href=&quot;https://github.com/mirage/mirage-skeleton/tree/master/block&quot;&gt;mirage-skeleton/block&lt;/a&gt;):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;let () =
  let main = foreign &quot;Unikernel.Block_test&quot; (console @-&amp;gt; block @-&amp;gt; job) in
  let img = block_of_file &quot;disk.img&quot; in
  register &quot;block_test&quot; [main $ default_console $ img]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In this configuration fragment, our unikernel is defined as a functor over a
console and a block device by using &lt;code&gt;console @-&amp;gt; block @-&amp;gt; job&lt;/code&gt;.  We then
define a concrete version of this job by applying the functor (using the &lt;code&gt;$&lt;/code&gt;
combinator) to a default console and a file-backed disk image.&lt;/p&gt;
&lt;p&gt;The combinator approach lets us express complex assemblies of device driver
graphs by writing normal OCaml code, and the &lt;code&gt;mirage&lt;/code&gt; command line tool
parses this at build-time and generates a &lt;code&gt;main.ml&lt;/code&gt; file that has all the
functors applied to the right device drivers. Any mismatches in module signatures
will result in a build error, thus helping to spot nonsensical combinations
(such as using a Unix network socket in a Xen unikernel).&lt;/p&gt;
&lt;p&gt;This new feature is walked through in the &lt;a href=&quot;http://openmirage.org/docs/hello-world&quot;&gt;tutorial&lt;/a&gt;, which
now walks you through several skeleton examples to explain all the different
deployment scenarios.  It's also followed by the &lt;a href=&quot;http://openmirage.org/docs/mirage-www&quot;&gt;website tutorial&lt;/a&gt;
that explains how this website works, and how our &lt;a href=&quot;http://openmirage.org/docs/deploying-via-ci&quot;&gt;Travis autodeployment&lt;/a&gt;
throws the result onto the public Internet.&lt;/p&gt;
&lt;p&gt;Who will win the race to get our website up and running first?  Sadly for Anil,
&lt;a href=&quot;http://www.cs.nott.ac.uk/~rmm/&quot;&gt;Mort&lt;/a&gt; is currently &lt;a href=&quot;https://github.com/mor1/mort-www&quot;&gt;in the
lead&lt;/a&gt; with an all-singing, all-dancing shiny
new website.  Will he finish in the lead though? Stay tuned!&lt;/p&gt;
&lt;h4 id=&quot;Lessmagicinthebuild&quot;&gt;Less magic in the build&lt;/h4&gt;
&lt;p&gt;Something that's more behind-the-scenes, but important for easier development,
is a simplication in how we build libraries.  In Mirage 1.0, we had several
packages that couldn't be simultaneously installed, as they had to be compiled 
in just the right order to ensure dependencies.&lt;/p&gt;
&lt;p&gt;With Mirage 1.1.0, this is all a thing of the past.  All the libraries can
be installed fully in parallel, including the network stack.  The 1.1.0
&lt;a href=&quot;https://github.com/mirage/mirage-tcpip&quot;&gt;TCP/IP stack&lt;/a&gt; is now built in the
style of the venerable &lt;a href=&quot;http://www.cs.cmu.edu/~fox/foxnet.html&quot;&gt;FoxNet&lt;/a&gt; network
stack, and is parameterized across its network dependencies.  This means
that once can quickly assemble a custom network stack from modular components,
such as this little fragment below from &lt;a href=&quot;https://github.com/mirage/mirage-skeleton/blob/master/ethifv4/unikernel.ml&quot;&gt;mirage-skeleton/ethifv4/&lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;module Main (C: CONSOLE) (N: NETWORK) = struct

  module E = Ethif.Make(N)
  module I = Ipv4.Make(E)
  module U = Udpv4.Make(I)
  module T = Tcpv4.Flow.Make(I)(OS.Time)(Clock)(Random)
  module D = Dhcp_clientv4.Make(C)(OS.Time)(Random)(E)(I)(U)
  &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This functor stack starts with a &lt;code&gt;NETWORK&lt;/code&gt; (i.e. Ethernet) device, and then applies
functors until it ends up with a UDPv4, TCPv4 and DHCPv4 client.  See the &lt;a href=&quot;https://github.com/mirage/mirage-skeleton/blob/master/ethifv4/unikernel.ml&quot;&gt;full
file&lt;/a&gt;
to see how the rest of the logic works, but this serves to illustrate how
Mirage makes it possible to build custom network stacks out of modular
components.  The functors also make it easier to embed the network stack in
non-Mirage applications, and the &lt;code&gt;tcpip&lt;/code&gt; OPAM package installs pre-applied Unix
versions for your toplevel convenience.&lt;/p&gt;
&lt;p&gt;To show just how powerful the functor approach is, the same stack can also
be mapped onto a version that uses kernel sockets simply by abstracting the
lower-level components into an equivalent that uses the Unix kernel to provide
the same functionality.  We explain how to swap between these variants in
the &lt;a href=&quot;http://openmirage.org/wiki/hello-world&quot;&gt;tutorials&lt;/a&gt;.&lt;/p&gt;
&lt;h4 id=&quot;Lotsoflibraryreleases&quot;&gt;Lots of library releases&lt;/h4&gt;
&lt;p&gt;While doing the 1.1.0 release in January, we've also released quite a few libraries
into &lt;a href=&quot;https://opam.ocaml.org&quot;&gt;OPAM&lt;/a&gt;.  Here are some of the highlights.&lt;/p&gt;
&lt;p&gt;Low-level libraries:&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/samoht/ocaml-mstruct/&quot;&gt;mstruct&lt;/a&gt; is a streaming layer for handling lists of memory buffers with a simpler read/write interface.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/xapi-project/nbd/&quot;&gt;nbd&lt;/a&gt; is an implementation of the &lt;a href=&quot;http://en.wikipedia.org/wiki/Network_block_device&quot;&gt;Network Block Device&lt;/a&gt; protocol for block drivers.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Networking and web libraries:&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/mirage/ocaml-ipaddr&quot;&gt;ipaddr&lt;/a&gt; now has IPv6 parsing support thanks to &lt;a href=&quot;https://github.com/hhugo/&quot;&gt;Hugo Heuzard&lt;/a&gt; and David Sheets.  This is probably the hardest bit of adding IPv6 support to our network stack!&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/mirage/cowabloga&quot;&gt;cowabloga&lt;/a&gt; is slowly emerging as a library to handle the details of rendering Zurb Foundation websites.  It's still in active development, but being used for a few of our &lt;a href=&quot;https://github.com/mor1/mort-www&quot;&gt;personal websites&lt;/a&gt; as well as this website.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/avsm/ocaml-cohttp&quot;&gt;cohttp&lt;/a&gt; has had several releases thanks to external contributions, particular from &lt;a href=&quot;https://github.com/rgrinberg&quot;&gt;Rudy Grinberg&lt;/a&gt; who added s-expression support and several &lt;a href=&quot;https://github.com/avsm/ocaml-cohttp/blob/master/CHANGES&quot;&gt;other improvements&lt;/a&gt;.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/avsm/ocaml-uri&quot;&gt;uri&lt;/a&gt; features performance improvements and the elimination of Scanf (considered &lt;a href=&quot;http://www.lexifi.com/blog/note-about-performance-printf-and-format&quot;&gt;rather slow&lt;/a&gt; by OCaml standards).&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/mirage/ocaml-cow&quot;&gt;cow&lt;/a&gt; continues its impossible push to make coding HTML and CSS a pleasant experience, with better support for Markdown now.&lt;/li&gt;
 &lt;li&gt;The &lt;a href=&quot;https://github.com/avsm/ocaml-github&quot;&gt;github&lt;/a&gt; bindings are now also in use as part of an experiment to make &lt;a href=&quot;http://gallium.inria.fr/blog/patch-review-on-github/&quot;&gt;upstream OCaml development&lt;/a&gt; easier for newcomers, thanks to Gabriel Scherer.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; led the splitting up of several low-level Xen libraries as part of the build simplication.  These now compile on both Xen (using the direct hypercall interface) and Unix (using the dom0 &lt;code&gt;/dev&lt;/code&gt; devices) where possible.&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/xapi-project/ocaml-evtchn&quot;&gt;xen-evtchn&lt;/a&gt; for the event notification mechanism. There are a couple of wiki posts that explain how &lt;a href=&quot;http://openmirage.org/wiki/xen-events&quot;&gt;event channels&lt;/a&gt; and &lt;a href=&quot;http://openmirage.org/wiki/xen-suspend&quot;&gt;suspend/resume&lt;/a&gt; work in Mirage/Xen guests.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/xapi-project/ocaml-gnt&quot;&gt;xen-gnt&lt;/a&gt; for the grant table mechanism that controls inter-process memory.&lt;/li&gt;
 &lt;li&gt;The &lt;a href=&quot;https://github.com/mirage/io-page&quot;&gt;io-page&lt;/a&gt; library no longer needs Unix and Xen variants, as the interface has been standardized to work in both.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;All of Dave's hacking on Xen device drivers is showcased in this &lt;a href=&quot;http://openmirage.org/wiki/xen-synthesize-virtual-disk&quot;&gt;xen-disk wiki post&lt;/a&gt; that 
explains how you can synthesize your own virtual disk backends using Mirage.  Xen uses a &lt;a href=&quot;https://www.usenix.org/legacy/event/usenix05/tech/general/full_papers/short_papers/warfield/warfield.pdf&quot;&gt;split device&lt;/a&gt; model,
and now Mirage lets us build &lt;em&gt;backend&lt;/em&gt; device drivers that service VMs as well as the frontends!&lt;/p&gt;
&lt;p&gt;Last, but not least, &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; has been building a brand new storage system for Mirage guests that uses git-style branches under the hood to help coordinate clusters of unikernels.  We'll talk about how this works in a future update, but there are some cool libraries and prototypes available on OPAM for the curious.&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/samoht/ocaml-lazy-trie/&quot;&gt;lazy-trie&lt;/a&gt; is a lazy version of the Trie data structure, useful for exposing Git graphs.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/samoht/ocaml-git&quot;&gt;git&lt;/a&gt; is a now-fairly complete implementation of the Git protocol in pure OCaml, which can interoperate with normal Git servers via the &lt;code&gt;ogit&lt;/code&gt; command-line tool that it installs.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/samoht/irminsule&quot;&gt;irminsule&lt;/a&gt; is the main library that abstracts Git DAGs into an OCaml programming API.  The homepage has &lt;a href=&quot;https://github.com/samoht/irminsule/wiki/Getting-Started&quot;&gt;instructions&lt;/a&gt; on how to play with the command-line frontend to experiment with the database.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/samoht/git2fat&quot;&gt;git2fat&lt;/a&gt; converts a Git checkout into a FAT block image, useful when bundling up unikernels.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We'd also like to thank several conference organizers for giving us the opportunity to demonstrate Mirage.  The talk video from &lt;a href=&quot;http://www.infoq.com/presentations/mirage-os&quot;&gt;QCon SF&lt;/a&gt; is now live, and we also had a &lt;em&gt;great&lt;/em&gt; time at &lt;a href=&quot;http://fosdem.org&quot;&gt;FOSDEM&lt;/a&gt; recently (summarized by Amir &lt;a href=&quot;http://nymote.org/blog/2014/fosdem-summary/&quot;&gt;here&lt;/a&gt;). 
So lots of activities, and no doubt little bugs lurking in places (particularly around installation).  As always, please do let us know of any problem by &lt;a href=&quot;https://github.com/mirage/mirage/issues&quot;&gt;reporting bugs&lt;/a&gt;, or feel free to &lt;a href=&quot;http://openmirage.org/community&quot;&gt;contact us&lt;/a&gt; via our e-mail lists or IRC.  Next stop: our unikernel homepages!&lt;/p&gt;

   &lt;/div&gt;</content:encoded>
	<dc:date>2014-02-11T16:00:00+00:00</dc:date>
	<dc:creator>Anil Madhavapeddy</dc:creator>
</item>
<item rdf:about="http://ocamllabs.github.com/compiler-hacking/2014/02/11/fourth-compiler-hacking-session">
	<title>Compiler Hacking: Fourth OCaml compiler hacking session</title>
	<link>http://ocamllabs.github.com/compiler-hacking/2014/02/11/fourth-compiler-hacking-session.html</link>
	<content:encoded>&lt;p&gt;It's time for the fourth Cambridge OCaml compiler-hacking session!  We'll be meeting in the &lt;a href=&quot;http://www.cl.cam.ac.uk/&quot;&gt;Computer Lab&lt;/a&gt; again next Tuesday evening.&lt;/p&gt;

&lt;p&gt;If you're planning to come along, it'd be helpful if you could &lt;a href=&quot;http://doodle.com/5tk8rs5k3mh82qqx&quot;&gt;&lt;em&gt;indicate interest via Doodle&lt;/em&gt;&lt;/a&gt; and &lt;a href=&quot;http://lists.ocaml.org/listinfo/cam-compiler-hacking&quot;&gt;&lt;em&gt;sign up to the mailing list&lt;/em&gt;&lt;/a&gt; to receive updates:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Where&lt;/em&gt;: Room &lt;a href=&quot;http://www.cl.cam.ac.uk/research/dtg/openroommap/static/?s=FW11&amp;labels=1&quot;&gt;FW11&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/directions/&quot;&gt;Computer Laboratory, Madingley Road&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;When&lt;/em&gt;: 6pm, Tuesday 18th February&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Who&lt;/em&gt;: anyone interested in improving OCaml. Knowledge of OCaml programming will obviously be helpful, but prior experience of working on OCaml internals isn't necessary.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;What&lt;/em&gt;: fixing bugs, implementing new features, learning about OCaml internals&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Wiki&lt;/em&gt;: &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki&quot;&gt;https://github.com/ocamllabs/compiler-hacking/wiki&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We're defining &amp;quot;compiler&amp;quot; pretty broadly, to include anything that's part of the standard distribution, which means at least the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/libref/index.html&quot;&gt;standard library&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual024.html&quot;&gt;runtime&lt;/a&gt;, tools (&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/depend.html&quot;&gt;ocamldep&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc105&quot;&gt;ocamllex&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc107&quot;&gt;ocamlyacc&lt;/a&gt;, etc.), &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual032.html&quot;&gt;ocamlbuild&lt;/a&gt;, the &lt;a href=&quot;http://caml.inria.fr/resources/doc/index.en.html&quot;&gt;documentation&lt;/a&gt;, and the compiler itself. We'll have suggestions for &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;mini-projects&lt;/a&gt; for various levels of experience (see also some &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-previously-worked-on&quot;&gt;things we've worked on in previous sessions&lt;/a&gt;), but feel free to come along and work on whatever you fancy.&lt;/p&gt;

&lt;p&gt;We'll also be ordering pizza, so if you want to be counted for food you should aim to arrive by 6.30pm.&lt;/p&gt;</content:encoded>
	<dc:date>2014-02-11T12:10:29+00:00</dc:date>
	<dc:creator>OCaml Labs</dc:creator>
</item>
<item rdf:about="http://ocamllabs.github.com/compiler-hacking/2014/02/04/handler-case">
	<title>Compiler Hacking: How to handle success</title>
	<link>http://ocamllabs.github.com/compiler-hacking/2014/02/04/handler-case.html</link>
	<content:encoded>&lt;p&gt;(Update: there's a &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6318&quot;&gt;Mantis issue open&lt;/a&gt; to discuss this proposal.)&lt;/p&gt;

&lt;p&gt;OCaml's &lt;code&gt;try&lt;/code&gt; construct is good at dealing with exceptions, but not so good at handling the case where no exception is raised.  This post describes a simple extension to &lt;code&gt;try&lt;/code&gt; that adds support for handling the &amp;quot;success&amp;quot; case.&lt;/p&gt;

&lt;p&gt;Here's an example of code that benefits from the extension.  On a recent &lt;a href=&quot;http://caml.inria.fr/resources/forums.en.html&quot;&gt;caml-list&lt;/a&gt; thread, &lt;a href=&quot;http://cedeela.fr/%7Esimon/&quot;&gt;Simon Cruanes&lt;/a&gt; posted &lt;a href=&quot;https://sympa.inria.fr/sympa/arc/caml-list/2014-01/msg00113.html&quot;&gt;the following function&lt;/a&gt; for iterating over a stream:&lt;/p&gt;

&lt;blockquote&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;MyStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/blockquote&gt;

&lt;p&gt;For each element of a stream, &lt;code&gt;iter_stream&lt;/code&gt; wraps the element with &lt;code&gt;Some&lt;/code&gt;, then unwraps it again and passes it to &lt;code&gt;f&lt;/code&gt;.  At first glance, wrapping and immediately unwrapping in this way seems like needless obfuscation.  However, moving the last two lines out of the body of the &lt;code&gt;try&lt;/code&gt; in this way serves two essential purposes: it turns the recursive call to &lt;code&gt;iter_stream&lt;/code&gt; into a tail call, and it allows exceptions raised by &lt;code&gt;f&lt;/code&gt; to propagate.  More generally, this use of options makes it easy to specify the &lt;em&gt;success continuation&lt;/em&gt; of a &lt;code&gt;try&lt;/code&gt; expression, i.e. the piece of code that receives the value of the body when no exception is raised.&lt;/p&gt;

&lt;p&gt;As Simon notes, the &lt;code&gt;match (try Some ...)&lt;/code&gt; idiom is widely used in OCaml code.  Examples can be found in the source of &lt;a href=&quot;https://github.com/ocsigen/lwt/blob/b63b2a/src/unix/lwt_unix.ml#L118-L125&quot;&gt;lwt&lt;/a&gt;, &lt;a href=&quot;https://github.com/ocaml-batteries-team/batteries-included/blob/92ea390c/benchsuite/bench_nreplace.ml#L45-L48&quot;&gt;batteries&lt;/a&gt;, &lt;a href=&quot;https://github.com/savonet/liquidsoap/blob/a81cd8b6/src/decoder/metadata_decoder.ml#L53-L55&quot;&gt;liquidsoap&lt;/a&gt;, &lt;a href=&quot;https://github.com/janestreet/sexplib/blob/f9bd413/lib/conv.ml#L256-L259&quot;&gt;sexplib&lt;/a&gt;, &lt;a href=&quot;https://github.com/MLstate/opalang/blob/0802728/compiler/opalang/opaParser.ml#L127-L135&quot;&gt;opa&lt;/a&gt;, &lt;a href=&quot;https://github.com/avsm/ocaml-uri/blob/35af64db/lib/uri.ml#L250-L255&quot;&gt;uri&lt;/a&gt;, &lt;a href=&quot;https://github.com/coq/coq/blob/724c9c9f/tools/coqdoc/tokens.ml#L36-L41&quot;&gt;coq&lt;/a&gt;, &lt;a href=&quot;https://github.com/pascal-bach/Unison/blob/4788644/src/ubase/prefs.ml#L97-L106&quot;&gt;unison&lt;/a&gt;, and many other packages.  &lt;/p&gt;

&lt;p&gt;In response to Simon's message, &lt;a href=&quot;http://okmij.org/ftp&quot;&gt;Oleg&lt;/a&gt; pointed out &lt;a href=&quot;https://sympa.inria.fr/sympa/arc/caml-list/2014-01/msg00146.html&quot;&gt;a solution&lt;/a&gt;: the 2001 paper &lt;a href=&quot;http://research.microsoft.com/%7Eakenn/sml/exceptionalsyntax.pdf&quot;&gt;Exceptional Syntax&lt;/a&gt;  (&lt;a href=&quot;http://research.microsoft.com/%7Enick/&quot;&gt;Benton&lt;/a&gt; and &lt;a href=&quot;http://research.microsoft.com/%7Eakenn/&quot;&gt;Kennedy&lt;/a&gt;) extends &lt;code&gt;try&lt;/code&gt; with a &lt;code&gt;let&lt;/code&gt;-like binding construct that supports the success continuation idiom directly without the need for the option value.&lt;/p&gt;

&lt;!-- Perhaps expand on Exceptional Syntax. --&gt;

&lt;p&gt;This post describes a patch to OCaml that implements a variant of Benton and Kennedy's design called &lt;em&gt;handler case&lt;/em&gt;.  Like Exceptional Syntax, handler case extends &lt;code&gt;try&lt;/code&gt; with explicit success continuation handling.  However, unlike Exceptional syntax, handler case uses &lt;code&gt;match&lt;/code&gt; binding for both the success continuation and the exception-handling clauses.  Here's the extended &lt;code&gt;try&lt;/code&gt; syntax:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_1&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_n&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_1'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_1'&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_n'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_n'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As in &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/expr.html#@manual.kwd50&quot;&gt;current OCaml&lt;/a&gt;, the clauses &lt;code&gt;pattern_1 -&amp;gt; expr_1&lt;/code&gt; ... &lt;code&gt;pattern_n -&amp;gt; expr_n&lt;/code&gt; handle exceptions raised during the evaluation of &lt;code&gt;expr&lt;/code&gt;.  The clauses  &lt;code&gt;val pattern_1' -&amp;gt; expr_1'&lt;/code&gt; ... &lt;code&gt;val pattern_n' -&amp;gt; expr_n'&lt;/code&gt; handle the case where no exception is raised; in this case the value of &lt;code&gt;expr&lt;/code&gt; is matched against &lt;code&gt;pattern_1'&lt;/code&gt; ... &lt;code&gt;pattern_n'&lt;/code&gt; to select the expression to evaluate to produce the result value.  (The actual syntax is implemented slightly more permissively: it allows value-matching and exception-matching clauses to be freely interleaved.)&lt;/p&gt;

&lt;p&gt;Using handler case we can rewrite &lt;code&gt;iter_stream&lt;/code&gt; to remove the extraneous option value:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;MyStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We don't need to look far to find other code that benefits from the new construct.  Here's a function from the &lt;a href=&quot;https://github.com/ocaml/ocaml/blob/6a296a02/otherlibs/num/big_int.ml#L323-L328&quot;&gt;Big_int&lt;/a&gt; module in the standard library: &lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_of_big_int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_of_nat&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abs_value&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Failure&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq_big_int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;monster_big_int&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;monster_int&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;failwith&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;int_of_big_int&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The core of the function --- the call to &lt;code&gt;int_of_nat&lt;/code&gt; --- is rather buried in the complex control flow.  There are two &lt;code&gt;if&lt;/code&gt;-&lt;code&gt;then&lt;/code&gt;-&lt;code&gt;else&lt;/code&gt; constructs, a &lt;code&gt;let&lt;/code&gt; binding, and a &lt;code&gt;try&lt;/code&gt; expression with a complex body.  Using handler case we can disentangle the code to make the four possible outcomes from the call to &lt;code&gt;int_of_nat&lt;/code&gt; explicit:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_of_big_int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int_of_nat&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abs_value&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Failure&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eq_big_int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bi&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;monster_big_int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;monster_int&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Failure&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;failwith&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;int_of_big_int&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here's a simpler example from &lt;a href=&quot;https://github.com/ocaml/ocaml/blob/6a296a02/stdlib/string.ml#L195&quot;&gt;the String module&lt;/a&gt;, which also involves code that cannot raise an exception in the body of a &lt;code&gt;try&lt;/code&gt; block:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ignore&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index_rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Not_found&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;false&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Using handler case we can separate the code that may raise an exception (the call to &lt;code&gt;index_rec&lt;/code&gt;) from the expression that produces the result:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index_rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Not_found&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;false&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Trying it out&lt;/h3&gt;

&lt;p&gt;Using &lt;a href=&quot;http://opam.ocaml.org/&quot;&gt;opam&lt;/a&gt; you can install an OCaml compiler extended with handler case as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text language-text&quot;&gt;$ opam remote add ocamllabs git@github.com:ocamllabs/opam-repo-dev.git
ocamllabs Fetching git@github.com:ocamllabs/opam-repo-dev.git
[...]
$ opam switch 4.02.0dev+handler-syntax
# To complete the configuration of OPAM, you need to run:
eval `opam config env`
$ eval `opam config env`
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;js&lt;em&gt;of&lt;/em&gt;ocaml&lt;/h4&gt;

&lt;p&gt;You can also try out the handler case construct in your browser, using the following modified version of &lt;a href=&quot;http://www.ocamlpro.com/&quot;&gt;OCamlPro&lt;/a&gt;'s &lt;a href=&quot;http://try.ocamlpro.com/&quot;&gt;Try OCaml&lt;/a&gt; application:&lt;/p&gt;

&lt;h3&gt;The discoveries of success continuations&lt;/h3&gt;

&lt;p&gt;As &lt;a href=&quot;http://homepages.inf.ed.ac.uk/wadler&quot;&gt;Philip Wadler&lt;/a&gt; &lt;a href=&quot;http://wadler.blogspot.co.uk/2008/02/great-minds-think-alike.html&quot;&gt;notes&lt;/a&gt;, constructs for handling success continuations have been independently discovered multiple times.  In fact, the history goes back even further than described in Wadler's blog; constructs like handler case date back over thirty years and have been introduced, apparently independently, into at least four languages.  Curiously, all the languages use &lt;code&gt;let&lt;/code&gt;-binding for success continuations and &lt;code&gt;match&lt;/code&gt; binding for failure continuations.&lt;/p&gt;

&lt;h4&gt;Lisp&lt;/h4&gt;

&lt;p&gt;In &lt;a href=&quot;http://www.lispworks.com/documentation/HyperSpec/Front/&quot;&gt;Common Lisp&lt;/a&gt; the construct analogous to &lt;code&gt;try&lt;/code&gt; is &lt;a href=&quot;http://clhs.lisp.se/Body/m_hand_1.htm&quot;&gt;&lt;code&gt;handler-case&lt;/code&gt;&lt;/a&gt; (from which the construct discussed here borrows its name).  A &lt;code&gt;handler-case&lt;/code&gt; expression has a body and a sequence of clauses which specify how various conditions (exceptions) should be handled.  The special condition specification &lt;code&gt;:no-error&lt;/code&gt; specifies the code to run when no condition is signalled.  The &lt;code&gt;iter_stream&lt;/code&gt; function might be written as follows in Common Lisp:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;common-lisp language-common-lisp&quot;&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;defun&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;iter-stream&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;handler-case&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;get-stream&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;end-of-stream&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:no-error&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;|s'|&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;funcall&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;iter-stream&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;|s'|&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The Common Lisp specification was completed in 1994 but the &lt;code&gt;handler-case&lt;/code&gt; construct and its &lt;code&gt;:no-error&lt;/code&gt; clause were present in some of Common Lisp's progenitors.  The construct was apparently introduced to Symbolics Lisp some time around 1982: it appears in the &lt;a href=&quot;http://bitsavers.informatik.uni-stuttgart.de/pdf/mit/cadr/chinual_5thEd_Jan83/chinualJan83_27_Errors.pdf&quot;&gt;5th edition&lt;/a&gt; of the Lisp Machine manual (January 1983) but not the &lt;a href=&quot;http://bitsavers.trailing-edge.com/pdf/mit/cadr/chinual_4thEd_Jul81.pdf&quot;&gt;4th edition&lt;/a&gt; from 18 months earlier (July 1981).&lt;/p&gt;

&lt;h4&gt;Python&lt;/h4&gt;

&lt;p&gt;Python has supported success continuations in exception handlers since May 1994, when the &lt;code&gt;else&lt;/code&gt; clause was added to &lt;code&gt;try&lt;/code&gt; blocks.  The &lt;a href=&quot;http://hg.python.org/cpython/file/36214c861144/Grammar/Grammar#l9&quot;&gt;Changelog in old versions of the Grammar/Grammar file&lt;/a&gt; has an entry&lt;/p&gt;

&lt;blockquote&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text language-text&quot;&gt;# 3-May-94:
#Added else clause to try-except
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/blockquote&gt;

&lt;p&gt;introduced in a &lt;a href=&quot;http://hg.python.org/cpython/rev/6c0e11b94009&quot;&gt;commit from August 1994&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text language-text&quot;&gt;changeset:   1744:6c0e11b94009
branch:      legacy-trunk
user:        Guido van Rossum &amp;lt;guido@python.org&amp;gt;
date:        Mon Aug 01 11:00:20 1994 +0000
summary:     Bring alpha100 revision back to mainline
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/blockquote&gt;

&lt;p&gt;Unlike the &lt;code&gt;:no-error&lt;/code&gt; clause in Lisp's &lt;code&gt;handler-case&lt;/code&gt;, Python's &lt;code&gt;else&lt;/code&gt; clause doesn't bind variables.  Since Python variables have function scope, not block scope, bindings in the body of the try block are visible throughout the function.  In Python we might write &lt;code&gt;iter_stream&lt;/code&gt; as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;python language-python&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;iter_stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MyStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;End_of_stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The provenance of the &lt;code&gt;else&lt;/code&gt; clause is unclear, but it doesn't seem to derive from Lisp's &lt;code&gt;handler-case&lt;/code&gt;.  The design of Python's exception handling constructs &lt;a href=&quot;http://docs.python.org/3/faq/general.html#why-was-python-created-in-the-first-place&quot;&gt;comes from Modula-3&lt;/a&gt;, but the exception handling construct described in the &lt;a href=&quot;http://www.hpl.hp.com/techreports/Compaq-DEC/SRC-RR-52.pdf&quot;&gt;Modula-3 report&lt;/a&gt; does not include a way of specifying the success continuation.  The syntax of the Modula-3 &lt;code&gt;TRY&lt;/code&gt;/&lt;code&gt;EXCEPT&lt;/code&gt; statement (found on p21 of the report) does include an &lt;code&gt;ELSE&lt;/code&gt; clause:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text language-text&quot;&gt;   TRY    
     Body
   EXCEPT
     id1 (v1) =&amp;gt; Handler1
   | ...
   | idn (vn) =&amp;gt; Handlern
   ELSE Handler0
   END
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;However, whereas Python's &lt;code&gt;else&lt;/code&gt; handles the case where no exception is raised, Modula-3's &lt;code&gt;ELSE&lt;/code&gt; handles the case where an exception not named in one of the &lt;code&gt;EXCEPT&lt;/code&gt; clauses is raised: it is equivalent to Python's catch-all &lt;code&gt;except:&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Python also adds success handlers to other constructs.  Both the &lt;a href=&quot;http://docs.python.org/2/reference/compound_stmts.html#the-for-statement&quot;&gt;&lt;code&gt;for&lt;/code&gt;&lt;/a&gt; and the &lt;a href=&quot;http://docs.python.org/2/reference/compound_stmts.html#the-while-statement&quot;&gt;&lt;code&gt;while&lt;/code&gt;&lt;/a&gt; statements have an optional &lt;code&gt;else&lt;/code&gt; clause which is executed unless the loop terminates prematurely with an exception or &lt;code&gt;break&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;exceptional-syntax&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Exceptional Syntax&lt;/h4&gt;

&lt;p&gt;The 2001 paper &lt;a href=&quot;http://research.microsoft.com/%7Eakenn/sml/exceptionalsyntax.pdf&quot;&gt;Exceptional Syntax&lt;/a&gt; (&lt;a href=&quot;http://research.microsoft.com/%7Enick/&quot;&gt;Benton&lt;/a&gt; and &lt;a href=&quot;http://research.microsoft.com/%7Eakenn/&quot;&gt;Kennedy&lt;/a&gt;) proposed the following construct for handling exceptions in Standard ML:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_1&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_n&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;expr&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;unless&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pattern_1'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_1'&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_n'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_n'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Evaluation of the &lt;code&gt;let&lt;/code&gt; binding proceeds as normal, except that if any of &lt;code&gt;expr_1&lt;/code&gt; to &lt;code&gt;expr_n&lt;/code&gt; raises an exception, control is transferred to the right hand side of the first of the clauses after &lt;code&gt;unless&lt;/code&gt; whose left hand side matches the exception.  The construct is largely similar to our proposed variation, except that the bindings used in the success continuation are based on &lt;code&gt;let&lt;/code&gt;, so scrutinising the values requires a separate &lt;code&gt;case&lt;/code&gt; (i.e. &lt;code&gt;match&lt;/code&gt;) expression.&lt;/p&gt;

&lt;p&gt;Using the Exceptional Syntax construct we might write &lt;code&gt;iter_stream&lt;/code&gt; as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;MyStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;unless&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Exceptional Syntax has been implemented in the SML-to-Java compiler &lt;a href=&quot;http://www.dcs.ed.ac.uk/home/mlj/&quot;&gt;MLj&lt;/a&gt;.&lt;/p&gt;

&lt;h4&gt;Erlang&lt;/h4&gt;

&lt;p&gt;The 2004 paper &lt;a href=&quot;http://erlang.se/workshop/2004/exception.pdf&quot;&gt;Erlang's Exception Handling Revisited&lt;/a&gt; (Richard Carlsson, Björn Gustavsson and Patrik Nyblom) proposed an exception-handling construct for Erlang along the same lines as exceptional syntax, although apparently developed independently.  In the proposed extension to Erlang we might write &lt;code&gt;iter_stream&lt;/code&gt; as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;erlang language-erlang&quot;&gt;&lt;span class=&quot;nf&quot;&gt;iter_stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Mystream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;S_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;S_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;with&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Eff&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://homepages.inf.ed.ac.uk/gdp/&quot;&gt;Plotkin&lt;/a&gt; and &lt;a href=&quot;http://matija.pretnar.info/&quot;&gt;Pretnar&lt;/a&gt;'s work on &lt;a href=&quot;http://matija.pretnar.info/pdf/handling-algebraic-effects.pdf&quot;&gt;handlers for algebraic effects&lt;/a&gt; generalises Exceptional Syntax to support effects other than exceptions.  The programming language &lt;a href=&quot;http://math.andrej.com/eff/&quot;&gt;eff&lt;/a&gt; implements a design based on this work, and supports Exceptional Syntax, again with &lt;code&gt;let&lt;/code&gt; binding for the success continuation.  (Although the success continuation is incorporated into the exception matching construct, only a single success continuation pattern is allowed.)  In eff we might write &lt;code&gt;iter_stream&lt;/code&gt; as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;handle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;my_stream_get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The second argument in the &lt;code&gt;end_of_stream&lt;/code&gt; clauses binds the continuation of the effect, allowing handling strategies other than the usual stack unwinding.  Since we ignore the continuation argument the behaviour is the same as for a regular exception handler.&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://github.com/matijapretnar/eff/blob/2a9a36cc/src/parser.mly#L4-L7&quot;&gt;eff implementation&lt;/a&gt; uses the term &amp;quot;handler case&amp;quot; for the clauses of the &lt;code&gt;handle&lt;/code&gt; construct.&lt;/p&gt;

&lt;h4&gt;OCaml&lt;/h4&gt;

&lt;p&gt;Several OCaml programmers have proposed or implemented constructs related to handler case.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mjambon.com/&quot;&gt;Martin Jambon&lt;/a&gt; has &lt;a href=&quot;http://mjambon.com/mikmatch-manual.html#htoc16&quot;&gt;implemented&lt;/a&gt; a construct equivalent to Exceptional Syntax for OCaml as part of the &lt;a href=&quot;http://mjambon.com/micmatch.html&quot;&gt;micmatch extension&lt;/a&gt;.  His implementation allows us to write &lt;code&gt;iter_stream&lt;/code&gt; in much the same way as Benton and Kennedy's proposal:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;my_stream_get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The details of the implementation are discussed in &lt;a href=&quot;https://twitter.com/jakedonham&quot;&gt;Jake Donham&lt;/a&gt;'s &lt;a href=&quot;http://ambassadortothecomputers.blogspot.co.uk/2010/09/reading-camlp4-part-11-syntax.html&quot;&gt;articles on Camlp4&lt;/a&gt;.  The micmatch implementation has a novel feature: the &lt;code&gt;let&lt;/code&gt; binding associated with the success continuation may be made recursive.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://alain.frisch.fr/&quot;&gt;Alain Frisch&lt;/a&gt; has proposed and implemented a more powerful extension to OCaml, &lt;a href=&quot;http://www.lexifi.com/blog/static-exceptions&quot;&gt;Static Exceptions&lt;/a&gt;, which allow transfer of control to lexically-visible handlers (along the lines of Common Lisp's &lt;a href=&quot;http://clhs.lisp.se/Body/s_block.htm#block&quot;&gt;&lt;code&gt;block&lt;/code&gt;&lt;/a&gt; and &lt;a href=&quot;http://clhs.lisp.se/Body/s_ret_fr.htm#return-from&quot;&gt;&lt;code&gt;return-from&lt;/code&gt;&lt;/a&gt;).  Static exceptions are based on an equivalent feature in OCaml's intermediate language.&lt;/p&gt;

&lt;p&gt;There is a straightforward translation from OCaml extended with handler case into OCaml extended with static exceptions by wrapping the body of each &lt;code&gt;try&lt;/code&gt; expression in &lt;code&gt;raise (`Val (...))&lt;/code&gt;, and changing the &lt;code&gt;val&lt;/code&gt; keyword in the binding section to &lt;code&gt;`Val&lt;/code&gt;.  For example, &lt;code&gt;iter_stream&lt;/code&gt; can be written using static exceptions as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(`&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;MyStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Of course, static exceptions allow many other programs to be expressed that are not readily expressible using handler case.&lt;/p&gt;

&lt;p&gt;Finally, I discovered while writing this article that Christophe Raffalli proposed the handler case design fifteen years ago in a &lt;a href=&quot;http://caml.inria.fr/pub/ml-archives/caml-list/1999/12/a6d3ce9671b16a33530035c2b42df011.en.html&quot;&gt;message to caml-list&lt;/a&gt;!  Christophe's proposal wasn't picked up back then, but perhaps the time has now come to give OCaml programmers a way to handle success.&lt;/p&gt;

&lt;h3&gt;Postscript: a symmetric extension&lt;/h3&gt;

&lt;p&gt;The &lt;code&gt;try&lt;/code&gt; construct in current OCaml supports matching against raised exceptions but not against the value produced when no exception is raised.  Contrariwise, the &lt;code&gt;match&lt;/code&gt; construct supports matching against the value produced when no exception is raised, but does not support matching against raised exceptions.  As implemented, the patch addresses this asymmetry, extending &lt;code&gt;match&lt;/code&gt; with clauses that specify the &amp;quot;failure continuation&amp;quot;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_1&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_n&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_1'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_1'&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pattern_n'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expr_n'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;With this additional extension the choice between &lt;code&gt;match&lt;/code&gt; and &lt;code&gt;try&lt;/code&gt; becomes purely stylistic.  We might optimise for succinctness, and use &lt;code&gt;try&lt;/code&gt; in the case where exceptions are expected (for example, where they're used for control flow), reserving &lt;code&gt;match&lt;/code&gt; for the case where exceptions are truly exceptional.&lt;/p&gt;

&lt;p&gt;For the sake of completeness, here's &lt;code&gt;iter_stream&lt;/code&gt; written with the extended &lt;code&gt;match&lt;/code&gt; construct:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml language-ocaml&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;MyStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;iter_stream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s'&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;exception&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;End_of_stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Since both &lt;code&gt;val&lt;/code&gt; and &lt;code&gt;exception&lt;/code&gt; are existing keywords, the extensions to both &lt;code&gt;try&lt;/code&gt; and &lt;code&gt;match&lt;/code&gt; are fully backwards compatible. &lt;/p&gt;</content:encoded>
	<dc:date>2014-02-04T16:05:05+00:00</dc:date>
	<dc:creator>OCaml Labs</dc:creator>
</item>
<item rdf:about="http://pw374.github.io/posts/2014-01-06-09-24-25-functional-visitors.html">
	<title>Philippe Wang: Functional visitors for a complex tree-shaped data structure</title>
	<link>http://pw374.github.io/posts/2014-01-06-09-24-25-functional-visitors.html</link>
	<dc:date>2014-01-06T09:24:25+00:00</dc:date>
	<dc:creator>Philippe Wang</dc:creator>
</item>
<item rdf:about="http://openmirage.org/blog/decks-n-drums">
	<title>MirageOS: Presenting Decks</title>
	<link>http://openmirage.org/blog/decks-n-drums</link>
	<content:encoded>&lt;div&gt;
      &lt;p&gt;A few months ago, partly as a stunt, mostly because we could, Anil and I put together &lt;a href=&quot;http://decks.openmirage.org/oscon13/&quot;&gt;a presentation&lt;/a&gt; for &lt;a href=&quot;http://www.oscon.com/oscon2013/&quot;&gt;OSCON'13&lt;/a&gt; about Mirage in Mirage. That is, as a self-hosting Mirage web application that served up slides using &lt;a href=&quot;http://lab.hakim.se/reveal-js/&quot;&gt;RevealJS&lt;/a&gt;. It was a bit of a hack, but it was cool (we thought!) and it worked. Several more presentations were written and given this way, at venues ranging from the &lt;a href=&quot;http://www.youtube.com/watch?v=3Jype6sP6MQ&quot;&gt;XenSummit 2013&lt;/a&gt; to &lt;a href=&quot;https://www.usenix.org/conference/foci13‎&quot;&gt;ACM FOCI 2013&lt;/a&gt; to the Cambridge Computer Lab's &lt;a href=&quot;http://decks.openmirage.org/cam13/&quot;&gt;MSc in Advanced Computer Science&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;With the &lt;a href=&quot;http://openmirage.org/blog/releasing-mirage&quot;&gt;release of Mirage 1.0&lt;/a&gt;, &lt;a href=&quot;http://github.com/mirage/ocaml-cohttp&quot;&gt;CoHTTP&lt;/a&gt;, &lt;a href=&quot;http://github.com/mirage/cowabloga&quot;&gt;Cowabloga&lt;/a&gt; and
the new &lt;a href=&quot;http://foundation.zurb.com/&quot;&gt;Zurb Foundation&lt;/a&gt; based &lt;a href=&quot;http://openmirage.org/&quot;&gt;website&lt;/a&gt;, it was time to refresh them
and as a little seasonal gift, give them a shiny new index with some actual CSS
styling. So &lt;a href=&quot;http://decks.openmirage.org/&quot;&gt;here they are&lt;/a&gt;, a set of presentations that have been given
by various members of the Mirage team over the last 6 months or so. They cover
a range of topics, from general introductions to the Xen roadmap to more
detailed technical background. And, of course, as Mirage is under constant
rapid development, some of the older content may already be outdated. But &lt;a href=&quot;http://github.com/mirage/mirage-decks&quot;&gt;the
code for the site itself&lt;/a&gt; serves as another example of a simple --
somewhat simpler than the &lt;a href=&quot;http://openmirage.org/&quot;&gt;Mirage website&lt;/a&gt; in fact -- Mirage web
application.&lt;/p&gt;

   &lt;/div&gt;</content:encoded>
	<dc:date>2014-01-03T16:00:00+00:00</dc:date>
	<dc:creator>Richard Mortier</dc:creator>
</item>
<item rdf:about="http://www.cl.cam.ac.uk/projects/ocamllabs/news/2013-12-29">
	<title>Monthly News: Dec 2013 news update</title>
	<link>http://www.cl.cam.ac.uk/projects/ocamllabs/news/index.html#Dec%202013</link>
	<content:encoded>&lt;div&gt;
      &lt;p&gt;This time last year in 2012, I had just
&lt;a href=&quot;http://anil.recoil.org/2012/10/19/announcing-ocaml-labs.html&quot;&gt;announced&lt;/a&gt; the
formation of a new group called &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/&quot;&gt;OCaml Labs&lt;/a&gt; in the
&lt;a href=&quot;http://www.cl.cam.ac.uk&quot;&gt;Cambridge Computer Lab&lt;/a&gt; that would combine research
and community work towards the practical application of functional programming.
An incredible year has absolutely flown by, and I've put together this post to
summarise what's gone on, and point to our future directions for 2014.&lt;/p&gt;
&lt;p&gt;The theme of our group was not to be pure research, but rather a hybrid group
that would take on some of the load of day-to-day OCaml maintenance from
&lt;a href=&quot;http://caml.inria.fr&quot;&gt;INRIA&lt;/a&gt;, as well as help grow the wider OCaml community.
To this end, all of our projects have been highly collaborative, often
involving colleagues from &lt;a href=&quot;http://ocamlpro.com&quot;&gt;OCamlPro&lt;/a&gt;,
&lt;a href=&quot;http://gallium.inria.fr/&quot;&gt;INRIA&lt;/a&gt;, &lt;a href=&quot;http://janestreet.com&quot;&gt;Jane Street&lt;/a&gt;,
&lt;a href=&quot;http://www.lexifi.com/&quot;&gt;Lexifi&lt;/a&gt; and &lt;a href=&quot;http://citrix.com&quot;&gt;Citrix&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This post covers progress in &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/news/#tooling&quot;&gt;tooling&lt;/a&gt;, the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/news/#core_compiler&quot;&gt;compiler and
language&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/news/#community_efforts&quot;&gt;community efforts&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/news/#research_projects&quot;&gt;research
projects&lt;/a&gt; and concludes with our &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/news/#priorities_for_2014&quot;&gt;priorities for
2014&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&quot;Tooling&quot;&gt;Tooling&lt;/h3&gt;
&lt;p&gt;At the start of 2013, OCaml was in the interesting position of being a mature
decades-old language with a small, loyal community of industrial users who built
mission critical applications using it.  We had the opportunity to sit down
with many of them at the &lt;a href=&quot;http://caml.inria.fr/consortium/&quot;&gt;OCaml Consortium&lt;/a&gt;
meeting and prioritise where we started work.  The answer came back clearly:
while the compiler itself is legendary for its stability, the tooling around it
(such as package management) was a pressing problem.&lt;/p&gt;
&lt;h4 id=&quot;OPAM&quot;&gt;OPAM&lt;/h4&gt;
&lt;p&gt;Our solution to this tooling was centered around the
&lt;a href=&quot;http://opam.ocaml.org&quot;&gt;OPAM&lt;/a&gt; package manager that
&lt;a href=&quot;http://ocamlpro.com&quot;&gt;OCamlPro&lt;/a&gt; released into beta just at the end of 2012, and
had its first stable release in March 2013.  OPAM differs from most system
package managers by emphasising a flexible distributed workflow that uses
version constraints to ensure incompatible libraries aren't mixed up (important
for the statically-typed OCaml that is very careful about dependencies).
Working closely with &lt;a href=&quot;http://ocamlpro.com&quot;&gt;OCamlPro&lt;/a&gt; we developed a git-based
workflow to make it possible for users (both individual or industrial) to
easily build up their own package repositories and redistribute OCaml code, and
started curating the &lt;a href=&quot;https://github.com/ocaml/opam-repository&quot;&gt;package
repository&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The results have been satisfying: we started with an initial set of around 100 packages in
OPAM (mostly imported by the 4 developers), and ended 2013 with 587 unique packages and 2000 individual versions, with contributions from 160 individuals.  We now have a curated
&lt;a href=&quot;https://github.com/ocaml/opam-repository&quot;&gt;central package repository&lt;/a&gt; for anyone
to submit their OCaml code,
several third-party remotes are maintained (e.g. the &lt;a href=&quot;https://github.com/xapi-project/opam-repo-dev&quot;&gt;Xen Project&lt;/a&gt;
and &lt;a href=&quot;https://github.com/ocsigen/opam-ocsigen&quot;&gt;Ocsigen&lt;/a&gt;).  We also regularly
receive releases of the &lt;a href=&quot;http://ocaml.janestreet.com&quot;&gt;Core&lt;/a&gt; libraries
from Jane Street, and updates from sources as varied as &lt;a href=&quot;https://github.com/ocaml/opam-repository/pull/1300&quot;&gt;Facebook&lt;/a&gt;,
&lt;a href=&quot;http://anil.recoil.org/2013/09/16/camlpdf-the-end-of-sucky-pdf-tools.html&quot;&gt;Coherent PDF&lt;/a&gt;,
to the &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/guha.pdf&quot;&gt;Frenetic SDN&lt;/a&gt; research.&lt;/p&gt;
&lt;p&gt;A notable contribution from OCamlPro during this time was to
&lt;a href=&quot;https://github.com/ocaml/opam-repository/issues/955&quot;&gt;clarify&lt;/a&gt; the licensing on
the package repository to be the liberal
&lt;a href=&quot;http://creativecommons.org/choose/zero/&quot;&gt;CC0&lt;/a&gt;, and also to pass ownership to
the &lt;a href=&quot;http://github.com/ocaml&quot;&gt;OCaml&lt;/a&gt; organization on GitHub, where it's now
jointly maintained by OCaml Labs, OCamlPro and anyone else that wishes to
contribute.&lt;/p&gt;
&lt;h4 id=&quot;AlensintoglobalOCamlcode&quot;&gt;A lens into global OCaml code&lt;/h4&gt;
&lt;p&gt;It's been quite interesting just watching all the varied code fly into the
repository, but stability quickly became a concern as the new packages piled
up.  OCaml compiles to native code on not just x86, but also PowerPC, Sparc and
&lt;a href=&quot;http://anil.recoil.org/2012/02/25/dreamplug-debian-and-ocaml.html&quot;&gt;ARM&lt;/a&gt; CPUs.
We kicked off various efforts into automated testing: firstly &lt;a href=&quot;https://github.com/dsheets&quot;&gt;David Sheets&lt;/a&gt;
built the
&lt;a href=&quot;http://anil.recoil.org/2013/09/09/ocamlot-autotriaging.html&quot;&gt;OCamlot&lt;/a&gt; daemon
that would schedule builds across all the exotic hardware. Later in the year,
the &lt;a href=&quot;http://travis-ci.org&quot;&gt;Travis&lt;/a&gt; service launched support for testing from GitHub pull requests,
and this became the front line of &lt;a href=&quot;http://anil.recoil.org/2013/09/30/travis-and-ocaml.html&quot;&gt;automated
checking&lt;/a&gt; for all
incoming new packages to OPAM.&lt;/p&gt;
&lt;p&gt;A major headache with automated testing is usually setting up the right build
environment with external library dependencies, and so we &lt;a href=&quot;http://anil.recoil.org/2013/11/15/docker-and-opam.html&quot;&gt;added Docker
support&lt;/a&gt; to make it
easier to bulk-build packages for local developer use, with the results of
builds available &lt;a href=&quot;https://github.com/avsm/opam-bulk-logs&quot;&gt;publically&lt;/a&gt; for
anyone to help triage.  Unfortunately fixing the bugs themselves is still a
&lt;a href=&quot;https://github.com/ocaml/opam-repository/issues/1304&quot;&gt;very manual process&lt;/a&gt;, so
more volunteers are always welcome to help out!&lt;/p&gt;
&lt;p&gt;We're going to be really seeing the rewards from all this effort as OCaml
4.02 development proceeds, since we can now adopt a data-driven approach
to changing language features instead of guessing how much third-party
code will break.  If your code is in OPAM, then it'll be tested as new
features such as &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6063&quot;&gt;module aliases&lt;/a&gt;,
&lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/garrigue.pdf&quot;&gt;injectivity&lt;/a&gt; and
&lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/white.pdf&quot;&gt;extension points&lt;/a&gt; show up.&lt;/p&gt;
&lt;h4 id=&quot;Betterdocumentation&quot;&gt;Better documentation&lt;/h4&gt;
&lt;p&gt;The venerable
&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual029.html&quot;&gt;OCamlDoc&lt;/a&gt; tool
has done an admirable job for the last decade, but is increasingly showing its
age due to a lack of support for cross-referencing across packages.  We started
working on this problem in the summer when &lt;a href=&quot;https://github.com/vincent-botbol&quot;&gt;Vincent Botbol&lt;/a&gt;
visited us on an internship, expecting it to be a quick job to come up with
something as good as Haskell's excellent &lt;a href=&quot;http://www.haskell.org/haddock/&quot;&gt;Haddock&lt;/a&gt; online documentation.&lt;/p&gt;
&lt;p&gt;Instead, we ran into the &quot;module wall&quot;: since OCaml makes it so easy to
parameterise code over other modules, it makes it hard to generate static
documentation without outputting hundreds of megabytes of HTML every time.
After some hard work from Vincent and Leo, we've got a working prototype that
lets you simply run &lt;code&gt;opam install opam-doc &amp;amp;&amp;amp; opam doc core async&lt;/code&gt; to generate
package documentation.  You can see the results for
&lt;a href=&quot;http://mirage.github.io/&quot;&gt;Mirage&lt;/a&gt; online, but expect to see this integrated
into the main OCaml site for all OPAM packages as we work through polishing up
the user interface.&lt;/p&gt;
&lt;h4 id=&quot;TurningOPAMintolibraries&quot;&gt;Turning OPAM into libraries&lt;/h4&gt;
&lt;p&gt;The other behind-the-scenes effort for OPAM has been to keep the core command-line
tool simple and stable, and to have it install OCaml libraries that can be
interfaced with by other tools to do domain-specific tasks.  &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt;,
&lt;a href=&quot;http://louis.gesbert.fr/cv.en.html&quot;&gt;Louis Gesbert&lt;/a&gt; and &lt;a href=&quot;https://github.com/dsheets&quot;&gt;David Sheets&lt;/a&gt; have been steadily hacking away at this and
we now have &lt;a href=&quot;https://github.com/ocamllabs/opamfu&quot;&gt;opamfu&lt;/a&gt; to run operations
over all packages, and an easy-to-template &lt;a href=&quot;https://github.com/ocaml/opam2web&quot;&gt;opam2web&lt;/a&gt;
that generates the live &lt;a href=&quot;http://opam.ocaml.org&quot;&gt;opam.ocaml.org&lt;/a&gt; website.&lt;/p&gt;
&lt;p&gt;This makes OPAM easier to deploy within other organizations that want to integrate
it into their workflow.  For example, the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/pkg/&quot;&gt;software
section&lt;/a&gt; of the OCaml Labs website is regularly
generated from a search of all OPAM packages tagged &lt;code&gt;ocamllabs&lt;/code&gt;.  We also used
it to rewrite the entire OPAM repository &lt;a href=&quot;https://github.com/ocaml/opam-repository/pull/1240&quot;&gt;in one epic diff&lt;/a&gt; to add external
library dependencies via a &lt;a href=&quot;https://github.com/ocaml/opam/pull/886/files&quot;&gt;command-line shim&lt;/a&gt;.&lt;/p&gt;
&lt;h4 id=&quot;OPAMinaBox&quot;&gt;OPAM-in-a-Box&lt;/h4&gt;
&lt;p&gt;All of this effort is geared towards making it easier to maintain reusable
local OPAM installations.  After several requests from big universities to help
out their teaching needs, we're putting together all the support needed to
easily redistribute OPAM packages via an
&quot;&lt;a href=&quot;https://github.com/ocaml/opam/issues/1035&quot;&gt;OPAM-in-a-Box&lt;/a&gt;&quot; command that uses
&lt;a href=&quot;http://docker.io&quot;&gt;Docker&lt;/a&gt; containers to let you clone and do lightweight
modifications of OCaml installations.&lt;/p&gt;
&lt;p&gt;This will also be useful for anyone who'd like to run tutorials or teach OCaml,
without having to rely on flaky network connectivity at conference venues: a problem we've  &lt;a href=&quot;http://amirchaudhry.com/fpdays-review&quot;&gt;suffered from&lt;/a&gt; too!&lt;/p&gt;
&lt;h3 id=&quot;CoreCompiler&quot;&gt;Core Compiler&lt;/h3&gt;
&lt;p&gt;Starting to work on a real compiler can often be a daunting prospect, and so
one initiative we started this year is to host regular &lt;a href=&quot;http://ocamllabs.github.io/compiler-hacking/2013/10/30/third-compiler-hacking-session.html&quot;&gt;compiler hacking sessions&lt;/a&gt; where people could find a &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki&quot;&gt;curated list of features&lt;/a&gt; to work on, with the regular developers at hand to help out when people get stuck, and free beer and pizza to oil the coding wheels.  This has worked out well, with around 20 people showing up on average for the three we held, and &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-previously-worked-on&quot;&gt;several patches&lt;/a&gt; submitted upstream to OCaml.  &lt;a href=&quot;http://gallium.inria.fr/~scherer/&quot;&gt;Gabriel Scherer&lt;/a&gt; and &lt;a href=&quot;http://cristal.inria.fr/~doligez/&quot;&gt;Damien Doligez&lt;/a&gt; have been helping this effort by tagging &lt;a href=&quot;http://caml.inria.fr/mantis/search.php?project_id=1&amp;sticky_issues=1&amp;sortby=last_updated&amp;dir=DESC&amp;highlight_changed=24&amp;hide_status_id=90&amp;tag_string=junior_job&quot;&gt;junior jobs&lt;/a&gt; in the OCaml Mantis bug tracker as they are filed.&lt;/p&gt;
&lt;h4 id=&quot;Syntaxtransformationsandextensionpoints&quot;&gt;Syntax transformations and extension points&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;http://www.lpw25.net&quot;&gt;Leo White&lt;/a&gt; started the year fresh out of completing his PhD with &lt;a href=&quot;https://www.cl.cam.ac.uk/~am21/&quot;&gt;Alan Mycroft&lt;/a&gt;, and before he realized what he'd
gotten himelf into was working with &lt;a href=&quot;http://alain.frisch.fr/&quot;&gt;Alain Frisch&lt;/a&gt; on the
future of syntax transformations in OCaml.  We started off our first
&lt;a href=&quot;http://lists.ocaml.org/listinfo/wg-camlp4&quot;&gt;wg-camlp4&lt;/a&gt; working group on the new
&lt;a href=&quot;http://lists.ocaml.org&quot;&gt;lists.ocaml.org&lt;/a&gt; host, and a spirited discussion
&lt;a href=&quot;http://lists.ocaml.org/pipermail/wg-camlp4/2013-January/thread.html&quot;&gt;started&lt;/a&gt; that
went &lt;a href=&quot;http://lists.ocaml.org/pipermail/wg-camlp4/2013-February/thread.html&quot;&gt;on&lt;/a&gt;
and &lt;a href=&quot;http://lists.ocaml.org/pipermail/wg-camlp4/2013-March/thread.html&quot;&gt;on&lt;/a&gt; for
several months.  It ended with a very satisfying design for a simpler &lt;em&gt;extension
points&lt;/em&gt; mechanism which Leo &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/white.pdf&quot;&gt;presented&lt;/a&gt;
at the OCaml 2013 workshop at ICFP, and is now merged into OCaml 4.02-trunk.&lt;/p&gt;
&lt;h4 id=&quot;Namespaces&quot;&gt;Namespaces&lt;/h4&gt;
&lt;p&gt;Not all of the working groups were quite as successful in coming to a conclusion as the Camlp4 one.  On the Platform mailing list, Gabriel Scherer started a discussion on the design for &lt;a href=&quot;http://lists.ocaml.org/pipermail/platform/2013-February/000050.html&quot;&gt;namespaces&lt;/a&gt; in OCaml.  The resulting discussion was useful in separating multiple concerns that were intermingled in the initial proposal, and Leo wrote a &lt;a href=&quot;http://www.lpw25.net/2013/03/10/ocaml-namespaces.html&quot;&gt;comprehensive blog post&lt;/a&gt; on a proposed namespace design.&lt;/p&gt;
&lt;p&gt;After further discussion at &lt;a href=&quot;http://icfpconference.org/icfp2013/&quot;&gt;ICFP 2013&lt;/a&gt; with Jacques Garrigue later in the year, it turns out adding support for &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6063&quot;&gt;module aliases&lt;/a&gt; would solve much of the cost associated with compiling large libraries such as &lt;a href=&quot;http://ocaml.janestreet.com&quot;&gt;Core&lt;/a&gt;, with no backwards compatibility issues.  This solution has now been integrated into OCaml 4.02.0dev and is being tested with Core.&lt;/p&gt;
&lt;h4 id=&quot;Delvingintothebugtracker&quot;&gt;Delving into the bug tracker&lt;/h4&gt;
&lt;p&gt;Jeremy Yallop joined us in April, and he and Leo also leapt into the core
compiler and started triaging issues on the OCaml &lt;a href=&quot;http://caml.inria.fr/mantis&quot;&gt;bug
tracker&lt;/a&gt;.  This seems unglamorous in the
beginning, but there rapidly turned out to be many fascinating threads that
shed light on OCaml's design and implementation through seemingly harmless
bugs.  Here is a pick of some interesting threads through the year that we've
been involved with:&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;An &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5985&amp;nbn=49#bugnotes&quot;&gt;unexpected interaction between variance and GADTs&lt;/a&gt;
 that led to Jacques Garrigue's &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/garrigue.pdf&quot;&gt;talk&lt;/a&gt; at OCaml 2013.&lt;/li&gt;
 &lt;li&gt;Type unsoundness by &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5992&quot;&gt;pattern matching lazy mutable values&lt;/a&gt;, thus
 shedding light on the precise semantics of the order of pattern matching.&lt;/li&gt;
 &lt;li&gt;Leo proposed an &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5584&quot;&gt;open types&lt;/a&gt; extension
 to allow abstract types to be declared open. You can try it via &lt;code&gt;opam switch 4.00.1+open-types&lt;/code&gt;.&lt;/li&gt;
 &lt;li&gt;Designing the popular, but controversial &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5759&quot;&gt;record disambiguation feature&lt;/a&gt; in OCaml 4.01.0, and debating &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6000&quot;&gt;the right warnings&lt;/a&gt; needed to prevent programmer surprise.&lt;/li&gt;
 &lt;li&gt;Exposing a &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6064&quot;&gt;GADT representation for Bigarray&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This is just a sample of some of the issues solved in Mantis; if you want to
learn more about OCaml, it's well worth browsing through it to learn from over
a decade of interesting discussions from all the developers.&lt;/p&gt;
&lt;h4 id=&quot;Threadlocalstorageruntime&quot;&gt;Thread-local storage runtime&lt;/h4&gt;
&lt;p&gt;While OCamlPro was working on their &lt;a href=&quot;https://github.com/lucasaiu/ocaml&quot;&gt;reentrant OCaml runtime&lt;/a&gt;, we took a different tack by adding &lt;a href=&quot;https://github.com/ocamllabs/ocaml/tree/multicore&quot;&gt;thread-local storage&lt;/a&gt; to the runtime instead, courtesy of &lt;a href=&quot;http://mu.netsoc.ie/&quot;&gt;Stephen Dolan&lt;/a&gt;.  This is an important choice to make at the outset of adding multicore, so both approaches are warranted.  The preemptive runtime adds a lot of code churn (due to adding a context parameter to most function calls) and takes up a register, whereas the thread-local storage approach we tried doesn't permit callbacks to different threads.&lt;/p&gt;
&lt;p&gt;Much of this work isn't interesting on its own, but forms the basis for a fully multicore runtime (with associated programming model) in 2014. Stay tuned!&lt;/p&gt;
&lt;h4 id=&quot;Ctypes&quot;&gt;Ctypes&lt;/h4&gt;
&lt;p&gt;One other complaint from the Consortium members was quite surprising: the difficulty of using the OCaml foreign function interface safely to interface with C code.  Jeremy Yallop began working on the &lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes&quot;&gt;ctypes&lt;/a&gt; library that had the goal of eliminating the need to write any C code at all for the vast majority of foreign bindings.&lt;/p&gt;
&lt;p&gt;Instead, Ctypes lets you describe any C function call as an OCaml value, and provides various linkage options to invoke that function into C.  The first option he implemented was a &lt;code&gt;dlopen&lt;/code&gt; interface, which immediately brought us the same level of functionality as the &lt;a href=&quot;http://docs.python.org/2/library/ctypes.html&quot;&gt;Python&lt;/a&gt; or &lt;a href=&quot;http://www.haskell.org/haskellwiki/Library/libffi&quot;&gt;Haskell&lt;/a&gt; Ctypes equivalents.  This early code was in itself startlingly useful and more pleasant to use than the raw FFI, and various folk (such as David Sheets' &lt;a href=&quot;https://github.com/dsheets/ocaml-sodium&quot;&gt;libsodium&lt;/a&gt; cryptography bindings) started adopting it.&lt;/p&gt;
&lt;p&gt;At this point, I happened to be struggling to write the Foreign Function Interface chapter of &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; without blowing through our page budget with a comprehensive explanation of the existing system.  I decided to take a risk and write about Ctypes instead, since it let new users to the language have a &lt;em&gt;far&lt;/em&gt; more productive experience to get started.  Xavier Leroy pointed out &lt;a href=&quot;https://github.com/realworldocaml/book/issues/1701&quot;&gt;some shortcomings&lt;/a&gt; of the library in his technical book review, most notably with the lack of an interface with C.  The design of Ctypes fully supports alternate linking mechanisms than just &lt;code&gt;dlopen&lt;/code&gt; though, and Jeremy has added automatic C stub generation support as well.  This means that if you use Ctypes to build an OCaml binding in 2014, you can choose several mechanisms for the same source code to link to the external system.  Jeremy even demonstrated a forking model at OCaml 2013 that protects the OCaml runtime from the C binding via process separation.&lt;/p&gt;
&lt;p&gt;The effort is paying off: Daniel Bünzli &lt;a href=&quot;http://alan.petitepomme.net/cwn/2013.12.17.html#9&quot;&gt;ported SDL2&lt;/a&gt; using ctypes, and gave us extensive &lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes/issues&quot;&gt;feedback&lt;/a&gt; about any missing corner cases, and the resulting bindings don't require any C code to be written.&lt;/p&gt;
&lt;h3 id=&quot;CommunityEfforts&quot;&gt;Community Efforts&lt;/h3&gt;
&lt;p&gt;Our community efforts were largely online, but we also hosted visitors over the year and regular face-to-face tutorials.&lt;/p&gt;
&lt;h4 id=&quot;OnlineatOCamlorg&quot;&gt;Online at OCaml.org&lt;/h4&gt;
&lt;p&gt;While the rest of the crew were hacking on OPAM and OCaml, &lt;a href=&quot;http://amirchaudhry.com/&quot;&gt;Amir Chaudhry&lt;/a&gt; and &lt;a href=&quot;http://philippewang.info/CL/&quot;&gt;Philippe Wang&lt;/a&gt; teamed up with Ashish Agarwal and Christophe Troestler to redesign and relaunch the &lt;a href=&quot;http://ocaml.org&quot;&gt;OCaml website&lt;/a&gt;.  Historically, OCaml's homepage has been the &lt;a href=&quot;http://caml.inria.fr&quot;&gt;caml.inria.fr&lt;/a&gt; domain, and the &lt;a href=&quot;http://ocaml.org&quot;&gt;ocaml.org&lt;/a&gt; effort was begun by Christophe and Ashish &lt;a href=&quot;https://www.mail-archive.com/caml-list@inria.fr/msg00169.html&quot;&gt;some years ago&lt;/a&gt; to modernize the web presence.&lt;/p&gt;
&lt;p&gt;The webpages were already rather large with complex scripting (for example, the &lt;a href=&quot;http://ocaml.org/learn/tutorials/99problems.html&quot;&gt;99 Problems&lt;/a&gt; page runs the OCaml code to autogenerate the output). Philippe developed a &lt;a href=&quot;https://github.com/pw374/MPP-language-blender&quot;&gt;template DSL&lt;/a&gt; that made it easier to unify a lot of the templates around the website, and also a &lt;a href=&quot;https://github.com/pw374/omd&quot;&gt;Markdown parser&lt;/a&gt; that we could link to as a library from the rest of the infrastructure without shelling out to Pandoc.&lt;/p&gt;
&lt;p&gt;Meanwhile, Amir designed a series of &lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;interactive wireframe sketches&lt;/a&gt;  and [gathered feedback]((http://amirchaudhry.com/ocamlorg-request-for-feedback/) on it from the community. A local design agency in Cambridge helped with visual look and feel, and finally at the end of the summer we began the &lt;a href=&quot;http://amirchaudhry.com/migration-plan-ocaml-org/&quot;&gt;migration&lt;/a&gt; to the new website, followed by a triumphant &lt;a href=&quot;http://amirchaudhry.com/announcing-new-ocamlorg/&quot;&gt;switchover&lt;/a&gt; in November to the design you see today.&lt;/p&gt;
&lt;p&gt;The domain isn't just limited to the website itself.  Leo and I set up a &lt;a href=&quot;https://github.com/ocaml/ocaml.org-scripts&quot;&gt;SVN-to-Git mirror&lt;/a&gt; of the OCaml compiler &lt;a href=&quot;http://caml.inria.fr/ocaml/anonsvn.en.html&quot;&gt;Subversion repository&lt;/a&gt; on the GitHub &lt;a href=&quot;https://github.com/ocaml/ocaml&quot;&gt;OCaml organization&lt;/a&gt;, which is proving popular with developers.  There is an ongoing effort to simplify the core compiler tree by splitting out some of the larger components, and so &lt;a href=&quot;http://github.com/ocaml/camlp4&quot;&gt;camlp4&lt;/a&gt; is also now hosted on that organization, along with &lt;a href=&quot;https://github.com/ocaml/oasis&quot;&gt;OASIS&lt;/a&gt;.  We also administer several subdomains of &lt;a href=&quot;http://ocaml.org&quot;&gt;ocaml.org&lt;/a&gt;, such as the &lt;a href=&quot;http://lists.ocaml.org&quot;&gt;mailing lists&lt;/a&gt; and the &lt;a href=&quot;http://opam.ocaml.org&quot;&gt;OPAM repository&lt;/a&gt;, and other services such as the &lt;a href=&quot;http://forge.ocamlcore.org&quot;&gt;OCaml Forge&lt;/a&gt; are currently migrating over.  This was made significantly easier thanks to sponsorship from &lt;a href=&quot;http://rackspace.com&quot;&gt;Rackspace Cloud&lt;/a&gt; (users of &lt;a href=&quot;http://xenserver.org&quot;&gt;XenServer&lt;/a&gt; which is written in OCaml). They saw our struggles with managing physical machines and gave us developer accounts, and all of the ocaml.org infrastructure is now hosted on Rackspace.  We're very grateful to their ongoing help!&lt;/p&gt;
&lt;p&gt;If you'd like to contribute to infrastructure help  (for example, I'm experimenting with a &lt;a href=&quot;http://git.ocaml.org/public/&quot;&gt;GitLab&lt;/a&gt; mirror), then please join the &lt;a href=&quot;http://lists.ocaml.org/listinfo/infrastructure&quot;&gt;infrastructure@lists.ocaml.org&lt;/a&gt; mailing list and share your thoughts.  The website team also need help with adding content and &lt;a href=&quot;https://github.com/ocaml/ocaml.org/issues/376&quot;&gt;international translations&lt;/a&gt;, so head over to the &lt;a href=&quot;http://github.com/ocaml/ocaml.org/issues&quot;&gt;website issue tracker&lt;/a&gt; and start proposing improvements you'd like to see.&lt;/p&gt;
&lt;h4 id=&quot;Nextstepsforocamlorg&quot;&gt;Next steps for ocaml.org&lt;/h4&gt;
&lt;p&gt;The floodgates requesting features opened up after the launch of the new look and feel.  Pretty much everyone wanted deeper OPAM integration into the main website, for features such as:&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;Starring and reviewing packages&lt;/li&gt;
 &lt;li&gt;Integrating the &lt;a href=&quot;https://github.com/ocamllabs/opam-doc&quot;&gt;opam-doc&lt;/a&gt; documentation with the metadata&lt;/li&gt;
 &lt;li&gt;Display test results and a compatibility matrix for non-x86 and non-Linux architectures.&lt;/li&gt;
 &lt;li&gt;Link to blog posts and tutorials about the package.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Many of these features were part of the &lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;original wireframes&lt;/a&gt; but we're being careful to take a long-term view of how they should be create
d and maintained.Rather than building all of this as a huge bloated &lt;a href=&quot;https://github.com/ocaml/opam2web&quot;&gt;opam2web&lt;/a&gt; extension, David Sheets (our resident relucant-to-admit-it web expert) has designed an overlay directory scheme that permits the overlaying of different metadata onto the website. This lets one particular feature (such as blog post aggregation) be handled separately from the others via Atom aggregators.&lt;/p&gt;
&lt;h4 id=&quot;RealWorldOCaml&quot;&gt; Real World OCaml&lt;/h4&gt;
&lt;p&gt;A big effort that took up most of the year for me was finishing and publishing an O'Reilly book called &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; with &lt;a href=&quot;https://ocaml.janestreet.com/?q=blog/5&quot;&gt;Yaron Minsky&lt;/a&gt; and Jason Hickey.  Yaron describes how it all started in &lt;a href=&quot;https://ocaml.janestreet.com/?q=node/117&quot;&gt;his blog post&lt;/a&gt;, but I learnt a lot from developing a book using the &lt;a href=&quot;http://anil.recoil.org/2013/06/17/real-world-ocaml-beta-available.html&quot;&gt;open commenting scheme&lt;/a&gt; that we
developed just for this.&lt;/p&gt;
&lt;p&gt;In particular, the book ended up shining a bright light into dark language corners that we might otherwise not have explored in OCaml Labs.  Two chapters of the book that I wasn't satisfied with were the &lt;a href=&quot;https://realworldocaml.org/v1/en/html/objects.html&quot;&gt;objects&lt;/a&gt; and &lt;a href=&quot;https://realworldocaml.org/v1/en/html/classes.html&quot;&gt;classes&lt;/a&gt; chapters, largely since neither Yaron nor Jason nor I had ever really used their full power in our own code.  Luckily, Leo White decided to pick up the baton and champion these oft-maligned (but very powerful) features of OCaml, and the result is the clearest explanation of them that I've read yet.  Meanwhile, Jeremy Yallop helped out with extensive review of the &lt;a href=&quot;https://realworldocaml.org/v1/en/html/foreign-function-interface.html&quot;&gt;Foreign Function Interface&lt;/a&gt; chapter that used his &lt;a href=&quot;https://github.com/ocamllabs/ocaml-ctypes&quot;&gt;ctypes&lt;/a&gt; library.  Finally, &lt;a href=&quot;https://plus.google.com/100586365409172579442/posts&quot;&gt;Jeremie Diminio&lt;/a&gt; at Jane Street worked hard on adding several features to his &lt;a href=&quot;https://github.com/diml/utop&quot;&gt;utop&lt;/a&gt; toplevel that made it compelling enough to become our default recommendation for newcomers.&lt;/p&gt;
&lt;p&gt;All in all, we ended up closing over &lt;a href=&quot;http://anil.recoil.org/2013/08/06/real-world-ocaml-beta2.html&quot;&gt;2000 comments&lt;/a&gt; in the process of writing the book, and I'm very proud of the result (freely available &lt;a href=&quot;https://realworldocaml.org&quot;&gt;online&lt;/a&gt;, but do &lt;a href=&quot;http://www.amazon.com/Real-World-OCaml-Functional-programming/dp/144932391X/&quot;&gt;buy a copy&lt;/a&gt; if you can to support it).  Still, there's more I'd like to do in 2014 to improve the ease of using OCaml further.  In particular, I removed a chapter on packaging and build systems since I wasn't happy with its quality, and both &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; and I intend to spend time in 2014 on improving this part of the ecosystem.&lt;/p&gt;
&lt;h4 id=&quot;TutorialsandTalks&quot;&gt;Tutorials and Talks&lt;/h4&gt;
&lt;p&gt;We had a lively presence at &lt;a href=&quot;http://icfpconference.org&quot;&gt;ICFP 2013&lt;/a&gt; this year, with the third iteration of the &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/program.html&quot;&gt;OCaml 2013&lt;/a&gt; held there, and Stephen Dolan presenting a paper in the main conference.  I &lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/2013/09/24/liveblogging-ocaml-workshop-2013/&quot;&gt;liveblogged the workshop&lt;/a&gt; as it happened, and all the &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/program.html&quot;&gt;talks&lt;/a&gt; we gave are linked from the program.  The most exciting part of the conference for a lot of us were the two talks by Facebook on their use of OCaml: first for &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/padioleau.pdf&quot;&gt;program analysis using Pfff&lt;/a&gt; and then to migrate their massive PHP codebase &lt;a href=&quot;http://www.youtube.com/watch?feature=player_detailpage&amp;v=gKWNjFagR9k#t=1150&quot;&gt;using an OCaml compiler&lt;/a&gt;.  I also had the  opportunity to participate in a panel at the Haskell Workshop on whether &lt;a href=&quot;http://ezyang.tumblr.com/post/62157468762/haskell-haskell-and-ghc-too-big-to-fail-panel&quot;&gt;Haskell is too big to fail yet&lt;/a&gt;; lots of interesting perspectives on scaling another formerly academic language into the real world.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://ocaml.janestreet.com/?q=blog/5&quot;&gt;Yaron Minsky&lt;/a&gt; and I have been giving tutorials on OCaml at ICFP for several years, but the release of Real World OCaml has made it significantly easier to give tutorials without the sort of labor intensity that it took in previous years (one memorable ICFP 2011 tutorial that we did took almost 2 hours to get everyone installed with OCaml.  In ICFP 2013, it took us 15 minutes or so to get everyone started).  Still, giving tutorials at ICFP is very much preaching to the choir, and so we've started speaking at more general-purpose events.&lt;/p&gt;
&lt;p&gt;Our first local effort was &lt;a href=&quot;http://fpdays.net/2013/&quot;&gt;FPDays&lt;/a&gt; in Cambridge, where Jeremy Yallop and Amir Chaudhry ran the tutorial with help from Phillipe Wang, Leo White and David Sheets. The OCaml session there ended up being the biggest one in the entire two days, and Amir &lt;a href=&quot;http://amirchaudhry.com/fpdays-review/&quot;&gt;wrote up&lt;/a&gt; their experiences.  One interesting change from our ICFP tutorial is that Jeremy used &lt;a href=&quot;https://github.com/ocsigen/js_of_ocaml&quot;&gt;js_of_ocaml&lt;/a&gt; to teach OCaml via JavaScript by building a fun &lt;a href=&quot;https://github.com/ocamllabs/fpdays-skeleton&quot;&gt;Monty Hall&lt;/a&gt; game.&lt;/p&gt;
&lt;h4 id=&quot;VisitorsandInterns&quot;&gt;Visitors and Interns&lt;/h4&gt;
&lt;p&gt;Since OCaml Labs is a normal group within the &lt;a href=&quot;http://www.cl.cam.ac.uk&quot;&gt;Cambridge Computer Lab&lt;/a&gt;, we often host academic visitors and interns who pass through.  This year was certainly diverse, and we welcomed a range of colleagues:&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;a href=&quot;http://www.lip6.fr/actualite/personnes-fiche.php?ident=D1161&amp;LANG=en&quot;&gt;Mathias Bourgoin&lt;/a&gt; has just finished his work on interfacing OCaml with GPUs, and gave us a seminar on how his &lt;a href=&quot;http://www.algo-prog.info/spoc/web/index.php?id=spoc&quot;&gt;SPOC&lt;/a&gt; tool works (also available in OPAM via a &lt;a href=&quot;http://www.algo-prog.info/spoc/distribution/opam/&quot;&gt;custom remote&lt;/a&gt;).&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;http://www.benjamin.canou.fr/&quot;&gt;Benjamin Canou&lt;/a&gt; (now at OCamlPro) practised his &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/canou.pdf&quot;&gt;OCaml 2013 talk&lt;/a&gt; on building high-level interfaces to JavaScript with OCaml by giving a departmental seminar.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;http://www.dicosmo.org/&quot;&gt;Roberto Di Cosmo&lt;/a&gt;, who directs the &lt;a href=&quot;http://www.irill.org/&quot;&gt;IRILL&lt;/a&gt; organization on Free Software in Paris delivered a seminar on constraint solving for &lt;a href=&quot;http://mancoosi.org&quot;&gt;package systems&lt;/a&gt; that are as large-scale as Debian's.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; visited during the summer to help plot the &lt;a href=&quot;http://openmirage.org/blog/mirage-1.0.3-released&quot;&gt;Mirage 1.0&lt;/a&gt; and &lt;a href=&quot;http://anil.recoil.org/2013/09/20/opam-1-1-beta.html&quot;&gt;OPAM 1.1&lt;/a&gt; releases.  He has also since joined OCaml Labs fulltime to work on &lt;a href=&quot;http://nymote.org&quot;&gt;Nymote&lt;/a&gt;.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;http://louis.gesbert.fr/cv.en.html&quot;&gt;Louis Gesbert&lt;/a&gt; from OCamlPro visited for 2 weeks in December and kicked off the inaugral OPAM developers summit (which was, admittedly, just 5 developers in the &lt;a href=&quot;http://www.kingston-arms.co.uk/&quot;&gt;Kingston Arms&lt;/a&gt;, but all good things start in a pub, right?)&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;http://www.xulforum.org/&quot;&gt;Jonathan Protzenko&lt;/a&gt; presented his PhD work on &lt;a href=&quot;http://protz.github.io/mezzo/&quot;&gt;Mezzo&lt;/a&gt; (which is now &lt;a href=&quot;http://gallium.inria.fr/blog/mezzo-on-opam/&quot;&gt;merged into OPAM&lt;/a&gt;), and educated us on the vagaries of &lt;a href=&quot;http://protz.github.io/ocaml-installer/&quot;&gt;Windows support&lt;/a&gt;.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;http://gallium.inria.fr/~scherer/&quot;&gt;Gabriel Scherer&lt;/a&gt; from the Gallium INRIA group visited to discuss the direction of OPAM and various language feature discussions (such as namespaces).  He didn't give a talk, but promises to do so next time!&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/bvaugon&quot;&gt;Benoît Vaugon&lt;/a&gt; gave a seminar on his &lt;a href=&quot;http://oud.ocaml.org/2012/slides/oud2012-paper10-slides.pdf&quot;&gt;OCamlCC&lt;/a&gt; OCaml-to-C compiler, talked about porting OCaml to &lt;a href=&quot;http://www.algo-prog.info/ocaml_for_pic/web/index.php?id=ocapic&quot;&gt;8-bit PICs&lt;/a&gt;, and using GADTs to &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6017&quot;&gt;implement Printf&lt;/a&gt; properly.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We were also visited several times by &lt;a href=&quot;http://danmey.org/&quot;&gt;Wojciech Meyer&lt;/a&gt; from ARM, who was an OCaml developer who maintained (among other things) the &lt;a href=&quot;http://brion.inria.fr/gallium/index.php/Ocamlbuild&quot;&gt;ocamlbuild&lt;/a&gt; system and worked on &lt;a href=&quot;http://www.youtube.com/watch?v=d9Hg5L76FG8&quot;&gt;DragonKit&lt;/a&gt; (an extensible LLVM-like compiler written in OCaml).  Wojciech very sadly passed away on November 18th, and we all fondly remember his enthusiastic and intelligent contributions to our small Cambridge community.&lt;/p&gt;
&lt;p&gt;We also hosted visitors to live in Cambridge and work with us over the summer.  In addition to Vincent Botbol (who worked on OPAM-doc as described earlier) we had the pleasure of having &lt;a href=&quot;http://erratique.ch/&quot;&gt;Daniel Bünzli&lt;/a&gt; and &lt;a href=&quot;http://www.x9c.fr/&quot;&gt;Xavier Clerc&lt;/a&gt; work here.  Here's what they did in their own words.&lt;/p&gt;
&lt;h5 id=&quot;XavierClercOCamlJava&quot;&gt;Xavier Clerc: OCamlJava&lt;/h5&gt;
&lt;p&gt;Xavier Clerc took a break from his regular duties at INRIA to join us over the summer
to work on &lt;a href=&quot;http://ocamljava.x9c.fr/preview/&quot;&gt;OCaml-Java&lt;/a&gt; and adapt it to the latest
JVM features.  This is an incredibly important project to bridge OCaml with the huge
Java community, and here's his report:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;After a four-month visit to the OCaml Labs dedicated to the &lt;a href=&quot;http://ocamljava.x9c.fr/preview/&quot;&gt;OCaml-Java&lt;/a&gt;
project, the time has come for an appraisal! The undertaken work can be split
into two areas: improvements to code generation, and interaction between the
OCaml &amp;amp; Java languages.  Regarding code generation, several classical
optimizations have been added to the compiler, for example loop unrolling,
more aggressive unboxing, better handling of globals, or partial evaluation
(at the bytecode level). A new tool, namely ocamljar, has been introduced
allowing post-compilation optimizations. The underlying idea is that some
optimizations cannot always be applied (e.g. depending whether multiple
threads/programs will coexist), but enabling them through command-line flags
would lead to recompilation and/or multiple installations of each library
according to the set of chosen optimizations. It is thus far more easier to
first build an executable jar file, and then modify it according to these
optimizations. Furthermore, this workflow allows the ocamljar tool to take
advantage of whole-program information for some optimizations.  All these
improvements, combined, often lead to a gain of roughly 1/3 in terms of
execution time.&lt;/p&gt;
&lt;p&gt;Regarding language interoperability, there are actually two directions 
depending on whether you want to call OCaml code from Java, or want to call 
Java code from OCaml. For the first direction, a tool allows to generate Java
source files from OCaml compiled interfaces, mapping the various constructs
of the OCaml language to Java classes. It is then possible to call functions, 
and to manipulate instances of OCaml types in pure Java, still benefiting 
from the type safety provided by the OCaml language. In the other direction,
an extension of the OCaml typer is provided allowing to create and manipulate
Java instances directly from OCaml sources. This typer extension is indeed a
thin layer upon the original OCaml typer, that is mainly responsible for
encoding Java types into OCaml types.  This encoding uses a number of
advanced elements such as polymorphic variants, subtyping, variance
annotations, phantom typing, and printf-hack, but the end-user does not have
to be aware of this encoding. On the surface, the type of instances of the
Java Object classes is &lt;code&gt;java'lang'Object java_instance&lt;/code&gt;, and instances can be
created by calling Java.make &lt;code&gt;Object()&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;While still under heavy development, a working prototype &lt;a href=&quot;http://ocamljava.x9c.fr/preview/&quot;&gt;is available&lt;/a&gt;, and bugs &lt;a href=&quot;http://bugs.x9c.fr/&quot;&gt;can be reported&lt;/a&gt;. Finally, I would like to thank the OCaml Labs for providing a great working
environment.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h5 id=&quot;DanielBnzliTypographyandVisualisation&quot;&gt;Daniel Bünzli: Typography and Visualisation&lt;/h5&gt;
&lt;p&gt;Daniel joined us from Switzerland, and spent some time at Citrix before joining us in OCaml Labs.  All of his &lt;a href=&quot;http://erratique.ch/software&quot;&gt;software&lt;/a&gt; is now on OPAM, and is seeing ever-increasing adoption from the community.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Released a first version of &lt;a href=&quot;http://erratique.ch/software/vg&quot;&gt;Vg&lt;/a&gt; [...] I'm
especially happy about that as I wanted to use and work on these ideas since
at least 2008. The project is a long term project and is certainly not
finished yet but this is already a huge step.&lt;/p&gt;
&lt;p&gt;Adjusted and released a first version of
&lt;a href=&quot;http://erratique.ch/software/gg&quot;&gt;Gg&lt;/a&gt;. While the module was already mostly
written before my arrival to Cambridge, the development of Vg and Vz prompted
me to make some changes to the module.&lt;/p&gt;
&lt;p&gt;[...] released &lt;a href=&quot;http://erratique.ch/software/otfm&quot;&gt;Otfm&lt;/a&gt;, a
module to decode OpenType fonts. This is a work in progress as not every
OpenType table has built-in support for decoding yet. But since it is needed
by Vg's PDF renderer I had to cut a release. It can however already be used
to implement certain simple things like font kerning with Vg, this can be
seen in action in the &lt;code&gt;vecho&lt;/code&gt; binary installed by Vg.&lt;/p&gt;
&lt;p&gt;Started to work on &lt;a href=&quot;http://erratique.ch/software/vz/doc/Vz.html&quot;&gt;Vz&lt;/a&gt;, a
module for helping to map data to Vg images. This is really unfinished and is
still considered to be at a design stage. There are a few things that are
however well implemented like (human) perceptually meaningful &lt;a href=&quot;http://erratique.ch/software/vz/demos/color_schemes.html&quot;&gt;color
palettes&lt;/a&gt; and the
small folding stat module (&lt;code&gt;Vz.Stat&lt;/code&gt;). However it quickly became evident that
I needed to have more in the box w.r.t. text rendering in Vg/Otfm. Things
like d3js entirely rely on the SVG/CSS support for text which makes it easy
to e.g. align things (like tick labels on &lt;a href=&quot;http://erratique.ch/software/vz/demos/iris.html&quot;&gt;such
drawings&lt;/a&gt;). If you can't
rely on that you need ways of measuring rendered text. So I decided to
suspend the work on Vz and put more energy in making a first good release of
Vg. Vz still needs quite some design work, especially since it tries to be
independent of Vg's backend and from the mechanism for user input.&lt;/p&gt;
&lt;p&gt;Spent some time figuring out a new &quot;opam-friendly&quot; release workflow in 
pkgopkg. One of my problem is that by designing in the small for programming
in the large --- what a slogan --- the number of packages I'm publishing is
growing (12 and still counting). This means that I need to scale horizontally
maintenance-wise unhelped by the sad state of build systems for OCaml. I need
tools that make the release process flawless, painless and up to my quality
standards. This lead me to enhance and consolidate my old scattered
distribution scripts in that repo, killing my dependencies on Oasis and
ocamlfind along the way. &lt;em&gt;(edited for brevity, see &lt;a href=&quot;https://github.com/dbuenzli/pkgopkg&quot;&gt;here&lt;/a&gt;)&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Daniel also left his bicycle here for future visitors to use, and the &quot;Bünzli-bike&quot;
is available for our next visitor! (Louis Gesbert even donated lights, giving
it a semblance of safety).&lt;/p&gt;
&lt;h4 id=&quot;IndustrialFellows&quot;&gt;Industrial Fellows&lt;/h4&gt;
&lt;p&gt;Most of our regular funding bodies such as &lt;a href=&quot;http://epsrc.ac.uk&quot;&gt;EPSRC&lt;/a&gt; or &lt;a href=&quot;http://cordis.europa.eu/fp7/home_en.html&quot;&gt;EU FP7&lt;/a&gt; provide funding, but leave all the intellectual input to the academics.  A compelling aspect of OCaml Labs has been how involved our industrial colleagues have been with the day-to-day problems that we solve.  Both Jane Street and Citrix have senior staff regularly visiting our group and working alongside us as industrial fellows in the Computer Lab.&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;a href=&quot;http://www.three-tuns.net/mark/&quot;&gt;Mark Shinwell&lt;/a&gt; from Jane Street Europe has been working on improving the &lt;a href=&quot;http://www.youtube.com/watch?v=NF2WpWnB-nk&quot;&gt;state of native debugging&lt;/a&gt; in OCaml, by adding frame pointers and DWARF symbols to the compiler output.  Mark is also a useful source of feedback about the forthcoming design of multicore, since he has daily insight into a huge production codebase at Jane Street (and can tell us about it without us requiring access!).&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; is the principal architect of &lt;a href=&quot;http://xenserver.org&quot;&gt;XenServer&lt;/a&gt; at Citrix in Cambridge.  This year has been transformative for that project, since Citrix &lt;a href=&quot;http://blogs.citrix.com/2013/06/26/open-source-what-does-it-mean-for-xenserver/&quot;&gt;open-sourced XenServer&lt;/a&gt; to GitHub and fully adopted OPAM into their workflow.  Dave is the author of numerous libraries that have all been released to OPAM, and his colleagues &lt;a href=&quot;http://jon.recoil.org&quot;&gt;Jon Ludlam&lt;/a&gt; and &lt;a href=&quot;http://www.xenserver.org/blog/blogger/listings/euanh.html&quot;&gt;Euan Harris&lt;/a&gt; are also regular visitors who have also been contributors to the OPAM and Mirage ecosystems.

&lt;h3 id=&quot;ResearchProjects&quot;&gt;Research Projects&lt;/h3&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The other 100% of our time at the Labs is spent on research projects.  When we started the group, I wanted to set up a feedback loop between local people &lt;em&gt;using&lt;/em&gt; OCaml to build systems, with the folk &lt;em&gt;developing&lt;/em&gt; OCaml itself.  This has worked out particularly well with a couple of big research projects in the Lab.&lt;/p&gt;
&lt;h4 id=&quot;Mirage&quot;&gt; Mirage&lt;/h4&gt;
&lt;p&gt;Mirage is a &lt;a href=&quot;http://anil.recoil.org/papers/2013-asplos-mirage.pdf&quot;&gt;library operating system&lt;/a&gt; written in OCaml that compiles source code into specialised Xen microkernels, developed at the Cambridge Computer Lab, Citrix and the &lt;a href=&quot;http://horizon.ac.uk&quot;&gt;Horizon Digital Economy&lt;/a&gt; institute at Nottingham.  This year saw several years of effort culminate in the first release of &lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage 1.0&lt;/a&gt; as a self-hosting entity.  While Mirage started off as a &lt;a href=&quot;http://anil.recoil.org/papers/2010-hotcloud-lamp.pdf&quot;&gt;quick experiment&lt;/a&gt; into building specialised virtual appliances, it rapidly became useful to make into a real system for use in bigger research projects.  You can learn more about Mirage &lt;a href=&quot;http://openmirage.org/docs&quot;&gt;here&lt;/a&gt;, or read the &lt;a href=&quot;http://cacm.acm.org/magazines/2014/1/170866-unikernels/abstract&quot;&gt;Communications of the ACM&lt;/a&gt; article that &lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; and I wrote to close out the year.&lt;/p&gt;
&lt;p&gt;This project is where the OCaml Labs &quot;feedback loop&quot; has been strongest.  A typical &lt;a href=&quot;http://www.openmirage.org/wiki/hello-world&quot;&gt;Mirage application&lt;/a&gt; consists of around 50 libraries that are all installed via OPAM.  These range from &lt;a href=&quot;https://github.com/mirage/mirage-block-xen&quot;&gt;device drivers&lt;/a&gt; to protocol libraries for &lt;a href=&quot;https://github.com/avsm/ocaml-cohttp&quot;&gt;HTTP&lt;/a&gt; or &lt;a href=&quot;https://github.com/mirage/ocaml-dns&quot;&gt;DNS&lt;/a&gt;, to filesystems such as &lt;a href=&quot;https://github.com/mirage/ocaml-fat&quot;&gt;FAT32&lt;/a&gt;.  Coordinating &lt;a href=&quot;http://openmirage.org/blog/mirage-1.0.3-released&quot;&gt;regular releases&lt;/a&gt; of all of these would be near impossible without using OPAM, and has also forced us to use our own tools daily, helping to sort out bugs more quickly.  You can see the full list of libraries on the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/pkg/&quot;&gt;OCaml Labs software page&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Mirage is also starting to share code with big projects such as &lt;a href=&quot;http://xenserver.org&quot;&gt;XenServer&lt;/a&gt; now, and we have been working with Citrix engineers to help them to move to the &lt;a href=&quot;http://ocaml.janestreet.com&quot;&gt;Core&lt;/a&gt; library that Jane Street has released (and that is covered in &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt;).  Moving production codebases this large can take years, but OCaml Labs is turning out to be a good place to start unifying some of the bigger users of OCaml into one place.  We're also now an official &lt;a href=&quot;http://www.xenproject.org/developers/teams/mirage-os.html&quot;&gt;Xen Project incubator project&lt;/a&gt;, which helps us to validate functional programming  to other Linux Foundation efforts.&lt;/p&gt;
&lt;h4 id=&quot;NymoteandUserCentricNetworking&quot;&gt;Nymote and User Centric Networking&lt;/h4&gt;
&lt;p&gt;The release of Mirage 1.0 has put us on the road to simplifying embedded systems programming. The move to the centralized cloud has led to regular well-publicised privacy and security threats to the way &lt;a href=&quot;http://de2013.org/wp-content/uploads/2013/09/de2013_submission_25-1.pdf&quot;&gt;we handle&lt;/a&gt; our digital infrastructure, and so &lt;a href=&quot;http://www.cl.cam.ac.uk/~jac22/&quot;&gt;Jon Crowcroft&lt;/a&gt;, &lt;a href=&quot;http://www.cs.nott.ac.uk/~rmm/&quot;&gt;Richard Mortier&lt;/a&gt; and I are leading an effort to build an alternative privacy-preserving infrastructure using embedded devices as part of the &lt;a href=&quot;http://usercentricnetworking.eu/&quot;&gt;User Centric Networking&lt;/a&gt; project, in collaboration with a host of companies led by &lt;a href=&quot;http://www.thlab.net/&quot;&gt;Technicolor&lt;/a&gt; Paris.
This work also plays on the strong points of OCaml: it already has a &lt;a href=&quot;http://anil.recoil.org/2012/02/25/dreamplug-debian-and-ocaml.html&quot;&gt;fast ARM backend&lt;/a&gt;, and Mirage can easily be ported to the new Xen/ARM target as hardware becomes available.&lt;/p&gt;
&lt;p&gt;One of the most difficult aspects of programming on the &quot;wide area&quot; Internet are dealing with the lack of a distributed identity service that's fully secure.  We published &lt;a href=&quot;http://anil.recoil.org/papers/2013-foci-signposts.pdf&quot;&gt;our thoughts&lt;/a&gt; on this at the USENIX Free and Open Communications on the Internet workhsop, and David Sheets is working towards a full implementation using Mirage.  If you're interested in following this effort, Amir Chaudhry is blogging at the &lt;a href=&quot;http://nymote.org/&quot;&gt;Nymote&lt;/a&gt; project website, where we'll talk about the components as they are released.&lt;/p&gt;
&lt;h4 id=&quot;DataCenterNetworking&quot;&gt; Data Center Networking&lt;/h4&gt;
&lt;p&gt;At the other extreme from embedded programming is datacenter networking, and we started the &lt;a href=&quot;http://gow.epsrc.ac.uk/NGBOViewGrant.aspx?GrantRef=EP/K034723/1&quot;&gt;Network-as-a-Service&lt;/a&gt; research project with &lt;a href=&quot;http://gow.epsrc.ac.uk/NGBOViewGrant.aspx?GrantRef=EP/K032968/1&quot;&gt;Imperial College&lt;/a&gt; and &lt;a href=&quot;http://gow.epsrc.ac.uk/NGBOViewGrant.aspx?GrantRef=EP/K031724/1&quot;&gt;Nottingham&lt;/a&gt;.  With the rapid rise of &lt;a href=&quot;http://en.wikipedia.org/wiki/Software-defined_networking&quot;&gt;Software Defined Networking&lt;/a&gt; this year, we are investigating how application-specific customisation of network resources can build fast, better, cheaper infrasructure.  OCaml is in a good position here: several other groups have built OpenFlow controllers in OCaml (most notably, the &lt;a href=&quot;https://github.com/frenetic-lang&quot;&gt;Frenetic Project&lt;/a&gt;), and Mirage is specifically designed to assemble such bespoke infrastructure.&lt;/p&gt;
&lt;p&gt;Another aspect we've been considering is how to solve the problem of optimal connectivity across nodes.  TCP is increasingly considered harmful in high-through, high-density clusters, and &lt;a href=&quot;http://www.sussex.ac.uk/informatics/people/peoplelists/person/334868&quot;&gt;George Parisis&lt;/a&gt; led the design of &lt;a href=&quot;http://anil.recoil.org/papers/2013-hotnets-trevi.pdf&quot;&gt;Trevi&lt;/a&gt;, which is a fountain-coding based alternative for storage networking.  Meanwhile, &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; (who joined OCaml Labs in November), has been working on a branch-consistent data store called &lt;a href=&quot;https://github.com/samoht/irminsule&quot;&gt;Irminsule&lt;/a&gt; which supports scalable data sharing and reconciliation using Mirage.  Both of these systems will see implementations based on the research done this year.&lt;/p&gt;
&lt;h4 id=&quot;HigherKindedProgramming&quot;&gt; Higher Kinded Programming&lt;/h4&gt;
&lt;p&gt;Jeremy Yallop and Leo White have been developing an approach that makes it possible to write programs with higher-kinded polymorphism (such as monadic functions that are polymorphic in the monad they use) without using functors. It's early days yet, but there's a &lt;a href=&quot;https://github.com/ocamllabs/higher&quot;&gt;library&lt;/a&gt; available on &lt;a href=&quot;http://opam.ocaml.org/pkg/higher/higher.0.1&quot;&gt;OPAM&lt;/a&gt; that implements the approach, and a &lt;a href=&quot;https://github.com/ocamllabs/higher/raw/paper/higher.pdf&quot;&gt;draft
paper&lt;/a&gt; that outlines the design.&lt;/p&gt;
&lt;h3 id=&quot;Prioritiesfor2014&quot;&gt;Priorities for 2014&lt;/h3&gt;
&lt;p&gt;This year has been a wild ride to get us up to speed, but we now have a solid sense of what to work on for 2014.  We've decided on a high-level set of priorities led by the senior members of the group:&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;strong&gt;Multicore&lt;/strong&gt;: Leo White will be leading efforts in putting an end-to-end multicore capable OCaml together.&lt;/li&gt;
 &lt;li&gt;&lt;strong&gt;Metaprogramming&lt;/strong&gt;: Jeremy Yallop will direct the metaprogramming efforts, continuing with Ctypes and into macros and extension points.&lt;/li&gt;
 &lt;li&gt;&lt;strong&gt;Platform&lt;/strong&gt;: Thomas Gazagnaire will continue to drive OPAM development towards becoming the first &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/slides/madhavapeddy.pdf&quot;&gt;OCaml Platform&lt;/a&gt;.&lt;/li&gt;
 &lt;li&gt;&lt;strong&gt;Online&lt;/strong&gt;: Amir Chaudhry will develop the online and community efforts that started in 2013.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These are guidelines to choosing where to spend our time, but not excluding other work or day-to-day bugfixing. Our focus on collaboration with Jane Street, Citrix, Lexifi, OCamlPro and our existing colleagues will continue, as well as warmly welcoming new community members that wish to work with us on any of the projects, either via internships, studentships or good old-fashioned open source hacking.&lt;/p&gt;
&lt;p&gt;I appreciate the &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/&quot;&gt;whole team's&lt;/a&gt; feedback in editing this long post into shape, the amazing professorial support from &lt;a href=&quot;http://www.cl.cam.ac.uk/~jac22/&quot;&gt;Jon Crowcroft&lt;/a&gt;, &lt;a href=&quot;https://www.cl.cam.ac.uk/~iml1/&quot;&gt;Ian Leslie&lt;/a&gt; and &lt;a href=&quot;https://www.cl.cam.ac.uk/~am21/&quot;&gt;Alan Mycroft&lt;/a&gt; throughout the year, and of course the funding and support from Jane Street, Citrix, RCUK, EPSRC, DARPA and the EU FP7 that made all this possible.  Roll on 2014, and please do &lt;a href=&quot;mailto:avsm2@cl.cam.ac.uk&quot;&gt;get in touch&lt;/a&gt; with me with any queries!&lt;/p&gt;

   &lt;/div&gt;</content:encoded>
	<dc:date>2013-12-29T12:00:00+00:00</dc:date>
	<dc:creator>Anil Madhavapeddy</dc:creator>
</item>
<item rdf:about="http://openmirage.org/blog/mirage-1.0.3-released">
	<title>MirageOS: Mirage 1.0.3 released; tutorial on building this website available</title>
	<link>http://openmirage.org/blog/mirage-1.0.3-released</link>
	<content:encoded>&lt;div&gt;
      &lt;p&gt;We've had a lot of people trying out Mirage since the &lt;a href=&quot;http://openmirage.org/blog/releasing-mirage&quot;&gt;1.0 release&lt;/a&gt; last week, and so we've been steadily cutting point releases and new libraries to OPAM as they're done.
The most common build error by far has been people using outdated OPAM packages.  Do make sure that you have at least &lt;a href=&quot;http://opam.ocaml.org/doc/Quick_Install.html&quot;&gt;OPAM 1.1&lt;/a&gt; installed, and that you've run &lt;code&gt;opam update -u&lt;/code&gt; to get the latest package lists from the &lt;a href=&quot;https://github.com/ocaml/opam-repository&quot;&gt;package repository&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/mirage/mirage/releases/tag/1.0.3&quot;&gt;Mirage 1.0.3&lt;/a&gt; improves
Xen configuration generation, cleans up HTTP support, and adds support for FAT
filesystems.  Here are some of the libraries we've released this week to go along with it:&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/mirage/mirage-www&quot;&gt;mirage-www&lt;/a&gt; (update): the live website now runs on the 1.0 tools.  Explanation of how to build it in various configurations is available &lt;a href=&quot;http://openmirage.org/wiki/mirage-www&quot;&gt;here&lt;/a&gt;.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/samoht/alcotest&quot;&gt;alcotest&lt;/a&gt; (new): a lightweight and colourful test framework built over &lt;a href=&quot;http://ounit.forge.ocamlcore.org/&quot;&gt;oUnit&lt;/a&gt;.  The interface is simpler to facilitate writing tests quickly, and it formats test results nicely.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/mirage/mirage-block-xen&quot;&gt;mirage-block-xen.1.0.0&lt;/a&gt; (new): is the stable release of the Xen &lt;code&gt;Blkfront&lt;/code&gt; driver for block devices.  The library supports both frontend and backend operation, but only the frontend is plumbed through to Mirage for now (although the backend can be manually configured).&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/mirage/mirage-block-unix&quot;&gt;mirage-block-unix.1.2.0&lt;/a&gt; (update): fixed some concurrency bugs and added support for buffered I/O to improve performance.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/mirage/ocaml-fat&quot;&gt;fat-filesystem.0.10.0&lt;/a&gt; (update): copies with more sector sizes, uses buffered I/O on Unix, and adds a &lt;code&gt;KV_RO&lt;/code&gt; key/value interface as well as a more complicated filesystem one.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/mirage/mirage-fs-unix&quot;&gt;mirage-fs-unix.1.0.0&lt;/a&gt; (update): implements the &lt;code&gt;KV_RO&lt;/code&gt; signature as a passthrough to a Unix filesystem.  This is convenient during development to avoid recompile cycles while changing data.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/mirage/mirage-platform&quot;&gt;mirage-xen.1.0.0&lt;/a&gt; (update): removed several distracting-but-harmless linker warnings about code bloat.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/mirage/ocaml-cohttp&quot;&gt;cohttp.0.9.14&lt;/a&gt; (update): supports Server-Side Events via better channel flushing, has a complete set of HTTP codes autogenerated from &lt;a href=&quot;https://github.com/citricsquid/httpstatus.es&quot;&gt;httpstatus.es&lt;/a&gt; and exposes a platform-independent &lt;code&gt;Cohttp_lwt&lt;/code&gt; module.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/mirage/ocaml-cow&quot;&gt;cow.0.8.1&lt;/a&gt; (update): switch to the &lt;a href=&quot;https://github.com/pw374/omd&quot;&gt;Omd&lt;/a&gt; library for Markdown parsing, which is significantly more compatible with other parsers.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/samoht/ezjsonm&quot;&gt;ezjsonm.0.2.0&lt;/a&gt; (new): a combinator library to parse, select and manipulate JSON structures.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/avsm/ezxmlm&quot;&gt;ezxmlm.1.0.0&lt;/a&gt; (new): a combinator library to parse, select and transform XML tags and attributes.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;https://github.com/mirage/mirage-http-xen&quot;&gt;mirage-http-xen&lt;/a&gt; and &lt;a href=&quot;https://github.com/mirage/mirage-http-unix&quot;&gt;mirage-http-unix&lt;/a&gt; provide the HTTP drivers on top of Cohttp for Mirage. Although they are very similar at the moment, they will diverge as the Unix variant gains options to use kernel sockets instead of only the network stack.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We're making great progress on moving our personal homepages over to Mirage.  The first two introductory wiki posts are also now available:&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;a href=&quot;http://openmirage.org/wiki/hello-world&quot;&gt;Building a hello world example&lt;/a&gt; takes you through the basic steps to build a Unix and Xen binary.&lt;/li&gt;
 &lt;li&gt;&lt;a href=&quot;http://openmirage.org/wiki/mirage-www&quot;&gt;Building the Mirage website&lt;/a&gt; lets you build this website with several variants, demonstrating the Unix passthrough filesystem, the OCaml FAT filesystem library, and how to attach a network stack to your application.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;As always, please feel free to report any issues via the &lt;a href=&quot;https://github.com/mirage/mirage/issues&quot;&gt;bug tracker&lt;/a&gt; and ask questions on the &lt;a href=&quot;mailto:mirageos-devel@lists.xenproject.org&quot;&gt;mailing list&lt;/a&gt;.&lt;/p&gt;

   &lt;/div&gt;</content:encoded>
	<dc:date>2013-12-19T23:00:00+00:00</dc:date>
	<dc:creator>Anil Madhavapeddy</dc:creator>
</item>
<item rdf:about="http://openmirage.org/blog/announcing-mirage10">
	<title>MirageOS: Mirage 1.0: not just a hallucination!</title>
	<link>http://openmirage.org/blog/announcing-mirage10</link>
	<content:encoded>&lt;div&gt;
      &lt;p&gt;&lt;em&gt;First&lt;/em&gt;: read the &lt;a href=&quot;http://openmirage.org/wiki/overview-of-mirage&quot;&gt;overview&lt;/a&gt; and
&lt;a href=&quot;http://openmirage.org/wiki/technical-background&quot;&gt;technical background&lt;/a&gt; behind the project.&lt;/p&gt;
&lt;p&gt;When we started hacking on Mirage back in 2009, it started off looking like a
conventional OS, except written in OCaml.   The &lt;a href=&quot;https://github.com/mirage/mirage/tree/old-master&quot;&gt;monolithic
repository&lt;/a&gt; contained all the
libraries and boot code, and exposed a big &lt;code&gt;OS&lt;/code&gt; module for applications to use.
We used this to do several fun &lt;a href=&quot;http://cufp.org/conference/sessions/2011/t3-building-functional-os&quot;&gt;tutorials&lt;/a&gt; at conferences
such as ICFP/CUFP and get early feedback.&lt;/p&gt;
&lt;p&gt;As development continued though, we started to understand what it is we were
building: a &lt;a href=&quot;http://anil.recoil.org/papers/2013-asplos-mirage.pdf&quot;&gt;&quot;library operating system&quot;&lt;/a&gt;.  As the number of libraries grew,
putting everything into one repository just wasn't scaling, and it made it hard
to work with third-party code.  We spent some time developing tools to make
Mirage fit into the broader OCaml ecosystem.&lt;/p&gt;
&lt;p&gt;Three key things have emerged from this effort:&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;a href=&quot;https://opam.ocaml.org&quot;&gt;OPAM&lt;/a&gt;, a source-based package manager for
 OCaml. It supports multiple simultaneous compiler installations, flexible
 package constraints, and a Git-friendly development workflow.  Since
 releasing 1.0 in March 2013 and 1.1 in October, the community has leapt
 in to contribute over 1800 packages in this short time.  All of the 
 Mirage libraries are now tracked using it, including the Xen libraries.&lt;/li&gt;
 &lt;li&gt;The build system for embedded programming (such as the Xen target) is
 a difficult one to get right.  After several experiments, Mirage provides
 a single &lt;strong&gt;&lt;a href=&quot;https://github.com/mirage/mirage&quot;&gt;command-line tool&lt;/a&gt;&lt;/strong&gt; that
 combines configuration directives (also written in OCaml) with OPAM to
 make building Xen unikernels as easy as Unix binaries.&lt;/li&gt;
 &lt;li&gt;All of the Mirage-compatible libraries satisfy a set of module type
 signatures in a &lt;strong&gt;&lt;a href=&quot;https://github.com/mirage/mirage-types/blob/master/lib/v1.mli&quot;&gt;single file&lt;/a&gt;&lt;/strong&gt;.
 This is where Mirage lives up to its name: we've gone from the early
 monolithic repository to a single, standalone interface file that
 describes the interfaces.  Of course, we also have libraries to go along
 with this signature, and they all live in the &lt;a href=&quot;https://github.com/mirage&quot;&gt;Mirage GitHub organization&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;With these components, I'm excited to announce that Mirage 1.0 is finally ready
to see the light of day!  Since it consists of so many libraries, we've decided
not to have a &quot;big bang&quot; release where we dump fifty complex libraries on the
open-source community.  Instead, we're going to spend the month of December
writing a series of blog posts that explain how the core components work,
leading up to several use cases:&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;The development team have all decided to shift our personal homepages to be Mirage
 kernels running on Xen as a little Christmas present to ourselves, so we'll work through that step-by-step how to build 
 a dedicated unikernel and maintain and deploy it (&lt;strong&gt;spoiler:&lt;/strong&gt; see &lt;a href=&quot;https://github.com/mirage/mirage-www-deployment&quot;&gt;this repo&lt;/a&gt;).  This will culminate in
 a webservice that our colleagues at &lt;a href=&quot;http://horizon.ac.uk&quot;&gt;Horizon&lt;/a&gt; have been
 building using Android apps and an HTTP backend.&lt;/li&gt;
 &lt;li&gt;The &lt;a href=&quot;http://xenserver.org&quot;&gt;XenServer&lt;/a&gt; crew at Citrix are using Mirage to build custom middlebox VMs
 such as block device caches.&lt;/li&gt;
 &lt;li&gt;For teaching purposes, the &lt;a href=&quot;http://ocaml.io&quot;&gt;Cambridge Computer Lab team&lt;/a&gt; want a JavaScript backend,
 so we'll explain how to port Mirage to this target (which is rather different
 from either Unix or Xen, and serves to illustrate the portability of our approach).&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Howtogetinvolved&quot;&gt;How to get involved&lt;/h3&gt;
&lt;p&gt;Bear with us while we update all the documentation and start the blog posts off
today (the final libraries for the 1.0 release are all being merged into OPAM
while I write this, and the usually excellent &lt;a href=&quot;http://travis-ci.org&quot;&gt;Travis&lt;/a&gt; continuous integration system is down due to a &lt;a href=&quot;https://github.com/travis-ci/travis-ci/issues/1727&quot;&gt;bug&lt;/a&gt; on their side).  I'll edit this post to contain links to the future posts
as they happen.&lt;/p&gt;
&lt;p&gt;Since we're now also a proud Xen and Linux Foundation incubator project, our mailing
list is shifting to &lt;a href=&quot;http://lists.xenproject.org/cgi-bin/mailman/listinfo/mirageos-devel&quot;&gt;mirageos-devel@lists.xenproject.org&lt;/a&gt;, and we very much
welcome comments and feedback on our efforts over there.
The &lt;code&gt;#mirage&lt;/code&gt; channel on FreeNode IRC is also growing increasingly popular, as
is simply reporting issues on the main &lt;a href=&quot;http://github.com/mirage/mirage&quot;&gt;Mirage GitHub&lt;/a&gt; repository.&lt;/p&gt;
&lt;p&gt;Several people have also commented that they want to learn OCaml properly to
start using Mirage.  I've just co-published an O'Reilly book called
&lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; that's available for free online
and also as hardcopy/ebook.  Our Cambridge colleague John Whittington has
also written an excellent &lt;a href=&quot;http://ocaml-book.com/&quot;&gt;introductory text&lt;/a&gt;, and
you can generally find more resources &lt;a href=&quot;http://ocaml.org/docs/&quot;&gt;online&lt;/a&gt;.
Feel free to ask beginner OCaml questions on our mailing lists and we'll help
as best we can!&lt;/p&gt;

   &lt;/div&gt;</content:encoded>
	<dc:date>2013-12-09T12:00:00+00:00</dc:date>
	<dc:creator>Anil Madhavapeddy</dc:creator>
</item>
<item rdf:about="http://amirchaudhry.com/switching-from-bootstrap-to-zurb-foundation">
	<title>Amir Chaudhry: Switching from Bootstrap to Zurb Foundation</title>
	<link>http://amirchaudhry.com/switching-from-bootstrap-to-zurb-foundation</link>
	<content:encoded>&lt;p&gt;I've just updated my site's HTML/CSS and moved from Twitter Bootstrap to
&lt;a href=&quot;http://foundation.zurb.com/learn/features.html&quot;&gt;Zurb Foundation&lt;/a&gt;.  This post captures my subjective notes on the
migration.&lt;/p&gt;

&lt;h4&gt;My use of Bootstrap&lt;/h4&gt;

&lt;p&gt;When I originally set this site up, I didn't know what frameworks existed or
anything more than the basics of dealing with HTML (and barely any CSS).  I
came across Twitter Bootstrap and immediately decided it would Solve All My
Problems.  It really did.  Since then, I've gone through one 'upgrade' with
Bootstrap (from 1.x to 2.x), after which I dutifully ignored all the fixes
and improvements (note that Bootstrap was up to v2.3.2 while I was still
using v2.0.2).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://amirchaudhry.com/images/switch-to-foundation/responsive-design.png&quot; alt=&quot;Responsive Design&quot; /&gt;&lt;/p&gt;

&lt;p&gt;For the most part, this was fine with me but for a while now, I've been
meaning to make this site 'responsive' (read: not look like crap from a
mobile).  Bootstrap v3 purports to be mobile-first so upgrading would likely
give me what I'm after but v3 is &lt;a href=&quot;http://getbootstrap.com/getting-started/&quot;&gt;not backwards compatible&lt;/a&gt;,
meaning I'd have to rewrite parts of the HTML.  Since this step was
unavoidable, it led me to have another look at front-end frameworks, just to
see if I was missing anything.  This was especially relevant since we'd
&lt;a href=&quot;http://amirchaudhry.com/announcing-new-ocamlorg/&quot;&gt;just released&lt;/a&gt; the new &lt;a href=&quot;http://ocaml.org&quot;&gt;OCaml.org&lt;/a&gt;
website, itself built with Bootstrap v2.3.1 (we'd done the design/templating
work long before v3 was released).  It would be useful to know what else is
out there for any future work.&lt;/p&gt;

&lt;p&gt;Around this time I discovered Zurb Foundation and also the numerous
comparisons between them (note: Foundation seems to come out ahead in most
of those).  A few days ago, the folks at Zurb released
&lt;a href=&quot;http://zurb.com/article/1280/foundation-5-blasts-off--2&quot;&gt;version 5&lt;/a&gt;, so I decided that now is the time to kick the
tires.  For the last few days, I've been playing with the framework and in
the end I decided to migrate my site over completely.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://foundation.zurb.com/learn/features.html&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/switch-to-foundation/zurb-yeti.png&quot; alt=&quot;Foundation's Yeti&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Swapping out one framework for another&lt;/h4&gt;

&lt;p&gt;Over time, I've become moderately experienced with HTML/CSS and I can
usually wrangle things to look the way I want, but my solutions aren't
necessarily elegant. I was initially concerned that I'd already munged
things so much that changing anything would be a pain.  When I first put the
styles for this site together, I had to spend quite a bit of time
overwriting Bootstrap's defaults so I was prepared for the same when using
Foundation.  Turns out that I was fine.  I currently use &lt;a href=&quot;http://jekyllrb.com&quot;&gt;Jekyll&lt;/a&gt; (and
&lt;a href=&quot;http://jekyllbootstrap.com&quot;&gt;Jekyll Bootstrap&lt;/a&gt;) so I only had three template files and a couple of
HTML pages to edit and because I'd kept most of my custom CSS in a separate
file, it was literally a case of swapping out one framework for another and
bug-fixing from there onwards.  There's definitely a lesson here in using
automation as much as possible.&lt;/p&gt;

&lt;p&gt;Customising the styles was another area of concern but I was pleasantly
surprised to find I needed &lt;em&gt;less&lt;/em&gt; customisation than with Bootstrap.  This
is likely because I didn't have to override as many defaults (and probably
because I've learned more about CSS since then).  The one thing I seemed to
be missing was a way to deal with code sections, so I just took what
Bootstrap had and copied it in.  At some point I should revisit this.&lt;/p&gt;

&lt;p&gt;It did take me a while to get my head around Foundation's grid but it was
worth it in the end.  The idea is that you should design for small screens
first and then adjust things for larger screens as necessary. There are
several different default sizes which inherit their properties from the size
below, unless you explicitly override them.  I initially screwed this up by
explicitly defining the grid using the &lt;code&gt;small-#&lt;/code&gt; classes, which obviously
looks ridiculous on small screens.  I fixed it by swapping out &lt;code&gt;small-#&lt;/code&gt; for
&lt;code&gt;medium-#&lt;/code&gt; everywhere in the HTML, after which everything looked reasonable.
Items flowed sensibly into a default column for the small screens and looked
acceptable for larger screens and perfectly fine on desktops.  I could do
more styling of the mobile view but I'd already achieved most of what I was
after.&lt;/p&gt;

&lt;h4&gt;Fixing image galleries and embedded content&lt;/h4&gt;

&lt;p&gt;The only additional thing I used from Bootstrap was the &lt;a href=&quot;http://getbootstrap.com/javascript/#carousel&quot;&gt;Carousel&lt;/a&gt;. I'd
written some custom helper scripts that would take some images and
thumbnails from a specified folder and produce clickable thumbnails with a
slider underneath.  Foundation provides &lt;a href=&quot;http://foundation.zurb.com/docs/components/orbit.html&quot;&gt;Orbit&lt;/a&gt;, so I had to spend time
rewriting my script to produce the necessary HTML.  This actually resulted
in cleaner HTML and one of the features I wanted (the ability to link to a
specific image) was available by default in Orbit.  At this point I also
tried to make the output look better for the case where JavaScript is
disabled (in essence, each image is just displayed as a list).  Below is an
example of an image gallery, taken from a previous post, when I
&lt;a href=&quot;http://amirchaudhry.com/joined-the-computer-lab/&quot;&gt;joined the computer lab&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;gallery&quot;&gt;
  &lt;small&gt;&lt;em&gt;Note: The gallery needs JavaScript but I've tried to make it degrade gracefully. -Amir&lt;/em&gt;&lt;/small&gt;
  &lt;ul class=&quot;inline-list&quot;&gt;
    
      &lt;li&gt;&lt;a&gt;&lt;img src=&quot;http://amirchaudhry.com/images/join-comp-lab/join-comp-lab-thumb-1.png&quot; alt=&quot;join-comp-lab-thumb-1&quot; /&gt;&lt;/a&gt;&lt;/li&gt;
    
      &lt;li&gt;&lt;a&gt;&lt;img src=&quot;http://amirchaudhry.com/images/join-comp-lab/join-comp-lab-thumb-2.png&quot; alt=&quot;join-comp-lab-thumb-2&quot; /&gt;&lt;/a&gt;&lt;/li&gt;
    
      &lt;li&gt;&lt;a&gt;&lt;img src=&quot;http://amirchaudhry.com/images/join-comp-lab/join-comp-lab-thumb-3.png&quot; alt=&quot;join-comp-lab-thumb-3&quot; /&gt;&lt;/a&gt;&lt;/li&gt;
    
  &lt;/ul&gt;
  &lt;ul&gt;
    
    &lt;li class=&quot;gallery-image&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/join-comp-lab/join-comp-lab-1.jpg&quot; alt=&quot;join-comp-lab-1&quot; /&gt;&lt;/li&gt;
    
    &lt;li class=&quot;gallery-image&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/join-comp-lab/join-comp-lab-2.jpg&quot; alt=&quot;join-comp-lab-2&quot; /&gt;&lt;/li&gt;
    
    &lt;li class=&quot;gallery-image&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/join-comp-lab/join-comp-lab-3.jpg&quot; alt=&quot;join-comp-lab-3&quot; /&gt;&lt;/li&gt;
    
  &lt;/ul&gt;
&lt;/div&gt;


&lt;p&gt;Foundation also provides a component called &lt;a href=&quot;http://foundation.zurb.com/docs/components/flex_video.html&quot;&gt;Flex Video&lt;/a&gt;, which allows the
browser to scale videos to the appropriate size.  This fix was as simple as
going back through old posts and wrapping anything that was &lt;code&gt;&amp;lt;iframe&amp;gt;&lt;/code&gt; in a
&lt;code&gt;&amp;lt;div class=&quot;flex-video&quot;&amp;gt;&lt;/code&gt;.  It really was that simple and all the Vimeo and
YouTube items scaled perfectly.  Here's an example of a video from an
earlier post, where I gave a &lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;walkthrough of the ocaml.org site&lt;/a&gt;.
Try changing the width of your browser window to see it scale.&lt;/p&gt;

&lt;div class=&quot;flex-video widescreen vimeo&quot;&gt;
  Video demo
&lt;/div&gt;


&lt;h4&gt;Framework differences&lt;/h4&gt;

&lt;p&gt;Another of the main difference between the two frameworks is that Bootstrap
uses &lt;a href=&quot;http://lesscss.org&quot;&gt;LESS&lt;/a&gt; to manage its CSS whereas Foundation uses &lt;a href=&quot;http://sass-lang.com&quot;&gt;SASS&lt;/a&gt;.  Frankly,
I've no experience with either of them so it makes little difference to me.
It's worth bearing in mind for anyone who's workflow does involve
pre-processing.  Also, Bootstrap is available under the
&lt;a href=&quot;http://getbootstrap.com/getting-started/#license-faqs&quot;&gt;Apache 2 License&lt;/a&gt;, while Foundation is released under
the &lt;a href=&quot;http://foundation.zurb.com/learn/faq.html#question-3&quot;&gt;MIT license&lt;/a&gt;.&lt;/p&gt;

&lt;h4&gt;Summary&lt;/h4&gt;

&lt;p&gt;Overall, the transition was pretty painless and most of the time was spent
getting familiar with the grid, hunting for docs/examples and trying to make
the image gallery work the way I wanted.  I do think Bootstrap's docs are
better but Foundation's aren't bad.&lt;/p&gt;

&lt;p&gt;Although this isn't meant to be a comparison, I much prefer Foundation to
Bootstrap.  If you're not sure which to use then I think the secret is in
the names of the frameworks.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Bootstrap (for me) was a &lt;em&gt;great&lt;/em&gt; way to '&lt;em&gt;bootstrap&lt;/em&gt;' a site quickly with
lots of acceptable defaults -- it was quick to get started but took some
work to alter.&lt;/li&gt;
&lt;li&gt;Foundation seems to provide a great '&lt;em&gt;foundation&lt;/em&gt;' on which to create more
customised sites -- it's more flexible but needs more upfront thought.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;That's pretty much how I'd recommend them to people now.&lt;/p&gt;</content:encoded>
	<dc:date>2013-11-26T21:05:00+00:00</dc:date>
</item>
<item rdf:about="http://amirchaudhry.com/announcing-new-ocamlorg">
	<title>Amir Chaudhry: Announcing the new OCaml.org</title>
	<link>http://amirchaudhry.com/announcing-new-ocamlorg</link>
	<content:encoded>&lt;p&gt;As some of you may have noticed, the new OCaml.org site is now live!&lt;/p&gt;

&lt;p&gt;The DNS may still be propagating so if &lt;a href=&quot;http://ocaml.org&quot;&gt;http://ocaml.org&lt;/a&gt; hasn't updated for you then try http://166.78.252.20.  This post is in two parts: the first is the announcement and the second is a call for content.&lt;/p&gt;

&lt;h3&gt;New OCaml.org website design!&lt;/h3&gt;

&lt;p&gt;The new site represents a major milestone in the continuing growth of the OCaml ecosystem. It's the culmination of a lot of volunteer work over the last several months and I'd specifically like to thank &lt;a href=&quot;https://github.com/Chris00&quot;&gt;Christophe&lt;/a&gt;, &lt;a href=&quot;http://ashishagarwal.org&quot;&gt;Ashish&lt;/a&gt; and &lt;a href=&quot;http://philippewang.info/CL/&quot;&gt;Philippe&lt;/a&gt; for their dedication (the &lt;a href=&quot;https://github.com/ocaml/ocaml.org/commits/master&quot;&gt;commit logs&lt;/a&gt; speak volumes).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/ann-new-ocamlorg/ocaml-home-wire.png&quot; alt=&quot;OCaml.org Wireframes&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We began this journey just over 8 months ago with paper, pencils and a lot of ideas. This led to a comprehensive set of &lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;wireframes and walk-throughs&lt;/a&gt; of the site, which then developed into a collection of &lt;a href=&quot;https://github.com/ocaml/ocaml.org/wiki/Site-Redesign&quot;&gt;Photoshop mockups&lt;/a&gt;. In turn, these formed the basis for the html templates and style sheets, which we've adapted to fit our needs across the site.&lt;/p&gt;

&lt;p&gt;Alongside the design process, we also considered the kind of structure and &lt;a href=&quot;http://lists.ocaml.org/pipermail/infrastructure/2013-July/000211.html&quot;&gt;workflow we aspired to&lt;/a&gt;, both as maintainers and contributors.  This led us to develop completely new tools for &lt;a href=&quot;http://pw374.github.io/posts/2013-09-05-22-31-26-about-omd.html&quot;&gt;Markdown&lt;/a&gt; and &lt;a href=&quot;http://pw374.github.io/posts/2013-10-03-20-35-12-using-mpp-two-different-ways.html&quot;&gt;templating&lt;/a&gt; in OCaml, which are now available in OPAM for the benefit all.&lt;/p&gt;

&lt;p&gt;Working on all these things in parallel definitely had it challenges (which I'll write about separately) but the result has been worth the effort.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://ocaml.org&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/ann-new-ocamlorg/ocaml-home-mockup.png&quot; alt=&quot;OCaml.org&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The journey is ongoing and we still have many more improvements we hope to make. The site you see today primarily improves upon the design, structure and workflows but in time, we also intend to incorporate more information on packages and documentation. With the new tooling, moving the website forward will become much easier and I hope that more members of the community become involved in the generation and curation of content.  This brings me to the second part of this post.&lt;/p&gt;

&lt;h3&gt;Call for content&lt;/h3&gt;

&lt;p&gt;We have lots of great content on the website but there are parts that could do with a refresh and gaps that could be filled.  As a community driven site, we need ongoing contributions to ensure that the site best reflects its members.&lt;/p&gt;

&lt;p&gt;For example, if you do commercial work on OCaml then maybe you'd like to add yourself to the &lt;a href=&quot;http://ocaml.org/community/support.html&quot;&gt;support page&lt;/a&gt;? Perhaps there are tutorials you can help to complete, like &lt;a href=&quot;http://ocaml.org/learn/tutorials/99problems.html&quot;&gt;99 problems&lt;/a&gt;?  If you're not sure where to begin, there are already a number of &lt;a href=&quot;https://github.com/ocaml/ocaml.org/issues?labels=content&quot;&gt;content issues&lt;/a&gt; you could contribute to.&lt;/p&gt;

&lt;p&gt;Although we've gone through a bug-hunt already, feedback on the site is still very welcome.  You can either &lt;a href=&quot;https://github.com/ocaml/ocaml.org/issues&quot;&gt;create an issue&lt;/a&gt; on the tracker (preferred), or email the infrastructure list.&lt;/p&gt;

&lt;p&gt;It's fantastic how far we've come and I look forward to the next phase!&lt;/p&gt;</content:encoded>
	<dc:date>2013-11-20T23:00:00+00:00</dc:date>
</item>
<item rdf:about="http://amirchaudhry.com/migration-plan-ocaml-org">
	<title>Amir Chaudhry: Migration plan for the OCaml.org redesign</title>
	<link>http://amirchaudhry.com/migration-plan-ocaml-org</link>
	<content:encoded>&lt;p&gt;We're close to releasing the new design of ocaml.org but need help from the
OCaml community to identify and fix bugs before we switch next week.&lt;/p&gt;

&lt;p&gt;Ashish, Christophe, Philippe and I have been discussing how we should go
about this and below is the plan for migration.  If anyone would like to
discuss any of this, then the &lt;a href=&quot;http://lists.ocaml.org/listinfo/infrastructure&quot;&gt;infrastructure list&lt;/a&gt; is the best
place to do so.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;We've made a &lt;strong&gt;&lt;a href=&quot;https://github.com/ocaml/ocaml.org/tree/redesign&quot;&gt;new branch&lt;/a&gt;&lt;/strong&gt; on the main ocaml.org repository with
the redesign.  This branch is a fork of the master and we've simply cleaned
up and replayed our git commits there.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;We've built a live version of the new site, which is visible at
&lt;strong&gt;&lt;a href=&quot;http://preview.ocaml.org&quot;&gt;http://preview.ocaml.org&lt;/a&gt;&lt;/strong&gt; - this is rebuilt every few minutes
from the branch mentioned above.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Over the course of one week, we ask the community to review the new site
and &lt;strong&gt;&lt;a href=&quot;https://github.com/ocaml/ocaml.org/issues&quot;&gt;report any bugs or problems&lt;/a&gt;&lt;/strong&gt; on the issue tracker. We &lt;em&gt;triage&lt;/em&gt;
those bugs to identify any blockers and work on those first.  This is the
phase we'll be in from &lt;em&gt;today&lt;/em&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;After one week (7 days), and after blocking bugs have been fixed, we
&lt;strong&gt;merge the redesign branch&lt;/strong&gt; into the master branch.  This would
effectively present the new site to the world.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;During the above, we would not be able to accept any new pull requests on
the master branch but would be happy to accept them on the new, redesign
branch.  Hence, restricting the time frame to one week.&lt;/p&gt;

&lt;p&gt;Please note that the above is only intended to merge the &lt;em&gt;design&lt;/em&gt; and
&lt;em&gt;toolchain&lt;/em&gt; for the new site.  Specifically, we've created new landing
pages, have new style sheets and have restructured the site's contents as
well as made some new libraries (&lt;a href=&quot;http://pw374.github.io/posts/2013-09-05-22-31-26-about-omd.html&quot;&gt;OMD&lt;/a&gt; and &lt;a href=&quot;http://pw374.github.io/posts/2013-10-03-20-39-07-OPAMaging-MPP.html&quot;&gt;MPP&lt;/a&gt;). The new toolchain
means people can write files in markdown, which makes contributing content a
lot easier.&lt;/p&gt;

&lt;p&gt;Since the files are on GitHub, people don't even need to clone the site
locally to make simple edits (or even add new pages). Just click the 'Edit
this page' link in the footer to be taken to the right file in the
repository and GitHub's editing and pull request features will allow you to
make changes and submit updates, all from within your browser (see the
&lt;a href=&quot;https://help.github.com/articles/creating-and-editing-files-in-your-repository&quot;&gt;GitHub Article&lt;/a&gt; for details).&lt;/p&gt;

&lt;p&gt;There is still work to be done on adding new features but the above changes
are already a great improvement to the site and are ready to be reviewed by
the OCaml community and merged.&lt;/p&gt;</content:encoded>
	<dc:date>2013-11-06T11:00:00+00:00</dc:date>
</item>
<item rdf:about="http://ocamllabs.github.com/compiler-hacking/2013/10/30/third-compiler-hacking-session">
	<title>Compiler Hacking: Third OCaml compiler hacking session</title>
	<link>http://ocamllabs.github.com/compiler-hacking/2013/10/30/third-compiler-hacking-session.html</link>
	<content:encoded>&lt;p&gt;It's time for the third Cambridge OCaml compiler-hacking session! This time we're going to be back in the &lt;a href=&quot;http://www.cl.cam.ac.uk/&quot;&gt;Computer Lab&lt;/a&gt;, where the first session was held.&lt;/p&gt;

&lt;p&gt;If you're planning to come along, it'd be helpful if you could &lt;a href=&quot;http://doodle.com/czzp7ik4r72npz6p&quot;&gt;&lt;em&gt;indicate interest via Doodle&lt;/em&gt;&lt;/a&gt; and &lt;a href=&quot;http://lists.ocaml.org/listinfo/cam-compiler-hacking&quot;&gt;&lt;em&gt;sign up to the mailing list&lt;/em&gt;&lt;/a&gt; to receive updates:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Where&lt;/em&gt;: Room &lt;a href=&quot;http://www.cl.cam.ac.uk/research/dtg/openroommap/static/?s=FW11&amp;labels=1&quot;&gt;FW11&lt;/a&gt;, &lt;a href=&quot;http://www.cl.cam.ac.uk/directions/&quot;&gt;Computer Laboratory, Madingley Road&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;When&lt;/em&gt;: 6pm, Wednesday 6th November&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Who&lt;/em&gt;: anyone interested in improving OCaml. Knowledge of OCaml programming will obviously be helpful, but prior experience of working on OCaml internals isn't necessary.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;What&lt;/em&gt;: fixing bugs, implementing new features, learning about OCaml internals&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Wiki&lt;/em&gt;: &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki&quot;&gt;https://github.com/ocamllabs/compiler-hacking/wiki&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We're defining &amp;quot;compiler&amp;quot; pretty broadly, to include anything that's part of the standard distribution, which means at least the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/libref/index.html&quot;&gt;standard library&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual024.html&quot;&gt;runtime&lt;/a&gt;, tools (&lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.01/depend.html&quot;&gt;ocamldep&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc105&quot;&gt;ocamllex&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual026.html#toc107&quot;&gt;ocamlyacc&lt;/a&gt;, etc.), &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-camlp4/manual002.html&quot;&gt;camlp4&lt;/a&gt;, &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual032.html&quot;&gt;ocamlbuild&lt;/a&gt;, the &lt;a href=&quot;http://caml.inria.fr/resources/doc/index.en.html&quot;&gt;documentation&lt;/a&gt;, and the compiler itself. We'll have suggestions for &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;mini-projects&lt;/a&gt; for various levels of experience, but feel free to come along and work on whatever you fancy.&lt;/p&gt;

&lt;p&gt;We'll also be ordering pizza, so if you want to be counted for food you should aim to arrive by 6.30pm.&lt;/p&gt;</content:encoded>
	<dc:date>2013-10-30T11:49:04+00:00</dc:date>
	<dc:creator>OCaml Labs</dc:creator>
</item>
<item rdf:about="http://amirchaudhry.com/fpdays-review">
	<title>Amir Chaudhry: Review of the OCaml FPDays tutorial</title>
	<link>http://amirchaudhry.com/fpdays-review</link>
	<content:encoded>&lt;p&gt;&lt;a href=&quot;http://fpdays.net/2013/sessions/index.php?session=24&quot;&gt;&lt;img src=&quot;http://amirchaudhry.com/images/web/fpdays-logo.png&quot; /&gt;&lt;/a&gt;
Last Thursday a bunch of us from the OCaml Labs team gave an OCaml tutorial
at the &lt;a href=&quot;http://fpdays.net/2013/sessions/index.php?session=24&quot;&gt;FPDays&lt;/a&gt; conference (an event for people interested in Functional
Programming).  &lt;a href=&quot;https://github.com/yallop&quot;&gt;Jeremy&lt;/a&gt; and I led the session with &lt;a href=&quot;http://www.lpw25.net&quot;&gt;Leo&lt;/a&gt;, &lt;a href=&quot;https://github.com/dsheets&quot;&gt;David&lt;/a&gt; and
&lt;a href=&quot;http://philippewang.info/CL/&quot;&gt;Philippe&lt;/a&gt; helping everyone progress and dealing with questions.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://amirchaudhry.com/images/fpdays2013/fpdays2013-01.jpg&quot; /&gt;
It turned out to be by far the &lt;em&gt;most popular session&lt;/em&gt; at the conference with
over 20 people all wanting to get to grips with OCaml!  An excellent turnout
and a great indicator of the interest that's out there, especially when you
offer a hands-on session to people.  This shouldn't be a surprise as we've
had good attendance for the general &lt;a href=&quot;http://www.meetup.com/Cambridge-NonDysFunctional-Programmers/&quot;&gt;OCaml meetups&lt;/a&gt; I've run
and also the &lt;a href=&quot;http://ocamllabs.github.io/compiler-hacking/2013/09/17/compiler-hacking-july-2013.html&quot;&gt;compiler hacking sessions&lt;/a&gt;, which Jeremy and
Leo have been building up (do sign up if you're interested in either of
those!).  We had a nice surprise for attendees, which were
&lt;a href=&quot;http://en.wikipedia.org/wiki/Galley_proof&quot;&gt;uncorrected proof&lt;/a&gt; copies of Real World OCaml and luckily, we had just
enough to go around.&lt;/p&gt;

&lt;p&gt;For the tutorial itself, Jeremy put together a nice sequence of exercises
and a &lt;a href=&quot;https://github.com/ocamllabs/fpdays-skeleton&quot;&gt;skeleton repo&lt;/a&gt; (with helpful comments in the code) so that people
could dive in quickly.  The event was set up to be really informal and the
rough plan was as following:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;em&gt;Installation/Intro&lt;/em&gt; - We checked that people had been able to follow the
&lt;a href=&quot;http://amirchaudhry.com/fpdays-ocaml-session/&quot;&gt;installation instructions&lt;/a&gt;, which we'd sent them in advance.
We also handed out copies of the book and made sure folks were comfortable
with &lt;a href=&quot;http://opam.ocaml.org&quot;&gt;OPAM&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;em&gt;Hello world&lt;/em&gt; - A light intro to get people familiar with the OCaml
syntax and installing packages with OPAM. This would also help people to get
familiar with the toolchain, workflow and compilation.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;em&gt;Monty Hall browser game&lt;/em&gt; - Using &lt;a href=&quot;http://ocsigen.org/js_of_ocaml/&quot;&gt;&lt;code&gt;js_of_ocaml&lt;/code&gt;&lt;/a&gt;, we wanted
people to create and run the &lt;a href=&quot;http://en.wikipedia.org/wiki/Monty_Hall_problem&quot;&gt;Monty Hall problem&lt;/a&gt; in their
browser.  This would give people a taste of some real world interaction by
having to deal with the DOM and interfaces.  If folks did well, they could
add code to keep logs of the game results.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;em&gt;Client-server game&lt;/em&gt; - The previous game was all in the browser (so could
be examined by players) so here the task was to split it into a client and
server, ensuring the two stay in sync.  This would demonstrate the
re-usability of the OCaml code already written and give people a feel for
client server interactions. If people wanted to do more, they could use
&lt;a href=&quot;http://opam.ocaml.org/pkg/ctypes/0.1.1/&quot;&gt;ctypes&lt;/a&gt; and get better random numbers.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;We did manage to stick to the overall scheme as above and we think this is a
great base from which to improve future tutorials.  It has the really nice
benefit of having visual, interactive elements and the ability to run things
both in the browser as well as on the server is a great way to show the
versatility of OCaml.  &lt;code&gt;js_of_ocaml&lt;/code&gt; is quite a mature tool and so it's
no surprise that it's also used by companies such as Facebook (see the recent
&lt;a href=&quot;http://www.youtube.com/watch?v=gKWNjFagR9k&quot;&gt;CUFP talk by Julien Verlaguet&lt;/a&gt; - skip to &lt;a href=&quot;http://www.youtube.com/watch?feature=player_detailpage&amp;v=gKWNjFagR9k#t=1149&quot;&gt;19:00&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;We learned a lot from running this session so we've captured the good, the
bad and the ugly below.  This is useful for anyone who'd like to run an
OCaml tutorial in the future and also for us to be aware of the next
time we do this.  I've incorporated the feedback from the attendees as well
as our own thoughts.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://amirchaudhry.com/images/fpdays2013/fpdays2013-03.jpg&quot; alt=&quot;Heads down and hands on&quot; /&gt;&lt;/p&gt;

&lt;h3&gt;Things we learnt&lt;/h3&gt;

&lt;h4&gt;The Good&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Most people really did follow the install instructions beforehand. This
made things so much easier on the day as we didn't have to worry about
compile times and people getting bored.  A few people had even got in touch
with me the night before to sort out installation problems.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Many folks from OCaml Labs also came over to help people, which meant
no-one was waiting longer than around 10 seconds before getting help.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;We had a good plan of the things we wanted to cover but we were happy to
be flexible and made it clear the aim was to get right into it.  Several
folks told us that they really appreciated this loose (as opposed to rigid)
structure.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;We didn't spend any time lecturing the room but instead got people right
into the code.  Having enough of a skeleton to get something interesting
working was a big plus in this regard. People did progress from the early
examples to the later ones fairly well.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;We had a VM with the correct set up that we could log people into if they
were having trouble locally.  Two people made use of this.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Of course, It was great to have early proofs of the book and these were
well-received.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;img src=&quot;http://amirchaudhry.com/images/fpdays2013/fpdays2013-02.jpg&quot; alt=&quot;RWO books galore!&quot; /&gt;&lt;/p&gt;

&lt;h4&gt;The Bad&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;In our excitement to get right into the exercises, we didn't really give
an overview of OCaml and its benefits.  A few minutes at the beginning would
be enough and it's important so that people can leave with a few sound-bites.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Not everyone received my email about installation, and certainly not the
late arrivals.  This meant some pain getting things downloaded and running
especially due to the wifi (see 'Ugly' below).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A few of the people who &lt;em&gt;had&lt;/em&gt; installed, didn't complete the instructions
fully but didn't realise this until the morning of the session.  There was a good
suggestion about having some kind of test to run that would check
everything, so you'd know if there was something missing.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;We really should have had a cut-off where we told people to use VMs
instead of fixing installation issues and 10-15 minutes would have been
enough.  This would have been especially useful for the late-comers.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;We didn't really keep a record of the problems folks were having so we
can't now go back and fix underlying issues.  To be fair, this would have
been a little awkward to do ad-hoc but in hindsight, it's a good thing to
plan for.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;h4&gt;The Ugly&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;The only ugly part was the wifi.  It turned out that the room itself was a
bit of a dead-spot and that wasn't helped by 30ish devices trying to connect
to one access point!  Having everyone grab packages at the same time in the
morning probably didn't help.  It was especially tricky as all our
mitigation plans seemed to revolve around at least having local connectivity.
In any case, this problem only lasted for the morning session and was a
little better by the afternoon.  I'd definitely recommend a backup plan in
the case of complete wifi failure next time!  One such plan that Leo got
started on was to put the repository and other information onto a flash
drive that could be shared with people.  We didn't need this in the end but
it'll be useful to have something like this prepared for next time.  If
anyone fancies donating a bunch of flash drives, I'll happily receive them!&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Overall, it was a great session and everyone left happy, having completed
most of the tutorial (and with a book!).  A few even continued at home
afterwards and &lt;a href=&quot;https://twitter.com/richardclegg/status/393458073052139520&quot;&gt;got in touch&lt;/a&gt; to let us know that they got
everything working.
It was a great session and thanks to &lt;a href=&quot;https://twitter.com/MarkDalgarno&quot;&gt;Mark&lt;/a&gt;, &lt;a href=&quot;https://twitter.com/JacquiDDavidson&quot;&gt;Jacqui&lt;/a&gt; and the rest of
the FPDays crew for a great conference!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://amirchaudhry.com/images/fpdays2013/fpdays2013-04.jpg&quot; alt=&quot;RWO Book giveaway&quot; /&gt;&lt;/p&gt;

&lt;p&gt;(Thanks to Jeremy, Leo, David and Philippe for contributions to this post)&lt;/p&gt;</content:encoded>
	<dc:date>2013-10-28T12:30:00+00:00</dc:date>
</item>
<item rdf:about="http://amirchaudhry.com/fpdays-ocaml-session">
	<title>Amir Chaudhry: FP Days OCaml Session</title>
	<link>http://amirchaudhry.com/fpdays-ocaml-session</link>
	<content:encoded>&lt;p&gt;On Thursday, along with &lt;a href=&quot;https://github.com/yallop&quot;&gt;Jeremy&lt;/a&gt; and
&lt;a href=&quot;http://www.lpw25.net&quot;&gt;Leo&lt;/a&gt;, I'll be running an OCaml Hands-on Session at
the &lt;a href=&quot;http://fpdays.net/2013/&quot;&gt;FPDays conference&lt;/a&gt;. Below are some prep
instructions for attendees.&lt;/p&gt;

&lt;h3&gt;Preparation for the session&lt;/h3&gt;

&lt;p&gt;If you're starting from scratch, installation can take some time so it's
best to get as much done in advance as possible.  You'll need OPAM (the
package manager), OCaml 4.01 (available through OPAM) and a few libraries
before Thursday.  If you have any issues, please contact Amir.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;OPAM&lt;/strong&gt;: Follow the instructions for your platform at &lt;a href=&quot;http://opam.ocaml.org/doc/Quick_Install.html&quot;&gt;http://opam.ocaml.org/doc/Quick_Install.html&lt;/a&gt;.
OPAM requires OCaml so hopefully the relevant dependencies will kick in and
you'll get OCaml too (most likely version 3.12).  You can get a cup of
coffee while you wait. After installation, run &lt;code&gt;opam init&lt;/code&gt; to initialise OPAM.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;OCaml 4.01&lt;/strong&gt;: We actually need the latest version of OCaml but OPAM
makes this easy.  Just run the following (and get more coffee):&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;opam update
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;opam switch 4.01.0
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;opam config env&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Libraries&lt;/strong&gt;: For the workshop you will need to check that you have the
following installed: &lt;code&gt;libffi&lt;/code&gt;, &lt;code&gt;pcre&lt;/code&gt; and &lt;code&gt;pkg-config&lt;/code&gt;.  This will depend on
your platform so on a Mac with homebrew I would do
&lt;code&gt;brew install libffi pcre pkg-config&lt;/code&gt; or on Debian or Ubuntu
&lt;code&gt;apt-get install libffi-dev&lt;/code&gt;.  After this, two OCaml packages it's worth
installing in advance are &lt;code&gt;core&lt;/code&gt; and &lt;code&gt;js_of_ocaml&lt;/code&gt; so simply run:&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;opam install core js_of_ocaml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;OPAM will take care of the dependencies and the rest we can get on the day!&lt;/p&gt;</content:encoded>
	<dc:date>2013-10-22T21:00:00+00:00</dc:date>
</item>
<item rdf:about="http://anil.recoil.org/2013/10/08/fpdays-real-world-ocaml">
	<title>Anil Madhavapeddy: FPDays 2013 Real World OCaml tutorial in Cambridge</title>
	<link>http://anil.recoil.org/2013/10/08/fpdays-real-world-ocaml.html</link>
	<content:encoded>&lt;a href=&quot;http://fpdays.net/fpdays2013/sessions/index.php?session=24&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/fpdays-logo-thumb.jpg&quot; width=&quot;200&quot; /&gt;&lt;/a&gt;
&lt;p&gt;Yaron Minsky and I have been running OCaml tutorials for a few years at &lt;a href=&quot;http://icfpconference.org&quot;&gt;ICFP&lt;/a&gt; and &lt;a href=&quot;http://cufp.org&quot;&gt;CUFP&lt;/a&gt;, but haven&amp;#8217;t really spread out into the wider conference circuit. Now that &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; is almost finished, the scene is set for doing much more. The first such tutorial is being help at &lt;a href=&quot;http://fpdays.net/fpdays2013/&quot;&gt;FPDays 2013&lt;/a&gt; on October 24th in the lovely Murray Edwards College in Cambridge. Check out the &lt;a href=&quot;http://lanyrd.com/2013/fpdays/&quot;&gt;Lanyrd page&lt;/a&gt; for ticket information, and the &lt;a href=&quot;http://lanyrd.com/2013/fpdays/sckzky/&quot;&gt;OCaml session&lt;/a&gt; page for more information.&lt;/p&gt;

&lt;p&gt;The basic layout of the tutorial is to get started with the guided tour of the &lt;a href=&quot;https://realworldocaml.org&quot;&gt;book&lt;/a&gt;, and then work through building a &lt;a href=&quot;https://bitbucket.org/yminsky/core-hello-world&quot;&gt;distributed message broker&lt;/a&gt;. This gets you familiar with the &lt;a href=&quot;https://github.com/janestreet/core&quot;&gt;Core&lt;/a&gt; standard library, the &lt;a href=&quot;https://github.com/janestreet/async&quot;&gt;Async&lt;/a&gt; event-driven I/O library, and all the strongly-typed RPC plumbing that goes in between. We&amp;#8217;re hoping to have physical preprints of the book available for free to attendees, so do sign up fast if you wish to attend.&lt;/p&gt;

&lt;p&gt;As a bonus, the Cambridge FPDays session will feature Jeremy Yallop working through the book and conducting the tutorial: he has an incredible depth of knowledge about the innards of OCaml&amp;#8217;s type system, and so advanced users will also find a good home in this tutorial to throw questions at him too! For those of you interested in other programming languages, there are also excellent-looking sessions on Erlang, F# and Scala, and Phil Wadler is giving a keynote speech. I&amp;#8217;m most excited about &lt;a href=&quot;http://fpdays.net/fpdays2013/sessions/index.php?session=28&quot;&gt;Sam Aaron&amp;#8217;s session&lt;/a&gt; on live coding and music though. You have to hear it to believe it&amp;#8230;&lt;/p&gt;</content:encoded>
	<dc:date>2013-10-07T23:00:00+00:00</dc:date>
</item>
<item rdf:about="http://pw374.github.io/posts/2013-10-07-12-56-46-highpower-LEDs-for-superbright-light.html">
	<title>Philippe Wang: High-power LEDs for super-bright light</title>
	<link>http://pw374.github.io/posts/2013-10-07-12-56-46-highpower-LEDs-for-superbright-light.html</link>
	<content:encoded>&lt;p&gt;I've been &amp;quot;playing&amp;quot; with COB LEDs for about half a year now. Here's a 
summary of my experience.&lt;/p&gt;
&lt;h3 id=&quot;Preliminaries&quot;&gt;Preliminaries&lt;/h3&gt;
&lt;h4 id=&quot;COBLEDs&quot;&gt;COB LEDs&lt;/h4&gt;
&lt;p&gt;A  &amp;quot;COB LED&amp;quot; is a  basically a bunch of tiny  LEDs put on
together to  provide a very  energy-efficient and usually  very bright
LED (using  both parallel  and series circuit  schemes). Note  that it
means the  voltage of COB LEDs  are not the voltage  of &amp;quot;normal LEDs&amp;quot;,
since putting some LEDs in series means adding up voltage values!&lt;/p&gt;
&lt;h4 id=&quot;AnLEDdoesnotbehavelikeanincandescentlightbulb&quot;&gt;An LED does not behave like an incandescent light bulb&lt;/h4&gt;
&lt;p&gt;Also,  note that  if there's  a roughly  linear relation
between light  intensity and voltage  for classic lamps, it's  not the
case  at all  with LEDs!  With  LEDs, basically,  the light  intensity
varies with the amperage, not the voltage. So if you lower the voltage
by a  very little bit, it will  shine as bright if  the amperage keeps
up; if  you lower  the voltage too  much, it basically  stops emitting
light (e.g.,  if you give  it 16V instead  of 19V, you have  so little
light that it's  really useless), but if you  increase the voltage too
much you still fry your LEDs so you don't want to do that at all.&lt;/p&gt;
&lt;h4 id=&quot;LightcolorsmeasuredinKelvin&quot;&gt;Light colors, measured in Kelvin&lt;/h4&gt;
&lt;p&gt;Basically,  2700K  to   3300K  correspond  to  classic  (discontinued)
incandescent  light bulbs,  and  it's quite  close  to classic  candle
light, which  is about  1850K.  6500K  is day light  as in  &amp;quot;the light
provided by the Sun on a sunny  day at noon&amp;quot;, which seems very cool if
it's  dark outside or  if you  have warm  light around.   My favourite
artificial light color  is generally from 4000K to  5000K.  I find the
3000K quite  acceptable, below  that is too  warm, above 6000K  is too
cool.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Don't  get  me  wrong:  in  this  post, &amp;quot;cool&amp;quot;  not  a  synonym  for
&amp;quot;awesome&amp;quot;, stick to its original meaning instead.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Color_temperature#Categorizing_different_lighting&quot;&gt;Read more on Wikipedia.&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;Colorspectraldistribution&quot;&gt;Color spectral distribution&lt;/h4&gt;
&lt;p&gt;Note  that LEDs  generally have  a very  narrow light  color spectrum.
That  means that  instead  of emitting  light  of a  lot of  different
colors, including  some colors  you don't see  or colors that  are not
very much noticed because they are less intensively emitted, LEDs will
really emitt  just the color  you asked for.  That is not such  a good
thing (it's not  so bad either). But as a  consequence, you might feel
that the light  emitted by an LED is not very  comfortable.  What I do
is that I mainly  use warm light LEDs and I add  a few cool light LEDs
amongst them: it goes  from 1 cool for 6 warms to  1 for 1. The result
of 1  for 1 is quite  nice when it's  bright outside, but it's  not so
nice if it's in the middle of the night.&lt;/p&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;p&gt;spectral power distribution: &lt;a href=&quot;http://en.wikipedia.org/wiki/Spectral_power_distribution&quot;&gt;read more on Wikipedia.&lt;/a&gt;; &lt;a href=&quot;https://www.google.com/search?q=led+spectral+power+distribution&quot;&gt;find more on Google.&lt;/a&gt;&lt;/p&gt;
 &lt;/li&gt;
 &lt;li&gt;&lt;p&gt;LED color rendering index: &lt;a href=&quot;http://en.wikipedia.org/wiki/High_CRI_LED_Lighting&quot;&gt;read more on Wikipedia.&lt;/a&gt;; &lt;a href=&quot;https://www.google.com/search?q=led+color+rendering+index&quot;&gt;find more on Google.&lt;/a&gt;&lt;/p&gt;
 &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;Whynotsimplybuynormallamps&quot;&gt;Why not simply buy normal lamps?&lt;/h3&gt;
&lt;p&gt;Well, buying new  lamps for having more light  implicates buying light
bulbs as  well. I'm  not a very  big fan  of light bulbs  that contain
mercury  because if  you ever  break one,  you'll breathe  mercury gas
(much likely in  small quantities though). And I  can't install lights
on the wall  without asking my landlady for permission,  and even if I
did have permission,  it would mean putting electric  wires inside the
wall and that's not really an  idea that speaks to me (I've never done
that) and  that means painting the  wall afterwards (not a  big fan of
painting walls either). What about  LEDs then? Don't I need to install
them on the wall  anyway? Well, no, I don't! I have  access to some of
the iron  based framework, and  as LEDs are  light weight and  flat, I
stick them  on some material  on which I  put some magnets,  et voilà!
(Now I'm even a bigger fan of strong magnets than before.)&lt;/p&gt;
&lt;p&gt;Well, I  won't deny it, the  main reason why  I wanted to use  LEDs is
that   it's   super  high   tech,   it's   fun,   it's  powerful   and
energy-efficient (and  ecological), it's  nice, it's the  future, it's
geek. Also, we plan on using LEDs massively in university of Cambridge
buildings, starting with the department of computer science.&lt;/p&gt;
&lt;h3 id=&quot;WhatI39veused&quot;&gt;What I've used&lt;/h3&gt;
&lt;h4 id=&quot;LEDs&quot;&gt;LEDs&lt;/h4&gt;
&lt;p&gt;I've           essentially            used           &lt;a href=&quot;http://www.rapidonline.com/Electronic-Components/SMD-Power-LEDs-6W-COB-Star-519319&quot;&gt;6W           COB
LEDs&lt;/a&gt;,
which — according  to the specs given by their  manufacturers — are as
efficient  as 120lm/W  or 108lm/W,  depending on  if you  prefer white
light or  warm white  light. I gave  a try  to more a  classic (though
high-power)  LED before:  &lt;a href=&quot;http://www.rapidonline.com/Electronic-Components/Power-LED-Modules-9x-1W-White-and-Warm-White-502683&quot;&gt;9  pieces of  1W  LEDs put  together on  an
aluminium
disc&lt;/a&gt;. Well,
I switched  to COB LEDs for three  reasons. The first one  is that COB
LEDs are more energy-efficient.  The second one is that the voltage of
the COB  LEDs that I use is  higher (19V instead of  10V), which means
that for a  given wattage, the current intensity  (amperage) is lower,
and  that means  less chance  for the  wires to  heat...  (I'm  not an
electronician nor  a physisist, please  correct me if I'm  wrong.) And
the third one is  that COB LEDs are very compact. The  &amp;quot;9 pieces of 1W
LEDs on a  disc&amp;quot; is really big: the diameter is  88mm. The drawback is
that the COB LEDs that I use are only available in the 6500K and 3000K
color  temperatures, whereas the  other ones  are available  in 6500K,
4000K, 3000K and 2500K; 400K being my favourite.&lt;/p&gt;
&lt;h4 id=&quot;Powersupplyunits&quot;&gt;Power supply units&lt;/h4&gt;
&lt;p&gt;It's not that  easy to provide electrical power  to LEDs... because we
need a  potentially quite  high amperage, the  right voltage,  and the
latter has to  be very stable (or at least never  reach a higher value
than the expected  one, otherwise the LEDs burn  and die quite easily,
and we  don't want to kill  some hardware that's supposed  to last ten
and up to thirty years).&lt;/p&gt;
&lt;p&gt;I     recommend    &lt;a href=&quot;http://www.rapidonline.com/Electrical-Power/36w-Volt-Adjustable-Multi-Output-Psu-eup-85-2908&quot;&gt;this    power     supply    unit     (PSU)    from
Rapid&lt;/a&gt;
if you're  powering at most 30  watts of LEDs  at a voltage of  24V or
less for three  reasons: it seems to  me so far that it's  a very good
quality PSU, the voltage is well  regulated, it does provide up to 30W
without  complaining  or  heating  up,  it switches  on  very  quickly
(virtually instantaneously). I have used 2 of them for about 6 months.
(I haven't  tried to make it  work at 36W because  it would supposedly
diminish its lifespan.)&lt;/p&gt;
&lt;p&gt;Well, that 36W PSU is  currently (early October 2013)  out of stock,
and since I visited  (randomly) a  Maplin store  and saw 
&lt;a href=&quot;http://www.maplin.co.uk/maplin-120w-auto-voltage-universal-laptop-power-supply-with-usb-charging-531311&quot;&gt;this 120W  laptop power supply
unit&lt;/a&gt; for less than £40,
I bought two of them to give  them a shot. They are a lot cheaper than
the 36W PSU I've been using so far, if we compare the price-over-power
ratio.  Well,  the voltage  they deliver seems  okay: according  to my
cheap multimeter,  so it's not really the  most reliable measurement,
they deliver 19.2V when using a  19V head. The main drawback of this adaptor
is that  it takes  time to &amp;quot;boot&amp;quot;! (Yes, it means it will &lt;em&gt;not&lt;/em&gt; deliver power 
during those 5 seconds.)   It's not  really a problem  for a
laptop, but for a lighting system,  having to wait 5 full seconds 
just seems  like forever. So it means that  if I want instantaneous
light-on feature, I need a switch  between the PSU and the LED instead
of between the wall plug and  the PSU. Well, in practice, I think I'll
simply wait 5  seconds, because I'll only use them when  I want a very
very bright light, since I  already have 2 LED-based lighting devices
powered by those 36W PSUs that provide power instantaneously.&lt;/p&gt;
&lt;p&gt;The other drawback is that it's made to work with (existing) laptops
and they provide one connector per model (i.e., shape of the head and
voltage), so you can't use any connector and still assume you'll be able
to select the voltage: here, the head determines the voltage you'll get.&lt;/p&gt;
&lt;h4 id=&quot;Heat&quot;&gt;Heat!&lt;/h4&gt;
&lt;p&gt;One of the biggest (potential) problem  with COB LEDs is that, as they
are  very powerful and  very tiny,  you're supposed  to stick  them on
something that can dissipate the heat that they produce. What I learnt
from that is that iron is  a very very slow heat conductor compared to
aluminium.               I'm              using             &lt;a href=&quot;http://www.amazon.co.uk/dp/B002HMQE86/&quot;&gt;aluminium
rulers&lt;/a&gt;   because   it's   the
cheapest flat thing made of  aluminium that I could find.  Three rules
very easily dissipate  the heat produced by 4  LEDs.  I tried tripling
the density  of LEDs... It was not  a good idea, as  the rulers become
hot quite rapidly: within a few  minutes, they reach close to 50°C. So
with 4 LEDs per ruler, active fan cooling may dissipate the heat.&lt;/p&gt;
&lt;h4 id=&quot;StickingCOBLEDs&quot;&gt;Sticking COB LEDs&lt;/h4&gt;
&lt;p&gt;To    stick   LEDs,    I   used    some   &lt;a href=&quot;http://www.akasa.com.tw/update.php?tpl=product/product.detail.tpl&amp;type=Accessories&amp;type_sub=Thermal%20Interface&amp;model=AK-TT12-80&quot;&gt;akasa    thermal   adhesive
tape&lt;/a&gt; that I bought on
Amazon, and it works pretty well.&lt;/p&gt;
&lt;h4 id=&quot;Theworstpart&quot;&gt;The worst part...&lt;/h4&gt;
&lt;p&gt;... is obviously, to me, the soldering part. It's quite hard to solder
those COB LEDs because the contact spots are very small, so it takes
a tremendous amount of time.&lt;/p&gt;
&lt;h3 id=&quot;Overall&quot;&gt;Overall&lt;/h3&gt;
&lt;h4 id=&quot;Whybrightlightisimportant&quot;&gt;Why bright light is important...&lt;/h4&gt;
&lt;p&gt;I feel  that it's important to  me to face (very)  bright light during
the day, and  it's best if it comes directly  from the sun. Apparently
(although I'm not  a hundred percent sure) it's  actually important to
be exposed to (very) bright light at least 30 minutes a day.&lt;/p&gt;
&lt;p&gt;So, instead of using a very expensive 
&lt;a href=&quot;https://www.google.com/search?q=SAD+light&quot;&gt;S.A.D.  light&lt;/a&gt; 
to prevent potential
&lt;a href=&quot;http://en.wikipedia.org/wiki/Seasonal_affective_disorder&quot;&gt;seasonal affective disorder&lt;/a&gt;,
well, I'm using very bright state-of-the-art LEDs to light up my home. :-)&lt;/p&gt;
&lt;h4 id=&quot;Conclusion&quot;&gt;Conclusion&lt;/h4&gt;
&lt;p&gt;LEDs are awesome because they need very little space compared to other
light-emitting devices.&lt;/p&gt;
&lt;p&gt;As they're very energy-efficient, using them for indirect lighting
doesn't consume too much electricity.&lt;/p&gt;
&lt;p&gt;They can last up to 10 or 30 years if they're taken well care of.
So once you make them, you don't need to worry about them for a while...
Well, I'm not sure the power supply units can last that many years,
but it's not the hard part to change.&lt;/p&gt;
&lt;p&gt;If    you     live    in    Cambridge    (UK),     you    could    use
&lt;a href=&quot;http://makespace.org&quot;&gt;Makespace&lt;/a&gt;  to build  your own  LED-based super
bright and/or  super smart lighting system. Well,  given my low-budget
when I  started building those LED-based lighting  systems, I couldn't
afford Makespace membership, so I kind of have all I need to handcraft
at home.&lt;/p&gt;
&lt;h5 id=&quot;Pictures&quot;&gt;Pictures&lt;/h5&gt;
&lt;p&gt;4 COB LEDs on 3 aluminium  rulers, in parallel.  The 3 aluminum rulers
are  stuck  together using  aluminium  tape,  which  has good  thermal
conductivity, reflects light not too badly and is not too expensive.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://pw374.github.io/img/4-COB-LEDs-off.jpg&quot;&gt;&lt;img src=&quot;http://pw374.github.io/img/4-COB-LEDs-off-640.jpg&quot; alt=&quot;4-COB-LEDs-off-640.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://pw374.github.io/img/4-COB-LEDs-off-unplugged.jpg&quot;&gt;&lt;img src=&quot;http://pw374.github.io/img/4-COB-LEDs-off-unplugged-640.jpg&quot; alt=&quot;4-COB-LEDs-off-unplugged-640.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://pw374.github.io/img/4-COB-LEDs-off2.jpg&quot;&gt;&lt;img src=&quot;http://pw374.github.io/img/4-COB-LEDs-off2-640.jpg&quot; alt=&quot;4-COB-LEDs-off2-640.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h6 id=&quot;IfyoudowantLEDsbutdon39twanttosolderanything&quot;&gt;If you do want LEDs but don't want to solder anything&lt;/h6&gt;
&lt;p&gt;Well, you may find a lot of websites on
&lt;a href=&quot;https://www.google.com/search?q=COB+LED&quot;&gt;Google&lt;/a&gt; selling LEDs, you may also try
&lt;a href=&quot;http://kosilum.com/&quot;&gt;this one&lt;/a&gt;, which belongs to a friend of mine.&lt;/p&gt;</content:encoded>
	<dc:date>2013-10-07T12:56:46+00:00</dc:date>
	<dc:creator>Philippe Wang</dc:creator>
</item>
<item rdf:about="http://anil.recoil.org/2013/10/06/travis-secure-ssh-integration">
	<title>Anil Madhavapeddy: Using Travis for secure deployments with SSH</title>
	<link>http://anil.recoil.org/2013/10/06/travis-secure-ssh-integration.html</link>
	<content:encoded>&lt;a href=&quot;http://travis-ci.org&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/travis-mascot-200px.png&quot; /&gt;&lt;/a&gt;
&lt;p&gt;In my &lt;a href=&quot;http://anil.recoil.org/2013/09/30/travis-and-ocaml.html&quot;&gt;previous post&lt;/a&gt; on Travis, I explained how it can be used to easily test OCaml packages on GitHub without having to host any infrastructure yourself.&lt;/p&gt;

&lt;p&gt;The next step I wanted to investigate was how to use Travis to trigger service deployments after a successful build. One nice feature that Travis has is &lt;a href=&quot;http://about.travis-ci.org/docs/user/encryption-keys/&quot;&gt;support for encrypted environment variables&lt;/a&gt;. The basic workflow is that you encrypt key/value pairs using a public key that they publish per GitHub repository. Once registered, this is made available as a decrypted environment variable within the Travis worker. You can use this to transmit API keys or other authentication data that you need to commit to the &lt;code&gt;travis.yml&lt;/code&gt; file, but obviously can&amp;#8217;t leave on a public repository for the world to see.&lt;/p&gt;

&lt;p&gt;The small hitch with this whole scheme is that there&amp;#8217;s a very small limit of about 90 bytes or so for the size of each individual environment variable that&amp;#8217;s exported, and so you can&amp;#8217;t just stash an SSH private key in there. Instead, it needs to be Base64 encoded, split it up into multiple environment variables of the right size, and then reassembled within the Travis VM. Rather than deal with importable shell scripts between MacOS X and Linux, I created a small &lt;code&gt;travis-senv&lt;/code&gt; command-line binary to make this easier.&lt;/p&gt;

&lt;p&gt;To use it, just &lt;code&gt;opam install travis-senv&lt;/code&gt; and follow the instructions on the &lt;a href=&quot;https://github.com/avsm/travis-senv&quot;&gt;README at the homepage&lt;/a&gt;. Here&amp;#8217;s the fragment of shell script that pushes the build output to another GitHub repository:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;sh&quot;&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$DEPLOY&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# get the secure key out for deployment&lt;/span&gt;
  opam install travis-senv
  mkdir -p ~/.ssh
  &lt;span class=&quot;nv&quot;&gt;SSH_DEPLOY_KEY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;~/.ssh/id_dsa
  travis-senv decrypt &amp;gt; &lt;span class=&quot;nv&quot;&gt;$SSH_DEPLOY_KEY&lt;/span&gt;
  chmod 600 &lt;span class=&quot;nv&quot;&gt;$SSH_DEPLOY_KEY&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Host mirdeploy github.com&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/config
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;   Hostname github.com&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/config
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;   StrictHostKeyChecking no&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/config
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;   CheckHostIP no&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/config
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;   UserKnownHostsFile=/dev/null&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/config
  git config --global user.email &lt;span class=&quot;s2&quot;&gt;&amp;quot;travis@openmirage.org&amp;quot;&lt;/span&gt;
  git config --global user.name &lt;span class=&quot;s2&quot;&gt;&amp;quot;Travis the Build Bot&amp;quot;&lt;/span&gt;
  git clone git@mirdeploy:mirage/mirage-www-deployment
  &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;mirage-www-deployment
  mkdir -p xen/&lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt;
  cp ../src/mir-www.xen ../src/mir-www.map ../src/www.conf xen/&lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt;
  bzip2 -9 xen/&lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt;/mir-www.xen
  git pull --rebase
  git add xen/&lt;span class=&quot;nv&quot;&gt;$TRAVIS_COMMIT&lt;/span&gt;
  git commit -m &lt;span class=&quot;s2&quot;&gt;&amp;quot;adding $TRAVIS_COMMIT&amp;quot;&lt;/span&gt;
  git push
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I&amp;#8217;ve been using this to automate the construction of the &lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage Xen unikernel&lt;/a&gt; homepage. Every time there&amp;#8217;s a push to the &lt;a href=&quot;https://github.com/mirage/mirage-www&quot;&gt;mirage-www&lt;/a&gt;, the &lt;a href=&quot;https://github.com/mirage/mirage-www/blob/master/.travis-ci.sh&quot;&gt;Travis scripts&lt;/a&gt; now retrieve an SSH deployment key using &lt;code&gt;travis-senv&lt;/code&gt;, and push the results of the build to the &lt;a href=&quot;https://github.com/mirage/mirage-www-deployment&quot;&gt;mirage-www-deployment&lt;/a&gt; repository that stores the build output. This repository is polled by the hosting machines we have to look for new kernels and rotate the website (but more on this later &amp;#8211; I&amp;#8217;m just integrating the EC2 and Rackspace scripts to remove this step entirely next!)&lt;/p&gt;</content:encoded>
	<dc:date>2013-10-05T23:00:00+00:00</dc:date>
</item>
<item rdf:about="http://pw374.github.io/posts/2013-10-04-13-31-30-example-use-case-of-MPP.html">
	<title>Philippe Wang: (Example) A use case of MPP in an OCaml program</title>
	<link>http://pw374.github.io/posts/2013-10-04-13-31-30-example-use-case-of-MPP.html</link>
	<content:encoded>&lt;p&gt;Let's say you have a big variant type such as this one:&lt;/p&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;B&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;C&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;D&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;E&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;F&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;G&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and you want to implement a &lt;code&gt;t -&amp;gt; string&lt;/code&gt; function.
With MPP, you can write this:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;&lt;span class=&quot;keywordsign&quot;&gt;{&amp;#60;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&quot;A&quot;&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;B&quot;&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;C&quot;&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;D&quot;&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;E&quot;&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;F&quot;&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;G&quot;&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;&amp;#62;&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;keyword&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;{&amp;#60;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;iter&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;constructor module&quot;&gt;Printf&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;| %s &quot;&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;&amp;#62;&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;to_string&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;
&lt;span class=&quot;keywordsign&quot;&gt;{&amp;#60;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;iter&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;keyword&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;Printf&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;| %s -&amp;#62; %S&quot;&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;&amp;#62;&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and then you have that:&lt;/p&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;B&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;C&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;D&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;E&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;F&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;G&lt;/span&gt; 
&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;to_string&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;
&lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;A&quot;&lt;/span&gt;
&lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;B&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;B&quot;&lt;/span&gt;
&lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;C&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;C&quot;&lt;/span&gt;
&lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;D&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;D&quot;&lt;/span&gt;
&lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;E&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;E&quot;&lt;/span&gt;
&lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;F&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;F&quot;&lt;/span&gt;
&lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;G&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As you may see, if you grow the type &lt;code&gt;t&lt;/code&gt; by adding more cases, you don't have to 
manually update the function &lt;code&gt;to_string&lt;/code&gt;.&lt;/p&gt;</content:encoded>
	<dc:date>2013-10-04T13:31:30+00:00</dc:date>
	<dc:creator>Philippe Wang</dc:creator>
</item>
<item rdf:about="http://pw374.github.io/posts/2013-10-03-20-39-07-OPAMaging-MPP.html">
	<title>Philippe Wang: OPAMaging MPP</title>
	<link>http://pw374.github.io/posts/2013-10-03-20-39-07-OPAMaging-MPP.html</link>
	<content:encoded>&lt;p&gt;&lt;em&gt;Please read
&lt;a href=&quot;http://pw374.github.io/posts/2013-10-03-20-35-12-using-mpp-two-different-ways.html&quot;&gt;this&lt;/a&gt; if
you want to know more about MPP.&lt;/em&gt;&lt;/p&gt;
&lt;h3 id=&quot;AnnouncementI39veOPAMagedMPP&quot;&gt;Announcement: I've OPAMaged MPP!&lt;/h3&gt;
&lt;p&gt;So, I've eventually OPAMaged MPP (i.e., made an OPAM package for MPP)!
Now MPP officially  has a version number, and at  the time I'm writing
these lines, the  current version is 0.1.0.&lt;/p&gt;
&lt;h3 id=&quot;Happythatiteventuallyworked&quot;&gt;Happy that it eventually worked...&lt;/h3&gt;
&lt;p&gt;Yes, I'm  quite happy that MPP  now has an  OPAM package. To do  so, I
copied the &lt;code&gt;_oasis&lt;/code&gt; and the &lt;code&gt;Makefile&lt;/code&gt; files from MPP and adapted them
for MPP.  At  first I wanted to avoid using  oasis because for reasons
that are still unknown to me,  some people told me (half-joking?) that
it was better not to depend on  oasis... Well, actually I tried not to
depend on  oasis!  I  tried but  just couldn't  build in  a reasonable
amount  of time  a  Makefile that  met the  requirements  for an  OPAM
package. Building  MPP is  quite trivial, installing  it in  the right
place and being able to uninstall it, well, less trivial (perhaps I've
just missed a simple thing in the process).&lt;/p&gt;
&lt;h3 id=&quot;Asidenote&quot;&gt;A side note&lt;/h3&gt;
&lt;p&gt;Although the  MPP project  started a  while ago now,  it's still  at a
pretty early  stage of development  since I've been mostly  working on
the   tools   that   are   needed  to   build   the   &lt;a href=&quot;http://amirchaudhry.com/ocamlorg-request-for-feedback/&quot;&gt;new   ocaml.org
website&lt;/a&gt;, such
as  &lt;a href=&quot;https://github.com/pw374/omd/&quot;&gt;OMD&lt;/a&gt; &lt;a href=&quot;http://pw374.github.io/posts/2013-09-05-22-31-26-about-omd.html&quot;&gt;(read  about the  experience
here)&lt;/a&gt;,
which       I've        developed       from        scratch,       and
&lt;a href=&quot;https://github.com/ocamllabs/opam-doc/&quot;&gt;OPAM-DOC&lt;/a&gt;,  which  &lt;a href=&quot;http://pw374.github.io/posts/2013-09-24-14-19-56-on-the-implementation-of-opamdoc.html&quot;&gt;I had  to
contribute
to&lt;/a&gt;
at some  point because  we had to  fix it while  having a  very little
amount time.&lt;/p&gt;
&lt;p&gt;Now that  OMD has become  quite stable  (although some bugs  are still
 found from time to time, which is normal) ../..&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;No product of  human intellect comes out right the  first time. We
 rewrite  sentences, rip  out knitting  stitches, replant  gardens,
 remodel houses,  and repair  bridges. Why  should software  be any
 different? – Lauren Ruth Wiener&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;../..  and  since I'm  not the only  contributor on  opam-doc (Vincent
Botbol is still participating, he  fixed quite a nasty-to-fix bug last
weekend, and Leo White is still  working on the JavaScript part), it's
not  as much  time-taking as  OMD, but  because it's  not my  code and
because it's using some syntax extension (yeah, CamlP4's in the place,
yo), patching it is not as simple as it could be...&lt;/p&gt;</content:encoded>
	<dc:date>2013-10-03T20:39:07+00:00</dc:date>
	<dc:creator>Philippe Wang</dc:creator>
</item>
<item rdf:about="http://pw374.github.io/posts/2013-10-03-20-35-12-using-mpp-two-different-ways.html">
	<title>Philippe Wang: Using MPP in two differents ways</title>
	<link>http://pw374.github.io/posts/2013-10-03-20-35-12-using-mpp-two-different-ways.html</link>
	<content:encoded>&lt;h3 id=&quot;MPPisnowanOPAMpackage&quot;&gt;MPP is now an OPAM package&lt;/h3&gt;
&lt;p&gt;First of all, I've to say I've finally made an OPAM package 
for MPP! At the time I'm writing these words, it's still waiting
for merging. &lt;a href=&quot;http://pw374.github.io/posts/2013-10-03-20-39-07-OPAMaging-MPP.html&quot;&gt;Read more here.&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;DescriptionofMPP&quot;&gt;Description of MPP&lt;/h3&gt;
&lt;p&gt;MPP is a preprocessor that has been designed to allow any (non-insane)
programming language to  be used as a preprocessor  for any text-based
file. The particularity is that  the users keep their initial language
as their  primary language:  the language(s) brought  by MPP  is (are)
secondary. It  means that ideally, if  you give a random  text file to
MPP, MPP  will return it  unchanged! And  in practice, you  can always
parameterize MPP  (on the command line,  or in an MPP  file) such that
for a given text file, MPP will return it unchanged.&lt;/p&gt;
&lt;p&gt;Of course, the purpose of MPP is not to replace the &amp;quot;cat&amp;quot; command!
But having the property that you can guarantee that MPP will behave as
the &amp;quot;cat&amp;quot; command if you want it to is important, because it means you
can customise MPP such that MPP can work for any text file.&lt;/p&gt;
&lt;p&gt;Side note:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Well,  if you  discover a  language that has  some kind  of infinite
 semantics, which  are somehow automatically defined  by itself, such
 that  every  possible  sequence  of  bytes has  a  meaning  in  this
 language, MPP  might not  work because  you would  have a  hard time
 finding a token that's not already taken, since there're all already
 taken...  But I don't think that it's a realistic scenario, so let's
 just forget about it.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;PrincipleofMPP&quot;&gt;Principle of MPP&lt;/h3&gt;
&lt;p&gt;The principle on which MPP is based is pretty simple. The users define
the tokens they want to use to determine the beginning and the end 
of MPP blocks. And there are 3 kinds of MPP blocks:&lt;/p&gt;
&lt;ol&gt;
 &lt;li&gt;basic MPP block;&lt;/li&gt;
 &lt;li&gt;basic MPP block with possible nesting;&lt;/li&gt;
 &lt;li&gt;foreign MPP block.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The first and the second are used  for the same things except that the
second allows nesting. The third kind  is the most interesting one, as
it's the one  that allows to embed virtually  any programming language
as a preprocessor language.&lt;/p&gt;
&lt;p&gt;Side note:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Well,  you can't easily use  pure lambda calculus as  a preprocessor
 language.   Your programming  language has  to have  some notion  of
 input/output to  process text. Using  pure lambda calculus  might be
 very  painful and  it  would start  by making  it  impure enough  to
 interact with the rest of the world.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;Example1thebasics&quot;&gt;Example 1: the basics&lt;/h3&gt;
&lt;p&gt;So, let's say  you're writing a program using the  OCaml language, and
you want &lt;code&gt;x&lt;/code&gt; to be a random integer.&lt;/p&gt;
&lt;p&gt;You can write this:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;Random&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;max_int&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and if you want to be sure  that the number is different each time you
execute  your  program,  you   should  use  &lt;code&gt;Random.self_init&lt;/code&gt;  or  an
equivalent.&lt;/p&gt;
&lt;p&gt;Now what if you want a random number to be generated at compile time?
You can't do it in pure OCaml. You need to preprocess your file and/or
to read from another file...&lt;/p&gt;
&lt;p&gt;With MPP, you can write this:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;keywordsign infix&quot;&gt;&amp;#60;&amp;#60;&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;keywordsign infix&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;constructor module&quot;&gt;RANDOM&lt;/span&gt; &lt;span class=&quot;keywordsign infix&quot;&gt;&amp;#62;&amp;#62;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;if you use mpp with these parameters: &lt;code&gt;-so '&amp;lt;&amp;lt;' -sc '&amp;gt;&amp;gt;'&lt;/code&gt; to set
opening and closing tokens to &lt;code&gt;&amp;lt;&amp;lt;&lt;/code&gt; and &lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;. 
Default tokens are respectively &lt;code&gt;((&lt;/code&gt; and &lt;code&gt;))&lt;/code&gt; but if you're writing
some OCaml code, you shouldn't use &lt;code&gt;((&lt;/code&gt; and &lt;code&gt;))&lt;/code&gt; because
there's quite a chance that they appear as OCaml code in your file.&lt;/p&gt;
&lt;p&gt;What happens with MPP is that it simply echoes everything that is
not MPP, and when it's MPP, it interprets the commands.
The &lt;code&gt;cmd&lt;/code&gt; builtin is probably the simplest and the most powerful,
since it calls your shell with what follows &lt;code&gt;cmd&lt;/code&gt;. The first
line is the command that is called, and what follows is given to
the command as its standard input.&lt;/p&gt;
&lt;p&gt;So, basically,&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;keywordsign infix&quot;&gt;&amp;#60;&amp;#60;&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;keywordsign infix&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;constructor module&quot;&gt;RANDOM&lt;/span&gt; &lt;span class=&quot;keywordsign infix&quot;&gt;&amp;#62;&amp;#62;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;mod&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;given to MPP has the same semantics as this Bash script&lt;/p&gt;
&lt;pre class=&quot;bash&quot;&gt;&lt;code class=&quot;bash&quot;&gt;echo -n 'let x = '
echo $RANDOM
echo ' mod 42'&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now, instead of using non-nesting tokens, you can use nesting tokens,
the only difference being that you can nest commands. Wait, what if
you nest with non-nesting commands? Well, MPP has a very simple syntax.
If you can't nest, you really can't nest.
So, if you write &lt;code&gt;&amp;lt;&amp;lt; echo &amp;lt;&amp;lt; echo 42 &amp;gt;&amp;gt; &amp;gt;&amp;gt;&lt;/code&gt; it just doesn't work!
Moreover, you have a syntax error because the first &lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt; is seen as the
closing token for the first &lt;code&gt;&amp;lt;&amp;lt;&lt;/code&gt;, and MPP stops when there's a syntax
error. If you want to echo &lt;code&gt;&amp;lt;&amp;lt; echo 42 &amp;gt;&amp;gt;&lt;/code&gt;, it is possible, you just
have to name your block, as in &lt;code&gt;&amp;lt;&amp;lt;name echo &amp;lt;&amp;lt; echo 42 &amp;gt;&amp;gt; name&amp;gt;&amp;gt;&lt;/code&gt;
and then it just works!&lt;/p&gt;
&lt;p&gt;Note that with nesting tokens, you have to name &lt;strong&gt;all&lt;/strong&gt; outer tokens.
The default tokens are &lt;code&gt;{{&lt;/code&gt; and &lt;code&gt;}}&lt;/code&gt;. So, to nest some commands, you
can write for instance &lt;code&gt;{{name set x {{ cmd cat foo.txt }} name}}&lt;/code&gt;.
Note that the the most inner block doesn't have to be a nesting one,
as it doens't nest any. It means you could write
&lt;code&gt;{{name set x &amp;lt;&amp;lt; cmd cat foo.txt &amp;gt;&amp;gt; name}}&lt;/code&gt; instead.
And note that only the most inner nesting block can be nameless and that's 
&lt;em&gt;in some cases only&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Note: the  technique presented above (in  example 1) has been  used to
generate the new OCaml website.&lt;/p&gt;
&lt;h3 id=&quot;Example2usingOCamlasapreprocessorlanguage&quot;&gt;Example 2: using OCaml as a preprocessor language&lt;/h3&gt;
&lt;p&gt;When MPP is used with the option &lt;code&gt;-l&lt;/code&gt;, it produces a program that prints
the file, using information provided to MPP about the language specified
with &lt;code&gt;-l&lt;/code&gt;. For instance, &lt;code&gt;mpp -l ocaml&lt;/code&gt; will produce an OCaml program.&lt;/p&gt;
&lt;p&gt;If you apply &lt;code&gt;mpp -l ocaml&lt;/code&gt; to a file F that contains no MPP commands,
then you have an OCaml  program  that, when executed, produces the 
original file F.&lt;/p&gt;
&lt;p&gt;When you use &lt;code&gt;-l ocaml&lt;/code&gt;, all &amp;quot;foreign blocks&amp;quot; are considered as 
OCaml code and it will just &amp;quot;pass through&amp;quot;.
So, if you write &lt;code&gt;42 {&amp;lt; let x = 23 &amp;gt;} Hello&lt;/code&gt;,
it will be translated to this program:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;print_string&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;42 &quot;&lt;/span&gt;
&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;23&lt;/span&gt;
&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;print_string&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot; Hello&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It's not exactly as flexible as &amp;quot;you can write anything at the top-level&amp;quot;.
Indeed, you may write any valid top-level definition. It could be
a type definition, a module definition, really anything you want that
is valid at the top level and that does not require double semi-colons.
That is, you cannot write &lt;code&gt;{&amp;lt; print_int 42 &amp;gt;}&lt;/code&gt;because it's not a valid top-level phrase, you should write this instead
&lt;code&gt;{&amp;lt; let _ = print_int 42 &amp;gt;}&lt;/code&gt;.
If you really love playing at edges, you could write
&lt;code&gt;{&amp;lt; ;; print_int 42 ;; &amp;gt;}&lt;/code&gt;and it might work... if there is something preceding. If there isn't
(but that's not trivial to guess because the semantics of MPP might 
change on this precise point, I don't know, I can't promise right now),
then you could perhaps write &lt;code&gt;{&amp;lt; print_int 42;; &amp;gt;}&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;But you can't convert a block of text into an OCaml function. You can't
write something like you would do in PHP, such as:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;ul&amp;gt;
  {&amp;lt; for i = 1 to 42 do &amp;gt;}
    &amp;lt;li&amp;gt; {&amp;lt; print_int i &amp;gt;} &amp;lt;/li&amp;gt;
  {&amp;lt; done &amp;gt;}
&amp;lt;/ul&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Oh but wait!  You can use functors...&lt;/p&gt;
&lt;p&gt;So in functor-style, you can write this:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;ul&amp;gt;
  {&amp;lt; module I (X:sig val i : int end) = struct &amp;gt;}
    &amp;lt;li&amp;gt; {&amp;lt; let _ = print_int X.i &amp;gt;} &amp;lt;/li&amp;gt;
  {&amp;lt; end &amp;gt;}
  {&amp;lt; let _ = for i = 1 to 42 do
       let module M = I(struct let i = i end) in
       ()
     done &amp;gt;}
&amp;lt;/ul&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Sorry if that hurts  your eyes, but life is not  always easy.  Oh, and
if you think it's  overkill, well, of course it is,  that's a tiny toy
example! I'm actually using this  functor-style to write this blog. It
means that  I generate a  template with the functor-style  headers and
footers and I write inside the functor using Markdown, and when I need
to write some OCaml code, I use MPP features. And when I need to print
MPP stuff, I use  the 2 worlds of MPP, but it's late  and I don't want
to go into details just right  now. What's important is that it's nice
and it  works. I've  always wanted  to be able  to &lt;em&gt;easily&lt;/em&gt;  embed the
OCaml language in any text (LaTeX, ML, HTML, Bash, etc.) file, and now
I can!!  :)&lt;/p&gt;</content:encoded>
	<dc:date>2013-10-03T20:35:12+00:00</dc:date>
	<dc:creator>Philippe Wang</dc:creator>
</item>
<item rdf:about="http://anil.recoil.org/2013/10/03/merlin-and-vim">
	<title>Anil Madhavapeddy: Intellisense for OCaml with Vim and Merlin</title>
	<link>http://anil.recoil.org/2013/10/03/merlin-and-vim.html</link>
	<content:encoded>&lt;a href=&quot;http://anil.recoil.org/images/vim-merlin-autocomplete.png&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/vim-merlin-autocomplete-thumb.png&quot; width=&quot;250&quot; /&gt;&lt;/a&gt;
&lt;p&gt;I&amp;#8217;m finalizing the installation instructions for &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; and finally got around to configuring the awesome &lt;a href=&quot;https://github.com/def-lkb/merlin&quot;&gt;Merlin editor&lt;/a&gt; tool. I pretty much never configure my editor, so here are my notes on getting Merlin working with Vim completely from scratch on MacOS X (I&amp;#8217;m on 10.9DP7, but this should work with earlier versions of MacOS X too).&lt;/p&gt;

&lt;p&gt;First, install some basic plugin tools by following the Synastic &lt;a href=&quot;https://github.com/scrooloose/syntastic&quot;&gt;installation instructions&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Install &lt;a href=&quot;https://github.com/tpope/vim-pathogen&quot;&gt;vim-pathogen&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;sh&quot;&gt;mkdir -p ~/.vim/autoload ~/.vim/bundle; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
curl -so ~/.vim/autoload/pathogen.vim &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
https://raw.github.com/tpope/vim-pathogen/master/autoload/pathogen.vim
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Install &lt;a href=&quot;https://github.com/tpope/vim-sensible.git&quot;&gt;vim-sensible&lt;/a&gt; for useful defaults:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;sh&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/.vim/bundle
git clone git://github.com/tpope/vim-sensible.git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Install &lt;a href=&quot;https://github.com/scrooloose/syntastic&quot;&gt;Syntastic&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;sh&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/.vim/bundle
git clone https://github.com/scrooloose/syntastic.git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Follow the &lt;a href=&quot;https://github.com/def-lkb/merlin/wiki/vim-from-scratch&quot;&gt;Merlin/vim from scratch&lt;/a&gt; directions:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;sh&quot;&gt;opam install merlin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Finally, add this this in your &lt;code&gt;~/.vimrc&lt;/code&gt; to turn everything on.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;vim&quot;&gt;execute pathogen#infect&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;s&lt;/span&gt;:ocamlmerlin&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;substitute&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;system&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'opam config var share'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'\n$'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; .  &lt;span class=&quot;s2&quot;&gt;&amp;quot;/ocamlmerlin&amp;quot;&lt;/span&gt;
execute &lt;span class=&quot;s2&quot;&gt;&amp;quot;set rtp+=&amp;quot;&lt;/span&gt;.&lt;span class=&quot;k&quot;&gt;s&lt;/span&gt;:ocamlmerlin.&lt;span class=&quot;s2&quot;&gt;&amp;quot;/vim&amp;quot;&lt;/span&gt;
execute &lt;span class=&quot;s2&quot;&gt;&amp;quot;set rtp+=&amp;quot;&lt;/span&gt;.&lt;span class=&quot;k&quot;&gt;s&lt;/span&gt;:ocamlmerlin.&lt;span class=&quot;s2&quot;&gt;&amp;quot;/vimbufsync&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;trying_it_out&quot;&gt;Trying it out&lt;/h2&gt;

&lt;p&gt;Read the excellent instructions at the &lt;a href=&quot;https://github.com/def-lkb/merlin/wiki/vim-from-scratch&quot;&gt;Merlin for Vim from scratch&lt;/a&gt; wiki page. A few immediately useful things I did are below.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Displaying types:&lt;/em&gt; You can get the local type of something by typing in &lt;code&gt;\t&lt;/code&gt; anywhere. This is the &lt;code&gt;&amp;lt;LocalLeader&amp;gt;&lt;/code&gt; for anyone who has customized their setup (it is mapped to backslash by default).&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Tab completing functions:&lt;/em&gt; You can tab-complete module signatures by pressing &lt;code&gt;Ctrl-X-O&lt;/code&gt; (make sure you keep Ctrl pressed the whole time). This activates vim&amp;#8217;s OmniComplete mode. To get this to work with your external projects, create a &lt;code&gt;.merlin&lt;/code&gt; file. I use this for &lt;a href=&quot;https://github.com/mirage/ocaml-dns&quot;&gt;ocaml-dns&lt;/a&gt; for example.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;PKG lwt cstruct
S lib
S lib_test
S lwt
B _build/lib
B _build/lib_test
B _build/lwt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Also, don&amp;#8217;t forget to pass the &lt;code&gt;-bin-annot&lt;/code&gt; function to the compiler to generate the typed-AST &lt;code&gt;cmt&lt;/code&gt; files. You can add &lt;code&gt;true: bin_annot&lt;/code&gt; to your &lt;code&gt;_tags&lt;/code&gt; file if you&amp;#8217;re using OCamlbuild (in OCaml 4.01.0 or higher, and it&amp;#8217;ll be silently ignored on previous versions so you don&amp;#8217;t need to worry about breaking older OCaml compilers).&lt;/p&gt;</content:encoded>
	<dc:date>2013-10-02T23:00:00+00:00</dc:date>
</item>
<item rdf:about="http://www.syslog.cl.cam.ac.uk/?p=1562">
	<title>SRG Syslog: Liveblogging the first Human Data Interaction workshop</title>
	<link>http://www.syslog.cl.cam.ac.uk/2013/10/02/liveblogging-the-first-human-data-interaction-workshop/</link>
	<content:encoded>&lt;p class=&quot;lead&quot;&gt;I&amp;#8217;m at the Open Data institute, with Richard Mortier, Jon Crowcroft, Amir Chaudhry and Hamed Haddadi , live-blogging a daylong workshop about our emerging Human-Data Interaction research initiative.  The room is packed with notable researchers from all over the UK, so this promises to be an exciting day!&lt;/p&gt;
&lt;p&gt;&lt;span id=&quot;more-1562&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Mort opens up with an introduction to the format of the workshop and lays out the problem space:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Visualisation and sense making:&lt;/strong&gt; how do we make sense of such complex, technical systems, and crucially, what is the process of translating the information to&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Transparency and audit:&lt;/strong&gt; is essential to give a feedback loop to users&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Privacy and control: &lt;/strong&gt;&amp;#8230;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Analytics and commerce:&lt;/strong&gt; there is clearly an ecosystem forming around personal data (c.f. several startups specifically around this&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Data to knowledge:&lt;/strong&gt; what are the new business models around&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Attendee introductions&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Danielle &lt;/strong&gt;(missed her last name, is from Switzerland): did a PhD on anomaly detection and then worked at Swiss banks on security monitoring. The key challenges in the area are around the nature of the questions we need to ask about all the data that we have access to.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Steve Brewer:&lt;/strong&gt; coordinator of the IT as a Utility network which is funding all this.  Interested in the next steps: both immediate and the overall vision and direction it&amp;#8217;s all going.  Concrete actions emphasised.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Ian Brown:&lt;/strong&gt; Oxford University and cybersecurity. Interested broadly in these issues and also has a degree in psychology and behavioural psychology.  The challenge is how to balance the &amp;#8220;engineering&amp;#8221; (this isnt fundamental computer science) and understand why there is so little takeup of this.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Amir Chaudhry:&lt;/strong&gt; working on a toolstack for the Internet of Things.  When we have tweeting toasters, how do we make it all useful to people. It&amp;#8217;s not the raw data, but the insights we present back to people to make it useful.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elizabeth Churchill:&lt;/strong&gt; was at Yahoo, now at eBay Research.  Right now the challenge I&amp;#8217;m facing is personalisation, and is trying to understand why the models they have of people are rubbush (this is why so much advertising isnt very useful).  The reasoning processes and data &lt;em&gt;quality&lt;/em&gt; is important.  We are making assertions about people based on data they have gathered for another purpose, and the ethical and business issues are important. Has been pushing on : what the data source, what is the data quality, and are these assertions based off data thats appropriate, and how can we design new algorithms&amp;#8221;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jon Crowcroft:&lt;/strong&gt; from the Computer Lab in Cambridge and does anything to do with communication systems, and leads the Horizon project with Mort and PAWS which is working on wifi access in disadvantaged areas. Also working on Nymote.  Is interested in new human/data rights vs t&amp;amp;cs.  Rights and duties are encoded in terms and conditions (badly) &amp;#8212; see Latier&amp;#8217;s latest book about this, and see how poor Amazon&amp;#8217;s recommendations are.  We&amp;#8217;re interested in building a technology where you own your own data but business practises all gel together.  We had a workshop at how the EU is pushing the right to be forgotten, so how can we ensure that data can be removed including all references.  People go &amp;#8220;its too difficult&amp;#8221;, but this isn&amp;#8217;t true &amp;#8212; takedowns work, and why is it that only big corporations can afford to take down stuff.  The right to oblivion (&amp;#8220;not be there in the first place&amp;#8221;) and data shouldn&amp;#8217;t be a public good but people should have the right to be in a paid avoidance zones. (See Shockwave Rider by Brunner, 30 years old, loads of great technical ideas, and Future Shock is a good read too).  Can we shift regulatory positions and have&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Thomas Dedis:&lt;/strong&gt; runs Fab Lab in Barcelona.  Cofounder of Smart Citizen, crowdfunded environment sensing platform based on a piece of hardware based on Arduino.  Allows people to capture data in their own homes, and push it to an online platform.  Allows people to push it in a &amp;#8216;conscious&amp;#8217; way? Go to smartcitizen.me to see the data platform.  Intended to grow into other places, but capturing air pollution, humidity, temperature and other environment data.  Main thing is that you own your own data.  Much cheaper than the competition too and crowdfunding.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Martin Dittus&lt;/strong&gt; (@dekstop) is a PhD student at UCL and works on cities.io. Thousands of people mapping the planet in incredibly detailed ways and it works with both commercial and non-commercial stuff. What makes these systems work, what are the processes to coordinate things, questions of data quality and how to assert stuff over it?  Used to be part of the last.fm data team which is about personal data gathering and detailed profiling that users themselves put up.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Christos Efstratiou:&lt;/strong&gt; as of September is a lecturer at University of Kent (and is still a visiting research at Cambridge).  Works on sensing, more broadly that has to do with people and sensors in the environment and embedded sensing in the environment.  Privacy is a huge issue and is his key challenge.  This isn&amp;#8217;t sensing in the old style like Active Badge &amp;#8212; back then, people werent aware of the issues and nowadays, people are more aware of privacy.  So the challenge is the evolving user perceptions and how our system design works.  Anecdote: at a recent wedding he was at, there was a request from the  bride/groom to note post any public photos to Twitter/Facebook. We&amp;#8217;ve lost control over our public personas.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Julie Freeman:&lt;/strong&gt; an actual resident in this building and the art associate for the ODI space!  Is a PhD student at QMW and is interested in echoing other people.  Interested in physical manifestations of digital data, and how we can &amp;#8220;step away from the screen&amp;#8221;.  Broad interests in transformation of digital data.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Barbara Grimpe:&lt;/strong&gt; from Oxford and is a sociologist in an interdisciplinary EU project on &amp;#8220;Governance for Responsible Innovation&amp;#8221;.  They have a network notion of responsibility which takes into account that a lot of data production and data use takes place in networks that posses strong ties between people.  She started two cases studies in two area: telecare technologies for elderly people (relevant due to the EU Horizon 2020 societal challenge in aging and wellbeing due to the demographic change in western societies, and this brings the ethical issue around the use of personal data at scale); there is difficulty of informed consent due to dementia also. The other case study is completely different and is about financial market technology and the data is highly commercially sensitive, so understanding how transparency can be balanced against financial control and the need for genuine market secrets to facilitate trade.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Wifak Gueddana&lt;/strong&gt; is a postdoc at information systems group at LSE.  Did her PhD on open source communities and how open source can work for NGOs and grass roots.  Working on a research project for online platforms &amp;#8212; how to use computational analytics to collect and process data and deal with the qualitative and subjective issues.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hamed Haddadi:&lt;/strong&gt; lecturer in QMUL, asking how we can compute over mobile data and has worked on advertising and privacy aware system systems.  Linking the temporal nature of the data and understanding how much of your data is exposed (amusing anecdote about wearing shorts)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Muki Haklay:&lt;/strong&gt; professor of GIScience and the Extreme Citizen Science group. He&amp;#8217;s interested in participatory citizen science and cyberscience.  Interested in GeoWeb and mobiile GeoWeb technologies and understanding how tools for voluntary participation work (open street map, participatory geoweb).  &amp;#8221;How can you give control to people that are not technical&amp;#8221; and how do we build protocols for cultural sensitivity?  Working on Open Street Map, while its easy for techies to contribute and feel happy, it might be an issue from a privacy perspective without GPS fuzzing or pseudonyms (you can say &amp;#8220;I know where you live&amp;#8221; to every OSM user). (discussion about most data being rubbish and is a psychology question about whether this depresses people!)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jenny Harding:&lt;/strong&gt; from the Ordnance Survey who control most of the UK&amp;#8217;s mapping data and is a principal scientist in the research team team on working on how people interact with geography in business, public service and leisure.  Moving beyond just GPS into the connective function about what&amp;#8217;s going on in places, and the connection between different objects and places.  What is the purpose for needing all this connected information, and how can the Ordnance Survey better serve its users with such &lt;em&gt;usable&lt;/em&gt; connected data?  She commissions internal and external research and this includes PhDs and postdocs.  Challenge for this workshop: how personal data relates to location and the different levels of granularity at which such relationships can be made &amp;#8212; beyond GPS, there is address data in (e.g.) supermarket loyalty cards, and other data at a postcode level, and different types of geographies all have connections.  Understanding provenance of data is really really important .&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pat Healey: &lt;/strong&gt;Professor of Human Interaction and head of cognitive science research group and workson health issues.  Not here yet so introduced by Hamed.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Tristan Henderson; &lt;/strong&gt;lecturer in compsci at St Andrews in Scotland, did his PhD on first person shooter games and runs a widely used mobile data set called CRAWDAD. They archive and share it and so work a lot on redistribution of data. His undergrad was economics so his interest is on behavioural aspects and usability issues too (Tristan has recently joined the HCI group and the ethics committee at St Andrews).  How can we get researchers to further engage with the ethics process and to refine the notions of informed consent in electronic terms.  Challenges: what is acceptable HDI and are we conducting it in an acceptable way (q from Mort: how broad? a: everything).  And is HDI unique enough that we might need another term.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Laura James: &lt;/strong&gt;from OKF (not here yet)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Helene Lambrix: &lt;/strong&gt;visiting LSE and usually at Paris-Dauphine University in France and is hoping to finish her PhD this year! Interested in corporate reputation and social media.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Neal Lathia: &lt;/strong&gt;researcher at Cambridge University and did his PhD on online recommender systems. Noticed a disparity between data services online and the offline word so started working on recommender systems for urban systems (banging head against TFL data).  At Cambridge, started working with psychologists and leads EmotionSense (how satisfied are you with your life, as well as ongoing smartphone sensor data) &amp;#8212; its really popular.  Challenges: language issue around how we present issue and motivate people around using that data (how does using EmotionSense affect their behavior)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Panos&lt;/strong&gt; from Brunel: interested in cybersecurity and intelligence from media data mining and cloud based work. Commodification process of digital economy data and what is the legal frameowork surrounding this.  What are the personas for data to apply frameworks and data mining techniques to it?  Challenges: regulatory system using big personal data.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Eva&lt;/strong&gt; from University of Nottingham and has just submitted PhD and waiting viva. Background is political science and internationl relations, and is interested in informed consent and how we sustain consent rather than just secure it as a one-off. The challenges: the human bit and how we communicate the complexity of systems and how people can make meaningful decisions. If you want people to be engaged with process then we need data to be more social and human.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Ursula Martin&lt;/strong&gt;: professor in a Russel Group university in Mile End road. Is a mathematician and is researching the production of mathematics, and how it happens in the first place. Producing maths is a slow, painstaking thing, and is wondering how the rate of production can keep up with our needs. When interacting with an outfit getting her data, she&amp;#8217;s not just an isolate, but is actually part of a large complex system.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Richard Mortier &amp;#8220;mort&amp;#8221;&lt;/strong&gt;: From Nottingham and is the dude running this workshop so has introed before!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Nora Ni Loideain: &lt;/strong&gt;doing a PhD in the european data protection and this requires the mandatory retention of data by telecomms provider. References recent US events cf Snowden and her PhD is on privacy oversight and the guards (or lack thereof) in current frameworks.  Challenges: how can we build these safeguards and what is the nature of informed consent with these.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Ernima Ochu: &lt;/strong&gt;based in Manchester. Sometimes an activist, sometimes a writer, sometimes an artist. Background in neuroscience!  The social life of data and what happens around it, and how people get around based on it.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Yvonne Rogers&lt;/strong&gt; and is from team UCL and is director of UCLIC (Interaction Center) and also an Intel-funded institute at UCL where they work on connected data.  Given lots of data from sources, interested in how people can engage with it and how to visualise . (Hamed: &amp;#8220;Human City Interaction is the next thing!&amp;#8221;)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Geetanjali Sampemane;&lt;/strong&gt; background in Computer Science, and works at Google on Infrastructure Security and Privacy group.  Challenge is how to help people calibrate the benefits and risks for appropriate tradeoffs.  How can humans make an informed choice, and this isn&amp;#8217;t based on informed choice.  Giving people buttons and options isn&amp;#8217;t the most useful way to approach this, and we need a mental model similar to how we judge risks in the physical world.  In the online world, noone understands how dangerous it is to reuse passwords. Security people have made is a little worse by telling people to use complicated passwords, but brute force isn&amp;#8217;t the big problem right now, it&amp;#8217;s the connectivity of services.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Cerys Willoughby: &lt;/strong&gt;Southhampton and looking at the usability of notebooks and wondering how to make the interfaces usable without being a technological guru. (missed rest due to reading cool comic she projected about her work. Sorry!)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Eiko Yoneki&lt;/strong&gt;: from Cambridge, and she works on digital epidemiology and real world mobility data collection in Africa (e.g. EipPhone).  She analyses network structure to understand graphs and connectivity.  Also works on CDNs and builds self-adaptive CDNs, and works on graph-specific data parallel algorithms.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jonathan Cave: &lt;/strong&gt;game theorist (Yale, Cambridge, Stanford) and worked in a lot of government/academia/research areas. Works on economics and IoT (festival of things and the boundaries of humanity is coming up soon in Cambridge on 29th October).  Fascinating anecdote about price of sick animals&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;George Danezis:&lt;/strong&gt; formerly MSR now UCL, and is interested in technical security aspects of how to glue together distributed mobile devices and not leave our personal data unreadable.  Has done work on privacy friendly statistics and how we can process and analyse it as an aggregate data set. Has worked in the context of smart metering in Europe.&lt;/p&gt;
&lt;h2&gt;Breakout sessions&lt;/h2&gt;
&lt;p&gt;We then had breakout sessions to brainstorm the challenges in this area (lots of post it notes and arguments), and Amir Chaudhry has summarised the results of the 5 presentations here:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Disambiguating data.&lt;/strong&gt; For example from the home and organisations. This isn&amp;#8217;t a new problem but becomes more important the more data collection occurs using different sources.  Who are the principles in terms of onwership and provenance?  How do we deal with communities/groups  and data control?&lt;/p&gt;
&lt;p&gt;Why not try crowd sourcing mechanisms for people to use so that they can improve the use of sites like Ryanair (who deliberately obfuscate things).  Changing mindset from consumer perspective to a producer perspective.  i.e humans make data and perhaps can provide this to others for economic benefits.&lt;/p&gt;
&lt;p&gt;We have data and different notions of data quality.  It&amp;#8217;s not always the case that the most scientific data is the best, depending on how it&amp;#8217;s used.  We have Collectivist notions of data culture: e.g this conversation right now in the room isn&amp;#8217;t just individual, it&amp;#8217;s all of us so we can&amp;#8217;t ascribe it to individuals. Then there are Network notions, based on transactions that use a reductionist view to decide what they&amp;#8217;re worth.  Can think of these on a continuum and the research challenge is how well do different ends of above scale in producing data and making value.  Interesting question is if people opt out (right to forget or right to oblivion), then the data that is left is flawed.&lt;/p&gt;
&lt;p&gt;We need to examine current assumptions and values around data.  What is the unit of analysis? Must be clearer on this. Where and when we look at what data also matters as well as global aggregation.  Sometimes also want to look at trajectories and data flows and how this changes over time.  How do we interact with this data.  Do users interact with data directly or with something that sits in front of it?  There&amp;#8217;s an interaction between data science and the creative process of presenting information in a certain way.  This depends on ultimate goal being served, for example e.g beavioural changes or just increased engagement.&lt;/p&gt;
&lt;p&gt;There are big challenges in integration of groups who want to construct humans. Groups like social sciences (think about risk), Psychological science (reputation), Data sciences (Epistomology and Ontology), Design science (Interfaces and interactions). What is the new meaning of ownership and liability? e.g who owns this collection of posters and the ideas that have come out? [Hamed and Mort clarify that it's all theirs!]  What happens if there are negative consequences as a result of using poor data?&lt;/p&gt;
&lt;p&gt;Business models are also important in order to go from studies to practice. Are there new social structures we could make to help this?  For example, we have venture capital that takes risks but what about social capital to spread risk to create new businesses e.g kickstarter and the like.&lt;/p&gt;
&lt;p&gt;What does informed consent mean? Current system puts onus on user to understand all the contractual conditions before deciding.  Perhaps there&amp;#8217;s a social-network method of crowd-sourcing opinions on ToS or providing some kind of health rating?  Perhaps data protection agencies could certify terms or maybe the EFF or non-profits can provide some kind of rating system (c.f Moody&amp;#8217;s etc?). For example from the home and organisations. This isn&amp;#8217;t a new problem but becomes more important the more data collection occurs using different sources.  Who are the principles in terms of onwership and provenance?  How do we deal with communities/groups  and data control?&lt;/p&gt;
&lt;p&gt;Why not try crowd sourcing mechanisms for people to use so that they can improve the use of sites like Ryanair (who deliberately obfuscate things).  Changing mindset from consumer perspective to a producer perspective.  i.e humans make data and perhaps can provide this to others for economic benefits.&lt;/p&gt;
&lt;p&gt;We have data and different notions of data quality.  It&amp;#8217;s not always the case that the most scientific data is the best, depending on how it&amp;#8217;s used.  We have Collectivist notions of data culture: e.g this conversation right now in the room isn&amp;#8217;t just individual, it&amp;#8217;s all of us so we can&amp;#8217;t ascribe it to individuals. Then there are Network notions, based on transactions that use a reductionist view to decide what they&amp;#8217;re worth.  Can think of these on a continuum and the research challenge is how well do different ends of above scale in producing data and making value.  Interesting question is if people opt out (right to forget or right to oblivion), then the data that is left is flawed.&lt;/p&gt;
&lt;p&gt;We need to examine current assumptions and values around data.  What is the unit of analysis? Must be clearer on this. Where and when we look at what data also matters as well as global aggregation.  Sometimes also want to look at trajectories and data flows and how this changes over time.  How do we interact with this data.  Do users interact with data directly or with something that sits in front of it?  There&amp;#8217;s an interaction between data science and the creative process of presenting information in a certain way.  This depends on ultimate goal being served, for example e.g beavioural changes or just increased engagement.&lt;/p&gt;
&lt;p&gt;There are big challenges in integration of groups who want to construct humans. Groups like social sciences (think about risk), Psychological science (reputation), Data sciences (Epistomology and Ontology), Design science (Interfaces and interactions).  What is the new meaning of ownership and liability? e.g who owns this collection of posters and the ideas that have come out? [Hamed and Mort clarify that it's all theirs!]  What happens if there are negative consequences as a result of using poor data? Business models are also important in order to go from studies to practice. Are there new social structures we could make to help this?  For example, we have venture capital that takes risks but what about social capital to spread risk to create new businesses e.g kickstarter and the like.&lt;/p&gt;
&lt;p&gt;What does informed consent mean? Current system puts onus on user to understand all the contractual conditions before deciding.  Perhaps there&amp;#8217;s a social-network method of crowd-sourcing opinions on ToS or providing some kind of health rating?  Perhaps data protection agencies could certify terms or maybe the EFF or non-profits can provide some kind of rating system (c.f Moody&amp;#8217;s etc?)&lt;/p&gt;
&lt;h2&gt;Next steps&lt;/h2&gt;
&lt;p&gt;Ian Brown took notes on our breakout session on business models for privacy:&lt;/p&gt;
&lt;p&gt;Collectives/cooperatives sharing data through PDSes&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;How to incentivise membership? Dividends, social benefit (e.g. medical research)&lt;/li&gt;
&lt;li&gt;what currently exists where data controller has strong incentive not to leak/breach data e.g. Boots for brand loyalty, Apple/Facebook? So long as customer can switch effectively (portability, erasure)&lt;/li&gt;
&lt;li&gt;Power tool sharing at village level. Hang off existing structures e.g. local councils.&lt;/li&gt;
&lt;li&gt;New forms of micro-markets e.g. physical gatherings? Alternatives to currencies. Kickstarter? Distribution reduces risk of centralised architectures.&lt;/li&gt;
&lt;li&gt;What do syndicalist-anarchist models of data management look like?&lt;/li&gt;
&lt;li&gt;Current uses of data are optimising existing business practices. But what totally new practices could be enabled? Human-facing efficiencies?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;What are types of biz models? Startups, personal profit, NGO, medical research, banks. Balanced investment portfolio.&lt;/p&gt;</content:encoded>
	<dc:date>2013-10-02T14:06:15+00:00</dc:date>
	<dc:creator>Anil Madhavapeddy</dc:creator>
</item>
<item rdf:about="http://anil.recoil.org/2013/09/30/travis-and-ocaml">
	<title>Anil Madhavapeddy: Test your OCaml packages in minutes using Travis CI</title>
	<link>http://anil.recoil.org/2013/09/30/travis-and-ocaml.html</link>
	<content:encoded>&lt;a href=&quot;http://travis-ci.org&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/travis-mascot-200px.png&quot; /&gt;&lt;/a&gt;
&lt;p&gt;A few months ago, Mike Lin posted &lt;a href=&quot;http://blog.mlin.net/2013/02/testing-ocaml-projects-on-travis-ci.html&quot;&gt;instructions&lt;/a&gt; of how to bootstrap an OCaml testing environment within the &lt;a href=&quot;http://travis-ci.org&quot;&gt;Travis&lt;/a&gt; continuous integration tool. I finally got around to integrating his prototype scripts properly using the latest OCaml and OPAM versions during my travels last week to ICFP. It&amp;#8217;s been an extraordinarily quick and pleasant experience to add the (free!) Travis test runs to my OCaml programs on GitHub, so here&amp;#8217;s how you can do it too. &lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; and I have used this for about 15 of our own projects already, and I&amp;#8217;m switching the whole of the &lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage&lt;/a&gt; repo infrastructure over to it this week.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;(edit: I&amp;#8217;ve done a followup post about &lt;a href=&quot;http://anil.recoil.org/2013/10/06/travis-secure-ssh-integration.html&quot;&gt;integrating Travis with SSH&lt;/a&gt; to make secure deployments easier.)&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;getting_started&quot;&gt;Getting started&lt;/h2&gt;

&lt;p&gt;Getting my first Travis build working with one of my OCaml projects took about 2 minutes in total:&lt;/p&gt;

&lt;p&gt;First, log into &lt;a href=&quot;http://travis-ci.com&quot;&gt;Travis&lt;/a&gt; and sign in via Twitter. Click on the &lt;a href=&quot;https://travis-ci.org/profile&quot;&gt;Accounts&lt;/a&gt; button on the top-right and you should see a list of the all the GitHub repositories that you have access to. Just click the &lt;i&gt;On&lt;/i&gt; switch for the one you want to start testing. Nothing will actually happen until the next code push or pull request goes to that repository. Behind the scenes, the &lt;i&gt;On&lt;/i&gt; button that you clicked use the GitHub APIs to turn on the Travis post-commit hook for your repository.&lt;/p&gt;

&lt;p&gt;Create a &lt;code&gt;.travis.yml&lt;/code&gt; file in your main repository (see below or &lt;a href=&quot;https://gist.github.com/avsm/6757425&quot;&gt;this gist&lt;/a&gt;). Travis doesn&amp;#8217;t have native support for OCaml, but it isn&amp;#8217;t really needed since we can just use &lt;code&gt;C&lt;/code&gt; and write our own shell scripts. The &lt;code&gt;env&lt;/code&gt; variables define a matrix of the different combinations of OCaml and OPAM that we want to test. Just remove variations that you don&amp;#8217;t care about to avoid wasting Travis&amp;#8217; CPU time (open source projects are supported on a fair-use basis by them). Here&amp;#8217;s the &lt;code&gt;.travis.yml&lt;/code&gt; that I used for my &lt;a href=&quot;https://github.com/mirage/ocaml-uri&quot;&gt;ocaml-uri&lt;/a&gt; library:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;yaml&quot;&gt;&lt;span class=&quot;l-Scalar-Plain&quot;&gt;language&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;c&lt;/span&gt;
&lt;span class=&quot;l-Scalar-Plain&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;bash -ex .travis-ci.sh&lt;/span&gt;
&lt;span class=&quot;l-Scalar-Plain&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p-Indicator&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;OCAML_VERSION=4.01.0 OPAM_VERSION=1.0.0&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;OCAML_VERSION=4.01.0 OPAM_VERSION=1.1.0&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;OCAML_VERSION=4.00.1 OPAM_VERSION=1.0.0&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;OCAML_VERSION=4.00.1 OPAM_VERSION=1.1.0&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;OCAML_VERSION=3.12.1 OPAM_VERSION=1.0.0&lt;/span&gt;
  &lt;span class=&quot;p-Indicator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;l-Scalar-Plain&quot;&gt;OCAML_VERSION=3.12.1 OPAM_VERSION=1.1.0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now you just need the &lt;code&gt;.travis-ci.sh&lt;/code&gt; shell to run the actual tests. Travis provides an Ubuntu Precise/i386 VM that is destroyed after every test run, so we need to initialize it with the OCaml and OPAM binary packages. Since you often want to test different versions of all of these, I created a series of stable Ubuntu PPAs that have OCaml 3.12,4.0,4.1 and OPAM 1.0 and the (currently beta) 1.1 package manager. You can find them all on my &lt;a href=&quot;http://launchpad.net/~avsm&quot;&gt;Launchpad&lt;/a&gt; page, but the below script takes care of it all for you.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;sh&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Edit this for your own project dependencies&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;OPAM_DEPENDS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;ocamlfind ounit re&amp;quot;&lt;/span&gt;
	 
&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$OCAML_VERSION,$OPAM_VERSION&amp;quot;&lt;/span&gt; in
3.12.1,1.0.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml312+opam10 ;;
3.12.1,1.1.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml312+opam11 ;;
4.00.1,1.0.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml40+opam10 ;;
4.00.1,1.1.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml40+opam11 ;;
4.01.0,1.0.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml41+opam10 ;;
4.01.0,1.1.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ppa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;avsm/ocaml41+opam11 ;;
*&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;Unknown &lt;span class=&quot;nv&quot;&gt;$OCAML_VERSION&lt;/span&gt;,&lt;span class=&quot;nv&quot;&gt;$OPAM_VERSION&lt;/span&gt;; &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;1 ;;
&lt;span class=&quot;k&quot;&gt;esac&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;	 &lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;yes&amp;quot;&lt;/span&gt; | sudo add-apt-repository ppa:&lt;span class=&quot;nv&quot;&gt;$ppa&lt;/span&gt;
sudo apt-get update -qq
sudo apt-get install -qq ocaml ocaml-native-compilers camlp4-extra opam
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;OPAMYES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
opam init 
opam install &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;OPAM_DEPENDS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;opam config env&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
make
make &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now just do a push to your repository (a commit adding the Travis files above will do), and you will soon see the Travis web interface update. For example, here&amp;#8217;s the &lt;a href=&quot;https://travis-ci.org/mirage/ocaml-uri/builds/11899338&quot;&gt;output of ocaml-uri&lt;/a&gt; that the above example files are for. Of course, you should tweak the scripts to run the tests that your own project needs. Let me know if you make any useful modifications too, by forking the &lt;a href=&quot;https://gist.github.com/avsm/6757425&quot;&gt;gist&lt;/a&gt; or e-mailing me.&lt;/p&gt;

&lt;h2 id=&quot;testing_pull_requests_in_opam&quot;&gt;Testing pull requests in OPAM&lt;/h2&gt;

&lt;p&gt;Travis isn&amp;#8217;t just for code pushes though; as of a few months ago it can also &lt;a href=&quot;http://about.travis-ci.org/blog/announcing-pull-request-support/&quot;&gt;test pull requests&lt;/a&gt;. This is an incredibly useful feature for complex projects such as the OPAM repository that has lots of contributors. You don&amp;#8217;t need to do anything special to activate it: whenever someone issues a pull request, Travis will merge it locally and trigger the test runs just as if the code had been pushed directly.&lt;/p&gt;

&lt;p&gt;I did do some special scripting to make this work with the OPAM package repository. Ideally, every new package or metadata change in OPAM will attempt to rebuild just that package set (rebuilding the entire repository would far exceed the 50 minute testing budget that Travis imposes). I put together a &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/blob/master/.travis-ci.sh&quot;&gt;very hacked up shell script&lt;/a&gt; that greps the incoming diff and rebuilds the subset of packages. This is now live, and you can see both &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/pull/1144&quot;&gt;successful&lt;/a&gt; and &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/pull/1131&quot;&gt;failed&lt;/a&gt; pull requests (once the request has been merged, there&amp;#8217;s a tiny little green arrow beside the commit that was tested).&lt;/p&gt;

&lt;p&gt;This is a very unconservative estimate test matrix since a package update will also affect the reverse transitive cone of packages that depend on it, but it does catch several common typos and incompatibilities (for example, packages that use OPAM 1.1-only features by mistake). The longer term plan is to use the &lt;a href=&quot;http://github.com/ocamllabs/ocamlot&quot;&gt;OCamlot&lt;/a&gt; command line tool to parse the pull request and compute an exact set of packages that need rebuilding.&lt;/p&gt;

&lt;h2 id=&quot;deployment&quot;&gt;Deployment&lt;/h2&gt;
&lt;a href=&quot;http://xkcd.com/303/&quot;&gt;&lt;img src=&quot;http://imgs.xkcd.com/comics/compiling.png&quot; width=&quot;250px&quot; /&gt;&lt;/a&gt;
&lt;p&gt;Travis has one last very cool feature up its sleeve. When a project has successfully built, it can run a scripting hook in the VM, which can be used to trigger a further code push or service update. If the service requires authentication, you can &lt;a href=&quot;http://about.travis-ci.org/docs/user/encryption-keys/&quot;&gt;encrypt a secret&lt;/a&gt; in the &lt;code&gt;travis.yml&lt;/code&gt; using their public key, and it will be available in the VM as an environment variable (but won&amp;#8217;t be useful to anyone else looking at the code repository).&lt;/p&gt;

&lt;p&gt;There are quite a few uses for these Travis deployment scripts: automating the rebuilding of the &lt;a href=&quot;http://ocaml.org&quot;&gt;ocaml.org&lt;/a&gt; website infrastructure, rebuilding the central &lt;a href=&quot;http://pw374.github.io/posts/2013-09-24-01-50-14-opamdoc-take1.html&quot;&gt;opam-doc&lt;/a&gt; &lt;code&gt;cmt&lt;/code&gt; file archive, or even autoupdating &lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage&lt;/a&gt; microkernels to Amazon EC2 and Rackspace.&lt;/p&gt;

&lt;p&gt;So how does this tie into the ongoing work on &lt;a href=&quot;http://anil.recoil.org/2013/09/09/ocamlot-autotriaging.html&quot;&gt;OCamlot&lt;/a&gt;? Quite simply, it&amp;#8217;s saved us a ton of frontend work, and lets us focus on the more interesting OCaml-specific problems. Travis is also somewhat reactive (since it only runs in response to pushes or pull requests), and we still need to be able to run complete repository sweeps to look for more systematic breakage. It also doesn&amp;#8217;t support any non-Ubuntu operating systems yet. However, Travis takes the burden off us for handling the steadily &lt;a href=&quot;http://anil.recoil.org/2013/09/20/opam-1-1-beta.html&quot;&gt;increasing&lt;/a&gt; number of package updates, and can be used to launch further OCamlot jobs on the other architectures and distributions. All in all, I&amp;#8217;m very grateful to Mike for taking the trouble to blog about it back in March!&lt;/p&gt;

&lt;h2 id=&quot;and_a_little_bit_of_cheeky_arm_hackery&quot;&gt;And a little bit of cheeky ARM hackery&lt;/h2&gt;

&lt;p&gt;I couldn&amp;#8217;t resist one final little hack to see if I could actually do some ARM/OCaml testing using the Travis infrastructure. I adapted Ian Campbell&amp;#8217;s excellent &lt;a href=&quot;http://www.hellion.org.uk/blog/posts/foreign-chroots-with-schroot-and-qemu/&quot;&gt;guide to ARM cross-chroots&lt;/a&gt;, and ended up with a &lt;a href=&quot;https://github.com/avsm/ocaml/blob/travis/.travis-ci.sh&quot;&gt;rough script&lt;/a&gt; that builds an unattended chroot and can run OCaml/OPAM installations there too.&lt;/p&gt;

&lt;p&gt;This isn&amp;#8217;t something I&amp;#8217;m quite comfortable running on all of my repositories just yet though, since an OCaml cross-build using qemu took over 5 hours and was quite rightly terminated when running within Travis. To mitigate this, I&amp;#8217;ve built a &lt;a href=&quot;http://www.recoil.org/~avsm/debian-arm&quot;&gt;custom apt-repository&lt;/a&gt; for ARMel packages to install a binary toolchain, and you can see the results of &lt;a href=&quot;https://travis-ci.org/avsm/ocaml/jobs/11942786&quot;&gt;Lwt/ARM building successfully&lt;/a&gt;. I&amp;#8217;ll update on this as I get it working on more packages, as I&amp;#8217;m quite interested in getting a solid Xen/ARM toolstack up and running for another &lt;a href=&quot;http://nymote.org&quot;&gt;exciting project&lt;/a&gt; over in OCaml Labs&amp;#8230;&lt;/p&gt;</content:encoded>
	<dc:date>2013-09-29T23:00:00+00:00</dc:date>
</item>
<item rdf:about="http://pw374.github.io/posts/2013-09-26-20-15-24-odd-or-even.html">
	<title>Philippe Wang: (Exercise) Odd or even?</title>
	<link>http://pw374.github.io/posts/2013-09-26-20-15-24-odd-or-even.html</link>
	<content:encoded>&lt;p&gt;This is the exercice:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Given a string (of bytes), is the number of bits set to 1 odd or even?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Let's now find some possible solutions.&lt;/p&gt;
&lt;p&gt;Well, the  most naive way is  to count them  all, and then see  if the
number is even or odd. But it's  probably better not to use an integer
to count them all  and then see if that counter is  odd or even, since
we can instead use a Boolean: each time we see a 1, we can simply flip
the Boolean value!&lt;/p&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;has_an_odd_number_of_1&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;int_of_char&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;keywordsign operator&quot;&gt;.[&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;lsr&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;land&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;
        &lt;span class=&quot;lower&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;contents&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;&amp;#60;-&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;contents&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;lower&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;contents&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Side note:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Moreover, we can see that using a  Boolean means it will not limit the
number of  bits we  may read, whereas  an integer...   well, actually,
when we reach  the maximum value of integers (of  type int, or Int32.t
or Int64.t,  which — in  OCaml — are  respectively Pervasives.max_int,
Int32.max_int  and  Int64.max_int), adding  one  will  make them  even
negative numbers  (max_int, from Pervasives,  Int32 or Int64,  are all
odd numbers), so  we should still get the odd/even  outcome right. But
then, we  would have to be  sure that we have  correctly designed the
code that tells us if an integer is odd or even. For instance,
we can write &lt;code&gt;is_odd&lt;/code&gt; these ways:&lt;/p&gt;
&lt;p&gt;Well,  let's   start  with   a  very   classic  mathematically-elegant
implementation of two mutually recursive functions:&lt;/p&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;is_odd&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;
 &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt;
 &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;is_even&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;is_even&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;
 &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt;
 &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;is_odd&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Note that it needs a lot of computation when the integer is &amp;quot;big&amp;quot;...&lt;/p&gt;
&lt;p&gt;And this is probably the shortest version:&lt;/p&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;is_odd&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;mod&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;keywordsign infix&quot;&gt;&amp;#60;&amp;#62;&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now note that we cannot write this and expect it to work properly in 
all cases:&lt;/p&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;is_odd&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;mod&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and that's because if n is negative and odd, then n mod 2 is -1, not 1.&lt;/p&gt;
&lt;p&gt;A tricky version that uses properties on integers:&lt;/p&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;is_odd&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;keywordsign infix&quot;&gt;&amp;#60;&amp;#62;&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;&amp;#38;&amp;#38;&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;keywordsign infix&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;keywordsign infix&quot;&gt;&amp;#60;&amp;#62;&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Another tricky version that uses properties on machine integers:&lt;/p&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;is_odd&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;land&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Well, there is the same number  of characters as the shortest version,
and actually  this version is  probably the most efficient  because we
know that the  &lt;code&gt;land&lt;/code&gt; operation is easy for the  computer, whereas the
&lt;code&gt;mod&lt;/code&gt; operation implies division, which is not an easy one. Then &lt;code&gt;mod&lt;/code&gt;
could  be optimised  in  some  cases, such  as  &lt;code&gt;mod  2&lt;/code&gt; because  it's
basically  the  same as  &lt;code&gt;land  1&lt;/code&gt;  except that  the  sign  has to  be
preserved! So, it's likely to still cost more...&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;But there's  way more  efficient than that!  Indeed, unless  we really
don't have a  choice, we shouldn't read bits one  by one, because it's
slow!&lt;/p&gt;
&lt;p&gt;So what can we do instead?&lt;/p&gt;
&lt;p&gt;Well, there's  a very very  convenient logical operation  on integers.
It's called XOR  (and the OCaml operator for that  is &lt;code&gt;lxor&lt;/code&gt;), and yes
we can use it!&lt;/p&gt;
&lt;p&gt;Note that 1 XOR 1 = 0; 0 XOR 0 =  0; but 1 XOR 0 or 0 XOR 1 = 1.  It's
very convenient because it's basically  giving us the answer!  When we
have two  1s, we  can eliminate  them, that's  what happens  with XOR.
When we have  a 1 and a 0, we  keep the 1.  So if we  take those bytes
byte by byte,  and XOR them with  each other, at the end  we will have
one remaining byte  that will tell us  if the whole string  had an odd
number of 1 or not.&lt;/p&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;has_an_odd_number_of_1__efficient&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;loop&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt;
    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;
      &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;
      &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;
        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;lsr&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;land&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;
          &lt;span class=&quot;lower&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;contents&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;&amp;#60;-&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;contents&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;lower&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;contents&lt;/span&gt;
    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;lower&quot;&gt;loop&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;lxor&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;int_of_char&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;keywordsign operator&quot;&gt;.[&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;succ&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;loop&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And... There we go!  :-)&lt;/p&gt;
&lt;p&gt;Note that &lt;code&gt;int_of_char&lt;/code&gt; is a zero-cost operation (but &lt;code&gt;char_of_int&lt;/code&gt; is
not, because it  has to check that  the value of the  given integer is
between 0 and 255 inclusive).&lt;/p&gt;</content:encoded>
	<dc:date>2013-09-26T20:15:24+00:00</dc:date>
	<dc:creator>Philippe Wang</dc:creator>
</item>
<item rdf:about="http://pw374.github.io/posts/2013-09-25-16-19-07-ones-or-zeros.html">
	<title>Philippe Wang: (Exercise) Are there more 1s or 0s?</title>
	<link>http://pw374.github.io/posts/2013-09-25-16-19-07-ones-or-zeros.html</link>
	<content:encoded>&lt;p&gt;The challenge is this:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Provide a program that will determine,  given a set of 1s and 0s, if
there are more 0s or more 1s.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So  the   first  question  that  comes   to  my  mind   is  about  the
representation of that set of 1s and 0s. Is it a linked list, a double
linked list, an array, a tree, a string, or something else?&lt;/p&gt;
&lt;p&gt;If it's a list (single linked or double linked actually doesn't matter
much), it's going to be pretty straightforward: just read the list and
use a counter. Yes, a single counter is enough, you can add one to the
counter when you meet a 1, and  subtract one when you meet a 0. At the
end, if  your counter has  its initial value,  then you have  the same
number of 1s and 0s. If it's  lesser, then it has more 0s, else it has
more 1s.&lt;/p&gt;
&lt;p&gt;Let's declare a type for the result.&lt;/p&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;Equal&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;More_zeros&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;More_ones&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;loop&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;counter&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;
    &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;keywordsign operator&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;counter&lt;/span&gt;
    &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;tl&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;loop&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;counter&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;tl&lt;/span&gt;
    &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;tl&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;loop&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;counter&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;tl&lt;/span&gt;
    &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;tl&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;loop&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;counter&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;tl&lt;/span&gt;
    &lt;span class=&quot;comment&quot;&gt;(* you might want to debate whether you should stop 
       when you get something else than a 0 or a 1. *)&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;loop&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;constructor module&quot;&gt;Equal&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;&amp;#62;&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;constructor module&quot;&gt;More_ones&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;constructor module&quot;&gt;More_zeros&lt;/span&gt;    &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Well, what's the risk with this  program? The risk is that the integer
&lt;code&gt;counter&lt;/code&gt; overflows, of course! If you have a very long list of 1s (or
0s)  only, you  may  get things  just  wrong.  However,  in OCaml,  in
reality,  there's  not really  a  chance  that  the integer  overflows
because of  the length of a  single linked list,  especially if you're
using a 64-bit architecture based OCaml, on which the greatest integer
is 4_611_686_018_427_387_903 (about 4⨉10&lt;sup&gt;18&lt;/sup&gt;). There's really
a long way  to have such a long list because  basically you would need
to  allocate more  than (about  32⨉10&lt;sup&gt;6&lt;/sup&gt; terabytes)  at once,
since basically a linked list of  integers is made of blocks that have
2 cells  each (one for  the integer, one  for the address of  the next
cell), each cell taking 64 bits (or 8 bytes).&lt;/p&gt;
&lt;p&gt;But then,  what if you  don't have linked  lists but some  stream that
gives you  a very large number of  0s and/or 1s? Well,  to begin with,
counting from 0 to 4⨉10&lt;sup&gt;18&lt;/sup&gt; takes a really long time. If your
machine can  count from 0 to  10&lt;sup&gt;9&lt;/sup&gt; in a  single second (that
would  mean  your   machine  is  very  fast),  it   would  still  take
4⨉10&lt;sup&gt;9&lt;/sup&gt;  seconds,  which  is about  4000000000/(60&lt;em&gt;60&lt;/em&gt;24*365)
years.  Oh, that means about 126 years! So let's just assume that a 63
bit signed  integer is enough for  us. And if you  really can't assume
that for some reason, you can always implement 128 bit signed integers
quite easily, and  if you don't know  how to do that or  if you're too
lazy to do it, use the Big_int module.&lt;/p&gt;
&lt;p&gt;But let's go  back the representation of those 0s and  1s. I'd like to
make the computation as fast as  possible and I'll put those 0s and 1s
in a very compact representation. Each  0 and 1 will now only take one
bit in the  memory (with a possible constant  overhead for the whole).
For that,  let's use  OCaml's strings, which  are basically  arrays of
bytes.   The  longest  string I  can  have  on  my machine  will  bear
1_152_921_504_606_846_904  bits  (I  know  that because  I  multiplied
Sys.max_string_length   by   8),  and   that's   a   lot  (more   than
10&lt;sup&gt;8&lt;/sup&gt;).&lt;/p&gt;
&lt;p&gt;Now say  we want to know  whether there are more  0s or 1s  as fast as
possible.  How do we do that?&lt;/p&gt;
&lt;p&gt;We don't want  to count all 0s  and 1s bit by bit,  because that would
have quite  a high cost! Indeed, we  would have to get  each byte, and
for each byte  we would have to read  each of its 8 bits  (that can be
done) one by one.  We don't want to do that.&lt;/p&gt;
&lt;p&gt;Instead, since we have bytes, we can conveniently allocate an array of
size 256.   Each cell of that  array will contain the  right number to
add to the counter. This way, we can read a byte, get its number of 0s
and 1s in O(1).&lt;/p&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;comment&quot;&gt;(* this table is computed only once *)&lt;/span&gt;
&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;number_for_a_byte&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt;
    &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;lsr&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;land&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;
        &lt;span class=&quot;lower&quot;&gt;decr&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;r&lt;/span&gt;
      &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;lower&quot;&gt;incr&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;r&lt;/span&gt;
    &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;keywordsign prefix&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;r&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;lower&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;&amp;#60;-&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;number_for_a_byte&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;i&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;lower&quot;&gt;a&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Then let's abstract from the means  to read new 0s and 1s, by assuming
we'll be provided a function &lt;code&gt;f&lt;/code&gt; that given &lt;code&gt;()&lt;/code&gt; will return 8 bits in
a value  of type  &lt;code&gt;char&lt;/code&gt;, and will  raise the  exception &lt;code&gt;End_of_file&lt;/code&gt;
when it has no more bits to give.&lt;/p&gt;
&lt;pre class=&quot;tryocaml&quot;&gt;&lt;code class=&quot;tryocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;more_zeros_or_ones&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;begin&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;lower&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;keywordsign prefix&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;int_of_char&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;End_of_file&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;-&amp;#62;&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;keywordsign&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keywordsign prefix&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;constructor module&quot;&gt;Equal&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keywordsign prefix&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;lower&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;&amp;#62;&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;constructor module&quot;&gt;More_zeros&lt;/span&gt;
  &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;constructor module&quot;&gt;More_ones&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Note  that &lt;code&gt;int_of_char&lt;/code&gt;  has a  zero-cost (i.e.,  it  &amp;quot;disappears&amp;quot; at
compile-time because  &lt;code&gt;int&lt;/code&gt; and &lt;code&gt;char&lt;/code&gt;  sort of share the  same memory
representation).  If  you want  better performance, you  should inline
&lt;code&gt;f&lt;/code&gt;, provided that you  know what it is (you may want  to check if the
compiler does the inlining itself first, just in case).&lt;/p&gt;
&lt;p&gt;Also, you may want  to use a table with a size  larger than 256 if you
have a lot of memory but I'm not so sure you'd gain performance unless
you  use nasty  tricks to  read larger  integers from  a  string. Then
again, you may  not end up using  a string, in which case  you have to
think with the whole problem in mind.&lt;/p&gt;</content:encoded>
	<dc:date>2013-09-25T16:19:07+00:00</dc:date>
	<dc:creator>Philippe Wang</dc:creator>
</item>
<item rdf:about="http://www.syslog.cl.cam.ac.uk/?p=1461">
	<title>SRG Syslog: Liveblogging OCaml Workshop 2013</title>
	<link>http://www.syslog.cl.cam.ac.uk/2013/09/24/liveblogging-ocaml-workshop-2013/</link>
	<content:encoded>&lt;p class=&quot;lead&quot;&gt;&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo10-e1380031931194.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1466&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo10-e1380031931194-225x300.jpg&quot; width=&quot;100&quot; /&gt;&lt;/a&gt;I&amp;#8217;m here bright and early at the &lt;a href=&quot;http://ocaml.org/meetings/ocaml/&quot;&gt;OCaml 2013&lt;/a&gt; workshop at ICFP with Heidi Howard, Leo White, Jeremy Yallop and David Sheets!  There&amp;#8217;s a packed session today with lots of us presenting, so we&amp;#8217;ll swap over editing this post as the day progresses.  I also need to pop out to attend a panel on the future of Haskell so I&amp;#8217;ll be missing the bindings session, sadly!&lt;/p&gt;
&lt;p&gt;&lt;span id=&quot;more-1461&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;Accessing and using weather data in OCaml&lt;/h2&gt;
&lt;p&gt;Hez Carty from MDA Information Systems on doing large-scale weather data processing.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo9-e1380049811789.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1465&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo9-e1380049811789-225x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;He started with OCaml in graduate school and was looking for something better than Python, whereas they are building systems that need to run for many years with high stability.  He&amp;#8217;s not from a formal CS background but from the physical sciences, and found that the static typing made it easy to explore the language features.  The native code output is also important, and he finds predictability very important in day-to-day engineering.  The simple FFI also made a big difference.&lt;/p&gt;
&lt;p&gt;They do weather data retrieval and use HTTP/zeromq as a message bus to do language interop, and a workflow management tool to handle dependency graphs.  They take weather models frmo all these sources, and do various analyses (principal component analysis, probability models for precipitation via Monte Carlo simulations with a first order Markov chains).  More generally, there is a bunch of processing for climatology and data extraction and insertion.&lt;/p&gt;
&lt;p&gt;A NAM forecast plots the geo data of the USA, and overlays semitransparent layers (e.g. clouds) that are stacked up to get a fake satellite view of the earth, and then there are simulated radar returns where the model (e.g.) rains.  In addition to the structured formats, there is raw streaming data from sensor stations that send back raw binary data such as precipitation events, which is written as a small OCaml library to parses them into more structured formats.&lt;/p&gt;
&lt;p&gt;The big data formats are HDF4 and GRIB, which are binary data formats. There are mature C libraries to parse them and lots of existing analysis tools (e.g. wgrib which can extract lat/longs from a big file).  However, the tools arent great for doing larger scale analysis, as shelling out all the time for thousands of points is not ideal &amp;#8212; therefore they bind to OCaml to do the analysis in-house.&lt;/p&gt;
&lt;p&gt;The GRIB bindings use int, float and float arrays and bindings are entirely hand-written &amp;lt;i&amp;gt;(I&amp;#8217;m looking forward to the ctypes talk! &amp;#8211;anil)&amp;lt;/i&amp;gt;.  They expose only an OCaml friendly interface that is safe for callers.  The speaker now shows several nice graphs from CloudSat tracks from earth orbit, and how they take intersecting profiles to deduce things about what multiple satellites are seeing.&lt;/p&gt;
&lt;p&gt;They&amp;#8217;re mixing lots of different tools and satellite sources &amp;#8212; derived information from teleconnections (air surface pressure and how it varies in terms of oscillations between the north and south Atlantic).  All the analysis is written in OCaml, and he had to work with several scientists who didn&amp;#8217;t have access to their initial source code in many cases, so the experience of working with his fresh system was very positive.&lt;/p&gt;
&lt;p&gt;Challenges:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;standard issues when interfacing with C (type mismatches between C and OCaml in particular, and the question of sharing vs copying).  The worst failure mode is silent failure with bad data, which leads to bad science!&lt;/li&gt;
&lt;li&gt;&amp;#8220;Getting used to the functional way of life&amp;#8221; can tough, as is knowing when to balance elegance with the speed benefits of not copying hundreds of megabytes of data around can be tough.&lt;/li&gt;
&lt;li&gt;Development environments other than Emacs and Vim are poorly supported.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The overall project has been very successful, and the bindings for HDF4/GRIB API bindings have been used to process 1TB+/day for over 5 years now.  It&amp;#8217;s based on Bigarray and mmap, and the FFI makes getting up and running quickly.&lt;/p&gt;
&lt;p&gt;He finds OPAM with local repositories fantastic, and used GODI and odb/oasis-db before that.&lt;/p&gt;
&lt;p&gt;Q: how did he do the cool plots?&lt;/p&gt;
&lt;p&gt;A: plplot bindings on github&lt;/p&gt;
&lt;p&gt;Q: Anil: did you move from Fortran&lt;/p&gt;
&lt;p&gt;Q: Nate Foster: terabytes of data makes me wonder about GC?&lt;/p&gt;
&lt;p&gt;A: going through and folding over data generates huge amount of garbage and slows things down considerably. If the project is one-off, he tweaks the GC or manually call the GC more often. Really depends on length of code.&lt;/p&gt;
&lt;p&gt;Q: The data processed is huge, so what was the parallel computation approach?&lt;/p&gt;
&lt;p&gt;A: The task distribution system doesn&amp;#8217;t need a lot of parallelism, as he can work on one file at a time or chunk the files manually and aggregate the results.  He&amp;#8217;s looking forward to doing some semi-shared memory parallelism.&lt;/p&gt;
&lt;p&gt;Q: Pierre Chambart: Is the numerical code in OCaml or C?&lt;/p&gt;
&lt;p&gt;A: LAPACK in OCaml, but the Monte Carlo is pure OCaml and interpolation is in pure OCaml too.  Unless speed is absolutely required, it&amp;#8217;s written in OCaml.&lt;/p&gt;
&lt;h2&gt;Frenetic Network Controller&lt;/h2&gt;
&lt;p&gt;Arjun Guha about their multiyear project to program software define networks. When he started on this, he thought that networks are just a series of tubes! The reality is very different though, as there are numerous intermediate boxes (firewalls, routers, wireless auth). The real problem is that each of these intermediate boxes runs specialized, vendor-specific software and are configured independently via some proprietary CLI. They&amp;#8217;re difficult to configure and difficult to statically reason about.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo13-e1380031705305.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1480&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo13-e1380031705305-225x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;SDN helps with this by introducing standardized programmable that can deploy in-network features, and a logically centralized controller (a big beefy server) that enables reasoning about whole-network behaviour. SDN is a hot topic right now (lots of commercial startups, 200+ people at HotSDN, generally very busy).&lt;/p&gt;
&lt;p&gt;There are several Openflow controllers out there: Java (Floodlight), Python (Pox), C++ (Nox) and Haskell (Nettle), but Arjun introduces a novel OCaml programmable switch!&lt;/p&gt;
&lt;p&gt;Openflow works via a controller &amp;#8220;faulting&amp;#8221; in new packets that are routed to the controller when unknown packets show up on the wire. The source code consists of a generic Openflow packet parser (its a binary protocol), and a generic packet parser (e.g. TCP/IP) and a routing engine.&lt;/p&gt;
&lt;p&gt;First library: ocaml-packet that deals with deserializing TCP/IP/ARP/ICMP/Ethernet/802.1Q, and only depends on cstruct by Anil et al. (shows an example of a C struct for IPv4), and the nice thing that they get network byte order for free (thanks to Pierre Chambarts ocplib-endian of course).&lt;/p&gt;
&lt;p&gt;ocaml-openflow uses serialization for OpenFlow 1.0 and 1.3, and is based on a (cleaned up) fork of the mirage-openflow library, using ideas from Nettle about to structure the code. OpenFlow 1.3 is less complete currently but is still quite usable.&lt;/p&gt;
&lt;p&gt;The runtime systems for OpenFlow 1.0 and 1.3 listens for TCP connections from switches, and does the OpenFlow handles and keeps connections to switches alive.&lt;/p&gt;
&lt;p&gt;The source code uses Lwt and so exposes the monad to external users, e.g.:&lt;/p&gt;
&lt;pre&gt;type t
val connect : Lwt_unix.file_descr -&amp;gt; t option Lwt.t&lt;/pre&gt;
&lt;p&gt;They have a tutorial for non-OCaml hackers, and found teaching OCaml, Openflow AND Lwt was too much for new users. Therefore they built a new controller called Ox that hides much of the details of Lwt threading. It still uses them internally (Lwt, ocaml-openflow) but is inspired by Ox.&lt;/p&gt;
&lt;p&gt;Therefore they can build simple openflow tutorials using Ox, and advanced controller such as Frenetic can be built directly using the low level libraries. Good for beginners and weathered OCaml hackers alike!&lt;/p&gt;
&lt;p&gt;The problem with the controller seeing every bit of data is that it gets flooded by packets if it doesnt insert rules into the switches itself. Every switch has a &lt;i&gt;flow table&lt;/i&gt; that has priorities, patterns and actions, and tries to take action without bothering the controller. At start of day, the controller does see everything, but eventually flows settle down. The problem they are solving is avoiding having two copies of the program on both the controller and the switch, and figuring out how to deal with race conditions across the two. The simple, logical structure of the OCaml program gets torn apart if they try to write these two parallel logic rules by hand.&lt;/p&gt;
&lt;p&gt;They deal with this in the Frenetic network controller. This is a DSL for programming OpenFlow networks, and it has boolean predicates, several policy composition operations and compiles to OF flow rules. It implements ideas from several papers (ICFP/POPL/SIGCOMM/PLDI) and is fully open source on GitHub. (frenetic-lang/frenetic).&lt;/p&gt;
&lt;p&gt;They made a transition from Haskell to OCaml for a few reasons. They specified several parts of the Core compiler and runtime in Coq, and found Haskell/Coq extraction very painful (specifically, they had to abandon Coq functors, which had helped them discover key algebraic properties for their work on Kleene algebras). They found it easier for their collaborators to use OCaml than Haskell in general too.&lt;/p&gt;
&lt;p&gt;Lwt programming is mind boggling for beginners although the syntax extension does help, and the lack of multicore is a future problem as the controller needs scale up. Overall, they find that hacks at any layer are possible now and lots of projects have spun up!&lt;/p&gt;
&lt;p&gt;Q: multicore is a common criticism, but could you give an example of how you would actually solve this is you had shared memory vs a fork model?&lt;br /&gt;
A: There are several networking algorithms in the literature, and its a barrier for consumers. Nate notes that they could write one by hand but there&amp;#8217;s a time issue there and would rather have it automagically.&lt;/p&gt;
&lt;h2&gt;PHP Program analysis at Facebook&lt;/h2&gt;
&lt;p&gt;Pffff is all about deadcode removal, test coverage, checking for undefined function and use of undeclared variables, and syntactical grep rules. They also do taint analysis via abstract interpretation, type driven flow control and eventually (via Monoidics) a separation logic model (they use OCaml too).&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo11-e1380048991412.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1478&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo11-e1380048991412-225x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This talk is about static analysis of a huge codebase (5m lines+ of PHP code is scary!). Since he had a lot of big monitors, he built the tools to do analysis over huge codebases. He demonstrates this on the OCaml compiler itself &lt;i&gt;(camlp4 is huge! boo!!! -anil)&lt;/i&gt;. They can also zoom in in realtime to each box and eventually see the content of the file itself!&lt;/p&gt;
&lt;p&gt;The goal is NOT to build an editor, but to analyse and explore large code bases. It opens and editor if required any time. The idea is to transform semantic program analysis into a visual formt that&amp;#8217;s more easily digestible. Just like in Google Maps where you see the big important roads and only the details when you zoom in. He uses this tool all day on his own codebase too, and gradually realised that when you want to learn a new codebase, you want to start to learn the software architecture first, and then want to figure out the dependency graph before seeing details.&lt;/p&gt;
&lt;p&gt;He then shows an interactive grid map that explains the dependencies of whole subdirectories of the OCaml compiler, and drill down to understand what they&amp;#8217;re for.&lt;/p&gt;
&lt;p&gt;Audience q: did you consider a flare graph? a: others have done edge graphs and graphviz etc, and none of these scale to quite the heights that this particular grid done. The ordering of the grid is also the transitive order of dependencies, so it starts with the list of simple dependencies (stdlib) and ends with the toplevel (depends on everything). You can spot for example the OCaml dev rule that things in stdlib are only used by the compiler.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo14-e1380031776990.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1481&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo14-e1380031776990-225x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;With good software, the top right of the grid is full, which is forbidden by OCaml (no cyclic module deps). With other software, the situation is far worse (audience laughter).&lt;/p&gt;
&lt;p&gt;There are many other tools (CodeQuery, stags, sgrep/spatch and scheck).  There are plugins for PHP, OCaml (using the cmt options) and Java (using Joust), C/C++ (using clang) getting all the semantic information from varied source code.  There is a plan to move it to the web (from a GTK interface) by using Ocsigen.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Conclusion: CodeMap is a scalable semantic source code vis/searcher for huge codebases, and codeGraph visualizes dependencies.   Future work is to minimize backward deps.&lt;/p&gt;
&lt;p&gt;All on Github at github.com/facebook/pfff.git&lt;/p&gt;
&lt;p&gt;Q: can you insert other metadata such as Linux perf output?&lt;/p&gt;
&lt;p&gt;A: yes! (I think)&lt;/p&gt;
&lt;h2&gt;Extension points: an alternative to camlp4&lt;/h2&gt;
&lt;p&gt;Leo White talking about alternatives to camlp4. Why? Camlp4 is very complex and it comes due to its support for an extensible grammar. Did a wg-camlp4 working group to figure out how to evolve common uses towards a more easily parsed standard, to reduce the day-to-day dependency on camlp4. After 400 emails, a consensum emerged.&lt;/p&gt;
&lt;p&gt;sexplib as an example: the old version was&lt;/p&gt;
&lt;pre&gt;type t = {
  float: int default(42);
  bar: float;
} with sexp&lt;/pre&gt;
&lt;p&gt;The annotated version is:&lt;/p&gt;
&lt;pre&gt;type t = {
  foo: int; [@default 42]
  bar: float
} [@@sexp]&lt;/pre&gt;
&lt;p&gt;This has annotation data that is passed straight through to a transformer, with no extensions to the grammar. Thus the sexplib transformer can understand with @default 42 means, and editors can easily hide or fold annotations without having to understand their details precisely.&lt;/p&gt;
&lt;p&gt;The compiler ignores any AST extension fragments that remain after all the transformers are done.&lt;/p&gt;
&lt;p&gt;sedlex&lt;/p&gt;
&lt;pre&gt;[%lexer
  match foo with
  (Range ('a','z') | Range(1000,1500)), 65 -&amp;gt; Foo
  | Star (Range('a','z')) -&amp;gt; Bar
]&lt;/pre&gt;
&lt;p&gt;These are genuine AST nodes and so if these aren&amp;#8217;t handled by the transformer, an error will result. Another example is&lt;/p&gt;
&lt;p&gt;properly foreign syntax, via COW (Caml on the Web)&lt;/p&gt;
&lt;pre&gt;let world = &quot;world&quot; in
let html =  [%html {|&amp;lt;h1&amp;gt;Hello $str:world$!&amp;lt;/h1&amp;gt;
|}]&lt;/pre&gt;
&lt;p&gt;There&amp;#8217;s also a shortcut convention for the syntax, such as:&lt;/p&gt;
&lt;pre&gt;match%lexer foo with
 {|&lt;/pre&gt;
&lt;p&gt;There&amp;#8217;s a shorthand form to avoid have lots of brackets due to deeply nested lets.&lt;/p&gt;
&lt;pre&gt;[%lwt let x = f () in
[%lwt let y = g () in&lt;/pre&gt;
&lt;p&gt;These have all been implemented by Alain Frisch and merged onto trunk (in OCaml 4.02.0dev). Thoughts and feedback are very welcome on the wg-camlp4 list&lt;/p&gt;
&lt;p&gt;Q: how does this affect the quality of error messages?&lt;br /&gt;
A: Leo -- do you mean error messages from the extension itself?&lt;br /&gt;
Q: what if there is an error in the extension?&lt;br /&gt;
A: The 42 that was in the default has an AST fragment and so the transformer will transplant the location. A sensible transformer will therefore be nonlossy.&lt;/p&gt;
&lt;p&gt;Q: can you chain transforms?&lt;br /&gt;
A: yes, thats why we are going with an AST fragment rather than a string, so chaining is easier. If youve got some macro expansion transformer and you want to use it with the sedlex example, they are executed in the other they are given on the command line. The next transformer will just see the resulting AST fragment, and therefore should compose between than camlp4 extensions have in the past.&lt;/p&gt;
&lt;p&gt;Q: do you have ideas about hygiene as Scheme does?&lt;br /&gt;
A: Not particularly in this case, although Leo has some ideas for future systems.&lt;/p&gt;
&lt;p&gt;Q: Ashish Agarwal -- do existing extensions need to be reimplemented&lt;br /&gt;
A: Good thing about all these existing extensions is that they have an existing parser, so you can take your existing implementation in camlp4 and mechanically translate into an extension_points version!&lt;/p&gt;
&lt;p&gt;Q: Yaron: is anyone thinking about good libraries (hygiene etc)&lt;br /&gt;
A: Alain Frisch has merged in ppxtools into OPAM stable (that depends on 4.02.0+)&lt;/p&gt;
&lt;p&gt;Q: Will this improve performance over camlp4&lt;br /&gt;
A: Parsing is an expensive process and this is still doing marshalling. The cost is often the case that we are shelling out to this other process, so we still need to look into improving performance in other ways.&lt;/p&gt;
&lt;h2&gt;GPGPU programming with SPOC&lt;/h2&gt;
&lt;p&gt;M Bourgoin presents his PhD work on SPOC.&lt;/p&gt;
&lt;p&gt;GPGPU is odd hardware: several mutiprocessors, dedicated memory, connected via PCI-E and transferred between a GPU and host using DMA. Currently hardware has 300-2000 cores vs 4-16 CPU cores (wow). However this demands a very specific progamming model to take advantage of all this hardware.&lt;/p&gt;
&lt;p&gt;Shows an example of a vector addition in openCL&lt;/p&gt;
&lt;pre&gt;__kernel vac_add(global const double *c, global const double *a, global double *b, int N)
int nIndex = get_global_id(0);
if (nIndex &amp;gt;= N)
  return;
c[nIndex] = a[nIndex] + b[nIndex]&lt;/pre&gt;
&lt;p&gt;To actually use this though, you need a massive program to set up the kernel and execute it. It does the transforms, initialization, scheduling and so forth.&lt;/p&gt;
&lt;p&gt;OCaml and GPGPU complement each other, since we have sequential high-level OCaml and highly parallel and low-level GPGPU. So the idea with SPOC is to use OCaml to develop high level abstractions in the GPGPU and program it from OCaml.&lt;/p&gt;
&lt;p&gt;SPOC is a stream processing engine in OCaml that emits Cuda but lets it be more hardware independent.&lt;/p&gt;
&lt;pre&gt;let dev = Devices.init ()
let n = 100000
let v1 = Vector.create Vector.float64 in
let v2 = Vector.create Vector.float64 in
let v3 = Vector.create Vector.float64 in

let k = vector_add (v1,v2,v3,n)
let block = {blockX = 1024; blockY=1; blockZ=1}
let grid={gridx=(n+1024-1)/1024; gridY=1; gridZ=1}

let main()=
random_fill v1;
random_fill v2;
Kernel.run k  (block,grid) dev.(0);
#printf of result&lt;/pre&gt;
&lt;p&gt;SPOC takes care of transferring the kernel to the GPU and back and handling the scheduling and exchange of data. Vectors are very similar to Bigarrays in that they are external memory.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo15-e1380048240290.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1493&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo15-e1380048240290-224x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;We want: simple to express, predictable performance and extensible libraries, and for current high performance libraries to be usable more safely.&lt;/p&gt;
&lt;p&gt;Two solutions: interop with Cuda/OpenCL kernel (better perf and more compatible but less safe). There is also a DSL in OCaml called Sarek, which talk focusses on.&lt;/p&gt;
&lt;p&gt;Sarek vector addition has an ML like syntax, and the language features monomorphic, imperative, toplevel and statically typed checked (with type inference). Its statically compiled to OCaml code and dynamic compilation to Cuda and OpenCL.&lt;/p&gt;
&lt;p&gt;SPOC+Sarek achieves 80% of hand-tuned Fortran performance and SPOC+external kernels is on par with Fortran (93%). It&amp;#8217;s type safe, 30% code reduction, memory managed by the GC and there are fewer memory transfers. This is ready for the real world and has great performance! Available on OPAM.&lt;/p&gt;
&lt;p&gt;Great performance, portable, great for GPU and for multicore CPU and nice playground for future abstractions.&lt;br /&gt;
Who can benefit?&lt;/p&gt;
&lt;p&gt;OCaml programmers -&amp;gt; better performance&lt;br /&gt;
HPC programmers -&amp;gt; much more flexible and extensible than current state of the art.&lt;/p&gt;
&lt;p&gt;Future work: Sarek needs custom types, function decls, recursions, exceptions, and to build parallel skeletons using SPOC and Sarek.&lt;/p&gt;
&lt;p&gt;Why not use Sarek for multicore? Well, here&amp;#8217;s the results!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ParMap: data parallel and similar to OCaml mapfold&lt;/li&gt;
&lt;li&gt;OC4MC: posix threads, compatible with current OCaml code&lt;/li&gt;
&lt;li&gt;SPOC : GPGPU kernels on a CPU, mainly data parallel and needs OpenCL.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Simple program to calculate power series and matrix multiplication.&lt;/p&gt;
&lt;p&gt;Power: OCaml 11s14, Parmap 3s30 SPOC &amp;lt;1s&lt;br /&gt;
Matmul: OCaml 85s OC4MC 28s and SPOC 6.2s&lt;/p&gt;
&lt;p&gt;Significant improvements using SPOC &amp;#8212; 11x for power series and 12x for SPOC. Running on a quad core intel i7.&lt;/p&gt;
&lt;p&gt;SPOC is available via OPAM and compatible with x86_64 on Linux and MacOS X, and speaker would love feedback.&lt;/p&gt;
&lt;p&gt;Q: Anil &amp;#8211; how hard is OpenCL to install&lt;br /&gt;
A: easy if you know your hardware model and to the vendor website. Harder with multiple GPUs though.&lt;/p&gt;
&lt;p&gt;A: if you want to target CPUs, you need to target OpenCL and not CUDA.&lt;/p&gt;
&lt;h2&gt;High level performance optimisations for OCaml&lt;/h2&gt;
&lt;p&gt;Pierre Chambart at OCamlPro (funded by Jane Street). OCaml is fast, but not an optimizing compiler (it has predictable performance, good generated code, but what can we do to make it go faster?).&lt;/p&gt;
&lt;p&gt;A small modification to high level code shouldnt influence the low level bits.&lt;/p&gt;
&lt;pre&gt;let f x = 
  let cmp = x &amp;gt; 3 in
  if cmp then A else B

let g x =
  if x &amp;gt; 3 then A else B&lt;/pre&gt;
&lt;p&gt;The second bit of code is faster than the first here since &amp;#8216;g&amp;#8217; is spotted by the compiler peephole optimizer.&lt;/p&gt;
&lt;pre&gt;let g x = 
  let f v = x + v in
  f 3&lt;/pre&gt;
&lt;p&gt;Abstract code should be compiled less abstractly. Above, we want to inline f, but a closure is still allocated per call unnecessarily. But we also dont want the compiler to be too smart and lose predictability!&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo16-e1380048580650.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1496&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo16-e1380048580650-225x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Currently compiler pipeline has a parsetree &amp;#8211; typed tree &amp;#8211; lambda (untyped) &amp;#8211; clambda (lambda+closures) &amp;#8211; cmm (simple C like) and then mach (instruction graph similar to llvm) and then lin (assembly like).&lt;/p&gt;
&lt;p&gt;Details: typed tree to lambda (construct elimination) &amp;#8211; lambda (high level simplication such as reference elimination and pattern matching generation) &amp;#8211; lambda to clambda (inlining, constrant propagation and book keeping in an intricate recursive loop) &amp;#8211; clambda to cmm (unboxing, lots of peep hole checks for boxing/unboxing and tagging/untagging) &amp;#8211; cmm to mach (instruction selection and some more peephole) &amp;#8211; mach (allocation fusion, register allocation and scheduling)&lt;/p&gt;
&lt;p&gt;Where do we do high level optimizations then? For example, where do we do inlining (since it allows other transformations to apply). typedtree is too complicate, lambda (want inlining, simpler with closures), clambda (is too difficult to improve, and Pierre did try) and cmm (good for local optimization but not global) and mach is architecture specific.&lt;/p&gt;
&lt;p&gt;They are adding a new intermediate form between lambda and clambda known as flambda. This needs a highlevel view of values, simple manipulations, explicit closures and explicit value dependencies. lambda to flambda introduces closures, and flambda to clambda is mainly book keeping (and preparing cross-module information). The magic for optimization will be in flambda-flambda passes, and not in the flambda to clambda layers.&lt;/p&gt;
&lt;p&gt;Shows several examples of inlining, simplication and dead code elimination and why its significantly easier in the flambda form for simple microexamples. Also shows lambda lifting!&lt;/p&gt;
&lt;p&gt;Change the performance model. Now its WYSIWYG, but we want some sort of understandable compile-time evaluation. For example, consider a map function as a metaprogramming function that you want to execute at compile time without all the intermediate closure allocation.&lt;/p&gt;
&lt;p&gt;Add build_test to your OPAM to make it easier to test the compiler, and Obj-using code is very likely to break if you do certain mutations behind the compiler, or dead code elimination might happen if you use a value behind the compiler&amp;#8217;s back.&lt;/p&gt;
&lt;p&gt;Q: SimonPJ: why is it easier to do closure conversion first, as it&amp;#8217;s a lot easier in GHC to do the opposite. There are now two ways to get a value in scope doing it the other way.&lt;br /&gt;
A: In Haskell you have everything in your closure, since you get the information from the closure.&lt;br /&gt;
Q: Think of lambda calculus with let&lt;br /&gt;
A: We do flow analysis to get around this!&lt;br /&gt;
Q: This is quite complex. Is it whole program analysis?&lt;br /&gt;
A: Restricted to a single compilation unit, and a few other cases, not cross-module yet.&lt;/p&gt;
&lt;p&gt;Q: Yoann: if the prediction is &amp;#8220;its always faster&amp;#8221; then why do you care about predictability?&lt;/p&gt;
&lt;h2&gt;Replacing the format string hack with GADTs&lt;/h2&gt;
&lt;p&gt;Benoit Vaugon talks about how to improve the typing of Format strings in OCaml by using GADT encodings. He stats with showing basic examples of the Printf module, and advanced examples that include the &amp;#8220;%a&amp;#8221; callback, date scanning and hex dumping.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo17-e1380051856191.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1508&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo17-e1380051856191-300x225.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The OCaml type checker has an inferred type that encodes the details of the format string in a &amp;#8220;format6&amp;#8243; type that has lots of type parameters that describe the format string contents.&lt;br /&gt;
During type checking, the literal string is parsed and there is manual inference of the format6 type parameters. At runtime, the format strings are represented by the string from the source code.&lt;/p&gt;
&lt;p&gt;During printing functions, it parses the format and count parameters and accumulates parameters. It then extracts and patches subformats, and finally calls the C printf function. Scanning is more complex but broadly similar.&lt;/p&gt;
&lt;p&gt;There are quite a few problems with this. There are 5 (!) format string parsers (two in Printf, two in Scanf, one in the type checker) and there are lots of little incompatibilities as a result. For example&lt;/p&gt;
&lt;pre&gt;Printf.printf &quot;%1.1s&quot; &quot;hello&quot;&lt;/pre&gt;
&lt;p&gt;Results in Invalid_argument exception despite the static type checking, with a useless error message.&lt;/p&gt;
&lt;p&gt;There is a weakness in the type checker too, for example&lt;/p&gt;
&lt;pre&gt;Printf.sprintf &quot;%s.+f&quot; 3.14&lt;/pre&gt;
&lt;p&gt;results in the format string being printed.&lt;/p&gt;
&lt;p&gt;You can also segfault from there, such as&lt;/p&gt;
&lt;pre&gt;Format.printf &quot;@%d%s&quot; 42 &quot;hello&quot;&lt;/pre&gt;
&lt;p&gt;will segfault.&lt;/p&gt;
&lt;p&gt;Speed is also a concern, as parsing the format at runtime is slow, and reparsing is required by another slow C printing function. Lots of memory allocation is required.&lt;/p&gt;
&lt;p&gt;The new implementation sorts all this out by using GADTs to represent the formats. The format6 type is now concrete and not magic predefined. Formats now also become statically allowed and not multiply passed around dynamically.&lt;/p&gt;
&lt;p&gt;The new implementation (which he shows) is a fairly epic GADT but quite regular when broken down into pattern clauses and examined with respect to the old implementation.&lt;/p&gt;
&lt;p&gt;Issues: evaluation order changes slightly, as for printing functions the parameters are accumulated before printing. String_of_format is implemented by &amp;#8220;%identity&amp;#8221; and in the new implementation, we need to change the representation (either regenerate the string from the GADT or implement formats by a tuple).&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo18-e1380051839961.jpg&quot;&gt;&lt;img class=&quot;alignright  wp-image-1509&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo18-e1380051839961-225x300.jpg&quot; width=&quot;158&quot; height=&quot;210&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;There&amp;#8217;s now only one format parser (down from 4-5) for the standard library and OCaml type checker&lt;/p&gt;
&lt;pre&gt;type ('b,'c,'e,'f) fmt_ebb = Fmt_EBB:
 ('a,'b,'c,'d,'e,'f) CamlinternalFormatBasics.fmt -&amp;gt;
 ('b,'c,'e,'f) fmt_ebb
val fmt_ebb_of_string : string -&amp;gt; ('b,'c,'e,'f) fmt_ebb
val type_format: ('x,'b,'c,'t,'u,'v) format6 -&amp;gt;
   ('a,'b,'c,'d,'e,'f) fmtty -&amp;gt; ('a,'b,'c,'d,'e,'f) format6&lt;/pre&gt;
&lt;p&gt;(this looks verbose but isnt really exposed outside of the compiler.&lt;/p&gt;
&lt;p&gt;Another issue is the &amp;#8220;%(..%r..%)&amp;#8221; construction, since we need to include a proof term of the number of &amp;#8220;%r&amp;#8221; occurrences. The encoding for this is quite complex.&lt;/p&gt;
&lt;p&gt;Performance of the new system is significantly better across the board. A hello world goes from (230ns to 55ns) timing and (732 to 24 bytes allocated) for example.&lt;/p&gt;
&lt;p&gt;Q: Oleg did it already in Haskell &lt;i&gt;(ha ha &amp;#8212; editor)&lt;/i&gt;. He notes that six parameters arent needed, as the GADT is the interpreter over the paramters.&lt;br /&gt;
A: yes can remove them if we split the Printf and Scanf format, and there is also a format4 which removes several parameters. We also have a problem with error messages since all the type parameters make things really complicated.&lt;br /&gt;
Q: Oleg: the work of interpreting the stream is pushed into the GADT, but if you write an interpreter over the GADT then we have simpler external types.&lt;br /&gt;
&amp;#8230;discussion moves into offline discussion.&lt;/p&gt;
&lt;h2&gt;Dynamic types in OCaml&lt;/h2&gt;
&lt;p&gt;Gregoire Henry wants to do dynamic types in OCaml.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo19-e1380052996312.jpg&quot;&gt;&lt;img class=&quot;alignright size-thumbnail wp-image-1515&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo19-e1380052996312-150x150.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Structural type introspection: generic I/O primitives, type-safe (unlike Marshal) and typed (not written in Camlp4) &amp;#8212; these are polytypic functions.&lt;/li&gt;
&lt;li&gt;Normal type introspection, for dynamic values (a k/v store or a DSL with dynamic typing), or extensible polytypic functions for abstract types.&lt;/li&gt;
&lt;li&gt;This would also give us a common type representation for (e.g.) Eliom services that will be converted to Javascript, or for FFI libraries, and to let the debugger explore the heap with exact typing information.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Probably isnt a single representation that fits all these use cases: We need to preserve abstraction when desired, but also to break abstraction when desired (e.g. by the debugger or a generic printer, but not by accident!), and it shouldn&amp;#8217;t impose a big performance hit.&lt;/p&gt;
&lt;p&gt;Gregoire gives a description of a polytypic printing function&lt;/p&gt;
&lt;pre&gt;let rec print (type t) (ty: t ty) (v:t) =
  match head ty with
  |Int -&amp;gt; print_int v
  | String -&amp;gt; print_string v
  | List ty -&amp;gt; print_list (print ty) v
  | Sum desc -&amp;gt;
  let (name, args) = sum_get desc v in
  print_string name 
  ...&lt;/pre&gt;
&lt;p&gt;We define a predefined type &amp;#8220;t ty&amp;#8221; and a syntax for type expressions &amp;#8220;(type val t) of type &amp;#8220;t ty&amp;#8221;. We then introduce implicit type arguments which are optional arguments instantiated at call-site with the dynamic representation of the expected type.&lt;/p&gt;
&lt;pre&gt;val print : ?t:(typ val 'a) -&amp;gt; 'a -&amp;gt; string
let print ?(type val t) (v:t) = ...

type t = R of int * int | ...
let x = R (1,2)
let () = print x (* implicit arg is (type val t) *)&lt;/pre&gt;
&lt;p&gt;This is experimental syntax, but is shows how we can keep the representation abstract but the printer can still operate over it since the implicit argument passes the printer around.&lt;/p&gt;
&lt;p&gt;The main problem is now how we mix polytypic function and abstraction, without always printing &amp;#8220;abstract&amp;#8221; instead of the real underlying structure. One solution is an extensible polytypic function.&lt;/p&gt;
&lt;pre&gt;module M: sig
 type t
 val x: t
end = struct
  type t = R of int * int
  let x = R(22,7) let () = register_printer (external type val t) (fun x -&amp;gt; ... )

end
let () = print x&lt;/pre&gt;
&lt;p&gt;We register a printer internally in the module, without exposing its internal type externally, but still let it be printed. The internal and external types are different though. We do need to figure out a canonical name for types defined outside the current compilation unit (its absolute path).&lt;/p&gt;
&lt;p&gt;By default though, abstraction should consistently introduce new nominal types, but we&amp;#8217;re not sure how to reference all the of the external names of a given type within its initial compilation unit (open problem). A pragmatic approach to solving this is the manual or semi-automatic creation of runtime &amp;#8220;type names&amp;#8221;.&lt;/p&gt;
&lt;p&gt;In conclusion, they have a GADT for structural introspection and a RTT representation with global names.  There is also a type-constructor index association table.  Implicit type arguments (lightweight syntax for calling polytypic function, and explicit type parameters for polymorphic functions).&lt;/p&gt;
&lt;p&gt;Q: what&amp;#8217;s the gain of putting this into the compiler?&lt;/p&gt;
&lt;p&gt;A: you may miss language corners, such as firstclass modules or functors, as your &amp;#8220;userspace&amp;#8221; OCaml code has to pass a type witness into a functor or firstclass module.  Compiler support makes this passing much easier.  The other big benefit is clear error messages from this compiler integration in the long term.  It&amp;#8217;s not currently easy for beginners, and this is very important to get right if this becomes a supported feature.&lt;/p&gt;
&lt;h2&gt;On variation, injectivity and abstraction&lt;/h2&gt;
&lt;p&gt;Jacques Garrigue speaks about an interesting bug in the type checker that needs some language changes. There was PR#5985 which was a serious type checker bug that lost injectivity.&lt;/p&gt;
&lt;pre&gt;module F(S: sig type 'a s end) = struct
  include S
  type _ t = T : 'a -&amp;gt; 'a s t
end
module M = F (struct type 'a s = int end)
let M.T x = M.T 3 in x
- : 'a = &amp;lt;poly&amp;gt; &lt;i&gt;the type is lost!&lt;/i&gt;&lt;/pre&gt;
&lt;p&gt;After expanding &amp;#8220;s&amp;#8221;, the definition of &amp;#8220;M.t&amp;#8221; is actually &amp;#8220;type _t = T : &amp;#8216;a -&amp;gt; int t&amp;#8221; but &amp;#8220;&amp;#8216;a&amp;#8221; is not marked as an existential.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo20-e1380054255495.jpg&quot;&gt;&lt;img class=&quot;alignright size-thumbnail wp-image-1521&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo20-e1380054255495-150x150.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In order to protect against this unsoundness, all variables in type declarations must be bound, either by appearing inside the type parameters or be existentially bound (i.e. only present in GADTs). Inside type parameters, these variables must be &lt;b&gt;injective&lt;/b&gt;.&lt;/p&gt;
&lt;p&gt;OCaml doesnt do injectivity directly, since it relies of variance inference (since we have subtyping). The variance of a parameter is either &lt;i&gt;explicit&lt;/i&gt; for abstract and private types or constrained parameters, or its &lt;i&gt;inferred&lt;/i&gt; from its occurrences otherwise.&lt;/p&gt;
&lt;p&gt;Constrained type parameters have been present since the very start.&lt;/p&gt;
&lt;pre&gt;type 'a t = T of 'b constraint 'a = 'b list&lt;/pre&gt;
&lt;p&gt;Rules for checking variance in this case become much more complicated, since constrained parameters variance must now be &lt;b&gt;explicit&lt;/b&gt; The variance of type variables inside constrained parameters must also be weaker or equal the version inside the body of the definition.&lt;/p&gt;
&lt;pre&gt;type +'a t = T of 'b constraint 'a = 'b list (* 'b covariant *)
type 'a r = 'a -&amp;gt; int                        (* contravariant *)
type +'a t = T of 'b constraint 'a = 'b r    (* Fails *)
(* 'b is contravariant in parameters but covariant inside *)&lt;/pre&gt;
&lt;p&gt;In OCaml though, the variance of a parameter is allowed to be weakened through abstraction.&lt;/p&gt;
&lt;pre&gt;module M : sig
  type +'a u 
end = struct 
  type 'a u = int
end&lt;/pre&gt;
&lt;p&gt;This is correct for the types, but becomes incorrect when used for &lt;i&gt;type parameters&lt;/i&gt;.&lt;/p&gt;
&lt;pre&gt;module F(X: sig type 'a r end) = struct
  type +'a t = T ob 'b constraint 'a = 'b X.r
end
module N = F (struct type 'a r = 'a -&amp;gt; int end)&lt;/pre&gt;
&lt;p&gt;Even when we assume that r is invariant, &amp;#8216;b is inferred as invariant from the parameter of t, which overrides the covariance of the body. Meanwhile in the module N, the variance is now wrong.&lt;/p&gt;
&lt;p&gt;How do we fix this? We need to refine the definition of variance, as traditional variance subumption defines a lower bound on the variance, but we need to add some upper bound information too, to be sure that parameters cannot have a strong variance.&lt;/p&gt;
&lt;p&gt;&lt;i&gt;(technical explanation of how to compose variances omitted here)&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;In OCaml 4.01, full variance inference is done using 7 flags (the last is a special case required for principality). Some uses will no longer type check so programs may be rejected for safety.&lt;/p&gt;
&lt;p&gt;In the future, Jeremy Yallop, Leo White and Jacques would like to add injectivity annotations for abstract types.&lt;/p&gt;
&lt;pre&gt;type #'a s
type _ t = T : 'a -&amp;gt; 'a s t&lt;/pre&gt;
&lt;p&gt;Add new types for isomorphic abbreviations, as Haskell does&lt;/p&gt;
&lt;pre&gt;module M : sig type #'a t val f : int -&amp;gt; ['pos] t end = struct
  type 'a t = new int
  let f x = (abs x : int :&amp;gt; 'a t)
end&lt;/pre&gt;
&lt;p&gt;This is similar to private, but subtyping will work in both directions &amp;#8212; this is useful for efficiency, encoding runtime types and allows coercions to be delayed until the signature rather than in the both (in the example above, the coercion in &amp;#8220;f&amp;#8221; could be omitted) due to the signature.&lt;/p&gt;
&lt;p&gt;Another problem is that one cannot prove the uniqueness of abstract types, and we dont know whether an abstract type is contractive (so even if you use rectypes, the following functor can never be defined)&lt;/p&gt;
&lt;pre&gt;module Fixpoint (M: sig type 'a t end) = struct
  type fix = fix M.t 
end
Error: the type abbreviation fix is cyclic&lt;/pre&gt;
&lt;p&gt;One also never knows whether an abstract type may be a float, so the float array optimization may be mismatched.&lt;/p&gt;
&lt;h2&gt;OCamlot: lots of OCaml testing!&lt;/h2&gt;
&lt;p&gt;(will post David&amp;#8217;s slides on the OCaml Labs website since it&amp;#8217;s one of our talks. Will edit this post when that happens).&lt;/p&gt;
&lt;h2&gt;Merlin: editor support for OCaml&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo21-e1380057773342.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1530&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo21-e1380057773342-225x300.jpg&quot; /&gt;&lt;/a&gt;&lt;br /&gt;
&lt;a href=&quot;https://github.com/def-lkb/merlin&quot;&gt;Merlin&lt;/a&gt; is a sophisticated editor assistant for OCaml that provides autocompletion in vim and emacs. They leap straight into an interactive demo that&amp;#8217;s awesome: autocompletion, module introspection when writing a functor, and so on.&lt;/p&gt;
&lt;p&gt;Unlike other tools, this doesn&amp;#8217;t rely on a CMT file, so code doesn&amp;#8217;t need to compile (except for source browsing). Your project can have type errors when using Merlin!&lt;/p&gt;
&lt;p&gt;It integrates with the ecosystem and has direct support for Findlib. There is no direct support for camlp4 however, with specific support for some extensions. If you want a new shiny extension then talk directly to them&lt;/p&gt;
&lt;p&gt;There is build system support for running either omake or Jenga in polling mode (for iterative recompilation). Omake rules can inform Merlin to get a consistent state of the project!&lt;/p&gt;
&lt;p&gt;A typical session: Parsing is done in two stages and the OCaml parser has been modified to be much more resilient to errors. The usual typing rules are applied, but passed onto a more &amp;#8220;relaxed&amp;#8221; typers in case of errors to give some support for incremental parsing.&lt;/p&gt;
&lt;p&gt;Coming soon is documentation (ha!) as well as retrieval for ocamldoc comments to further augment hints, as well as even more error recovery heuristics. Some of the patches will also be submitted upstream to improve error handling (by accumulating them instead of printing them directly).&lt;/p&gt;
&lt;p&gt;It&amp;#8217;s available on OPAM under an MIT license via &amp;#8220;opam install merlin&amp;#8221; and thanks to Jane Street for letting them work on it during an internship there, and all the bug reporters!&lt;/p&gt;
&lt;p&gt;Q: Have you considered running Merlin on a remote system and speak the same JSON protocol?&lt;br /&gt;
A: They haven&amp;#8217;t, but it really shouldn&amp;#8217;t be a problem.&lt;/p&gt;
&lt;p&gt;Q: Julien V: do we have to build first?&lt;br /&gt;
A: No you dont have to build first&lt;br /&gt;
Q: What happens when you change branches in a project&lt;br /&gt;
A: For project-wide information you need to compile and rebuild.&lt;/p&gt;
&lt;p&gt;Q: in the second pass of type checking, what does &amp;#8220;relaxed&amp;#8221; mean&lt;br /&gt;
A: When typing fails for some branch of the AST, in the simple case we introduce a fresh type variable and attempt to do unification with the result of this. This will never be sound, but lets it make progress and give SOME feedback to the user.&lt;/p&gt;
&lt;p&gt;Q: is this a new type checker?&lt;br /&gt;
A: No its the original type checker with augmented error handling paths to do more unification.&lt;/p&gt;
&lt;p&gt;Q: is the relaxed checking really worthwhile? It wasnt a lot of use in gcc since you get a lot of followon errors that are meaningless.&lt;br /&gt;
A: lots of discussion, opinions split, it can be disabled!&lt;/p&gt;
&lt;h2&gt;Understanding memory behaviour of programs&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo22-e1380058304144.jpg&quot;&gt;&lt;img class=&quot;alignright size-thumbnail wp-image-1533&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo22-e1380058304144-150x150.jpg&quot; /&gt;&lt;/a&gt;&lt;br /&gt;
Cagdas B doing a PhD on memory profiling. He wants to study the behaviour of OCaml programs and work on decreasing memory footprint and generally reduce GC pressure on real OCaml programs.&lt;/p&gt;
&lt;p&gt;Shows Why3 graph (see photograph) and they&amp;#8217;re running nice finegrained analysis over it on real world analyses. How do they generate these graphs?&lt;/p&gt;
&lt;pre&gt;$ opam switch 4.00.1+ocp-memprof
$ opam install why3
$ OCAMLRUNPARAM=m why3replayer.opt -C why3.conf p9_16&lt;/pre&gt;
&lt;p&gt;Patched compiler and then the OCAMLRUNPARAM will generate a lot of sampled snapshots of the OCaml heap. There&amp;#8217;s no need to change the code or the compilation options. Then install analysis tools&lt;/p&gt;
&lt;pre&gt;$ opam install ocp-memprof
$ ocp-memprof -loc -sizes PID&lt;/pre&gt;
&lt;p&gt;The final step analyses all the snapshots. But what is a snapshot? It&amp;#8217;s a compressed version of the OCaml heap, with location ids, a graph with pointers, and has saved globals (toplevel modules). We obtain the snapshots by computing a linear scan of all the heap values.&lt;/p&gt;
&lt;p&gt;The OCAMLRUNPARAM=m forces the program to generate a snapshot after every major GC, or request the program to generate a snapshot via a HUP signal, or via a new &amp;#8220;dump_heap&amp;#8221; function that&amp;#8217;s been added to the GC module.&lt;/p&gt;
&lt;p&gt;It works by reserving some space inside the standard OCaml value block, and so there is minimal runtime performance impact except when dumping out snapshots after a GC. There&amp;#8217;s no space overhead since the header size isnt changed. However, it&amp;#8217;s only available on 64-bit platforms and reduces block size to 64GB. Ran experiment with OPAM and location identifiers are limited.&lt;/p&gt;
&lt;p&gt;There&amp;#8217;s one tool based on the snapshot identifiers and the &amp;#8220;memprof&amp;#8221; tool gets all identifiers from the heap and the corresponding location, and then looks up the right types from a specific location using cmt files (the typed AST).&lt;/p&gt;
&lt;p&gt;Plan for this work is to improve the current framework (aggregate information by type and location) and to recover more types, and build more tools around it!&lt;/p&gt;
&lt;p&gt;Q: Roshan: one common usecase is when grabbing locations, its boring to see Array.create and it would be nice to see a backtrace of the execution to see &lt;i&gt;where&lt;/i&gt; the allocation happened.&lt;br /&gt;
A: this is a problem indeed (discussion about the ongoing Mark Shinwell patches too, and previous talk about backtrace analysis from last years workshop).&lt;/p&gt;
&lt;h2&gt;Benchmarking in Core&lt;/h2&gt;
&lt;p&gt;Roshan James about microbenchmarking in JS Core. Precise measurementis essential for performance critical code. We want to measure the execution cost of functions that are relatively cheap. Functions with a short execution time that run millions of times in a tight loop.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo23-e1380059673542.jpg&quot;&gt;&lt;img class=&quot;alignright size-thumbnail wp-image-1538&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo23-e1380059673542-150x150.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The essence of benchmarking is to run a time loop (like Time.now) a lot of times. We need to figure out how to compute a batch size to account for the time it takes to run the actual timing measurement. Similar to Criterion for Haskell, where they loop Time.now to figure out how long it takes to compute the time itself, and then run the benchmark function, and compute a full estimate. This works ok, but it requires density plots to let you visualise the form of the error (bimodal, or something else, for example).&lt;/p&gt;
&lt;p&gt;There is a lot of noise in microbenchmarking, such as delayed costs due to GC, and variance in execution times is affected by batch sizes. So if we vary the batch size, the variance changes quite a bit since the GC is running in different intervals during the batches. The GC noise has a periodicity though!&lt;/p&gt;
&lt;p&gt;They treat microbenchmarking as a linear regression, and then fit execution time to a batch size. They vary the batch size geometrically to get a better linear fit (shows a very linear graph). Theres now no need to estimate the clock and other constant errors, since they are accounted for by the y-intercept which shows the constant costs.&lt;/p&gt;
&lt;p&gt;Other costs can also be predicted in the same way, such as estimate memory allocations and promotions using batch size too. This also allows measuring a goodness of fit by using R2 and bootstrapping techniques.&lt;/p&gt;
&lt;p&gt;Example use of Core_bech is really easy:just&lt;/p&gt;
&lt;pre&gt;open Core.Std
open Core_bench.Std
let t1 = Bench.Test.create ~name:&quot;id&quot; (fun () -&amp;gt; ())&lt;/pre&gt;
&lt;p&gt;Is the identity run for example, and just put something more complex in there. Output is an Ascii_table with lots of columns showing interesting results.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo24-e1380059880672.jpg&quot;&gt;&lt;img class=&quot;alignright size-thumbnail wp-image-1539&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo24-e1380059880672-150x150.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Some functions have a strange execution time, and the observation isnt a great fit. Between runs, they also directly query the GC and directly query how many times some things have happened (minor collections and so on), and include these along with the batch size in the predictor. With multiple predictors, they are really close to the observed results indeed.&lt;/p&gt;
&lt;p&gt;(lots of interesting maths about how they perform runtime cost decomposition)&lt;/p&gt;
&lt;p&gt;Its available via &amp;#8220;opam install core_bench&amp;#8221; and they want to expose more predictors by measuring the effect of live words on performance, and counters for major collection work per minor gc. Accuracy of results is interesting as least-squares is susceptible to outliers so they can incorporate the knowledge that the measurement is heavy-tailed.&lt;/p&gt;</content:encoded>
	<dc:date>2013-09-24T21:58:59+00:00</dc:date>
	<dc:creator>Anil Madhavapeddy</dc:creator>
</item>
<item rdf:about="http://pw374.github.io/posts/2013-09-24-14-19-56-on-the-implementation-of-opamdoc.html">
	<title>Philippe Wang: On the Implementation of OPAMDOC</title>
	<link>http://pw374.github.io/posts/2013-09-24-14-19-56-on-the-implementation-of-opamdoc.html</link>
	<content:encoded>&lt;p&gt;&lt;a href=&quot;https://github.com/ocamllabs/opam-doc/commits/master&quot;&gt;Early this year, Leo White started the implementation of
opamdoc&lt;/a&gt;.
Then &lt;a href=&quot;https://github.com/vincent-botbol&quot;&gt;Vincent Botbol&lt;/a&gt; worked on it
from late May to mid August during his stay in Cambridge.&lt;/p&gt;
&lt;p&gt;Now, Vincent's back to studying &amp;quot;computer science research&amp;quot; in Paris,
and he continues working on opam-doc when he can on his free time.&lt;/p&gt;
&lt;p&gt;I didn't really want to get involved too deep in the implementation of
opamdoc (mainly  because it takes time). Eventually,  since I've ended
up        doing        most        of       the        &lt;a href=&quot;https://github.com/ocamllabs/sandbox-ocaml.org&quot;&gt;technical-side
implementation&lt;/a&gt; of the
&lt;a href=&quot;http://ocaml-redesign.github.io&quot;&gt;new  ocaml.org web  site&lt;/a&gt;, I  had to
eventually get into  opamdoc's source code to integrate  its output in
the website.&lt;/p&gt;
&lt;p&gt;If you look at the &lt;a href=&quot;https://github.com/ocamllabs/opam-doc/&quot;&gt;source code of
opamdoc&lt;/a&gt;, you'll see there's a
bunch of files at the root directory. Well, some of them are inherited
from the implementation of ocamldoc, and some are new.  I've mostly
contributed to
&lt;a href=&quot;https://github.com/ocamllabs/opam-doc/blob/master/generate.ml&quot;&gt;&lt;code&gt;generate.ml&lt;/code&gt;&lt;/a&gt;
and
&lt;a href=&quot;https://github.com/ocamllabs/opam-doc/blob/master/opam_doc_config.ml&quot;&gt;&lt;code&gt;opam_doc_config.ml&lt;/code&gt;&lt;/a&gt;.
The former implements the HTML backend of opamdoc, and the latter
contains the JavaScript engine that loads the documentation. This blog
post is mostly about my experience with those two files.&lt;/p&gt;
&lt;h3 id=&quot;generateml&quot;&gt;generate.ml&lt;/h3&gt;
&lt;p&gt;This big file (about 1.5 kloc) contains the functions to retrieve
the information from cmt, cmd, cmti, cmdi and cmi files in order to
build the HTML document.&lt;/p&gt;
&lt;p&gt;Side note:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The &lt;a href=&quot;http://www.ocamlpro.com/blog/2012/08/20/ocamlpro-and-4.00.0.html&quot;&gt;&lt;code&gt;.cmt&lt;/code&gt; files were officially introduced in the standard OCaml
compiler in version
4.00.0&lt;/a&gt;,
so it's pretty recent work. Previously, they were produced by a
separate tool developed at OCamlPro for
&lt;a href=&quot;http://www.typerex.org&quot;&gt;TypeRex&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;Tworeasonswhyit39snotsupereasy&quot;&gt;Two reasons why it's not super easy&lt;/h4&gt;
&lt;p&gt;Well, this  can actually  be explain  in just a  few words.   To begin
with, there  are many cases to  address. Well, that is  not &lt;em&gt;exact&lt;/em&gt;. I
should say that  there are may cases to address  &lt;em&gt;and&lt;/em&gt; those cases are
fairly &lt;strong&gt;poorly  documented&lt;/strong&gt;, which is &amp;quot;normal&amp;quot; given  that there was
probably no  particular motivation to put  efforts into documentation.
This is  true for the source  code of ocamldoc &lt;em&gt;and&lt;/em&gt;  for its official
documentation.&lt;/p&gt;
&lt;p&gt;For instance, if you look into
&lt;a href=&quot;https://github.com/ocamllabs/opam-doc/blob/master/info.mli&quot;&gt;&lt;code&gt;info.mli&lt;/code&gt;&lt;/a&gt;, you
can see that the first type definition is:&lt;/p&gt;
&lt;pre class=&quot;ocaml&quot;&gt;&lt;code class=&quot;ocaml&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;style_kind&lt;/span&gt; &lt;span class=&quot;keywordsign&quot;&gt;=&lt;/span&gt;
  &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;SK_bold&lt;/span&gt;
  &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;SK_italic&lt;/span&gt;
  &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;SK_emphasize&lt;/span&gt;
  &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;SK_center&lt;/span&gt;
  &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;SK_left&lt;/span&gt;
  &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;SK_right&lt;/span&gt;
  &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;SK_superscript&lt;/span&gt;
  &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;SK_subscript&lt;/span&gt;
  &lt;span class=&quot;keywordsign&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;constructor module&quot;&gt;SK_custom&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;lower&quot;&gt;string&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and the only documentation for this type is
&lt;code&gt;(** The differents kinds of style.  *)&lt;/code&gt;.
Well, you can see that there's not really any
documentation needed for those &lt;code&gt;SK_...&lt;/code&gt; until... you see
&lt;code&gt;SK_custom of string&lt;/code&gt;.  There you go! You have to guess...&lt;/p&gt;
&lt;p&gt;It's not that hard when you have to guess a few times, it's
a lot harder when you keep having to guess. That's my point.&lt;/p&gt;
&lt;p&gt;Well, the other issue is more interesting.  At the time &lt;code&gt;ocamldoc&lt;/code&gt; was
designed  and  implemented,  I  bet  no one  imagined  what  folks  at
JaneStreet would do with  OCaml!  I'm talking about the implementation
of their  open source library, known  as &lt;code&gt;Core&lt;/code&gt;.  &amp;quot;&lt;code&gt;Core&lt;/code&gt; &amp;amp;  co&amp;quot; use a
&lt;em&gt;&lt;strong&gt;lot&lt;/strong&gt;&lt;/em&gt; of  &lt;code&gt;include&lt;/code&gt; directives.  The module  &lt;code&gt;Core.Std&lt;/code&gt; includes a
lot  of other  modules, which  also include  modules. If  you  want to
generate a single  full HTML page for &lt;code&gt;Core.Std&lt;/code&gt;, you'd  end up with a
&lt;em&gt;&lt;strong&gt;huge&lt;/strong&gt;&lt;/em&gt; page.  And  such a page would contain  a lot of information
coming straight  from other  pages, so you'd  end up with  hundreds of
megabytes.  Instead of  doing so, opamdoc generates only  one page per
package and one per module. If a module includes another one, then the
first will fetch the documentation of the second and there you go.  So
we  only  have 8.4MB  of  HTML  for  {async, async_core,  async_extra,
async_unix,  core, core_bench,  core_extended,  core_kernel} in  total
(well, this  number should  increase in the  future, but  linearly, as
people  will hopefully  start  documenting all  those packages).   And
that's why we have a JavaScript loader.&lt;/p&gt;
&lt;h3 id=&quot;opamdocconfigmlordocsloaderjs&quot;&gt;opam_doc_config.ml, or docs_loader.js&lt;/h3&gt;
&lt;p&gt;Since the JavaScript  may have to load tens of  megabytes of HTML, you
have to program some nasty functions and loops... and at some point it
does become big enough for  your browser to stop responding while it's
busy  loading your documentation.  So there  are several  solutions to
that. The best would probably be to stop writing in JavaScript (and
use something else that compiles to JavaScript). But that's for next
step. Now, we're trying to make the JavaScript work.&lt;/p&gt;
&lt;p&gt;The problem  with JavaScript  is that basically  there is  one &amp;quot;event&amp;quot;
loop,  and  all events  are  happening  sequentially or  concurrently,
depending on how  you wrote your JS, but when one  event is making the
browser busy,  the browser is unable  to do anything  else. That's why
your browser may tell you at  some point that you have a script making
it ill and ask you whether  you want it to stop executing that script.
One workaround  for that problem  when you know  you ask for a  lot of
computation time is to divide  your big computation into smaller ones.
You can  use &lt;code&gt;window.setTimeout&lt;/code&gt; for that, meaning  you transform your
recursive calls like &lt;code&gt;f()&lt;/code&gt;  into &lt;code&gt;window.setTimeout(f, 0)&lt;/code&gt; so that &lt;code&gt;f&lt;/code&gt;
will be called at some point. And if you have iterative loops instead,
write them recursive and use &lt;code&gt;window.setTimeout&lt;/code&gt;. That's bad.  Because
then the browser  is unable to tell that it's  crazy busy...  and it's
still really busy. So you can increase the value 0 to 1 or 10 or more.
But if you increase it too much, it'll become too slow...&lt;/p&gt;
&lt;p&gt;Ok, well, don't use JavaScript. It's a nightmare.&lt;/p&gt;
&lt;p&gt;We will probably rewrite the script using Js_of_ocaml at some point,
mainly because when you write in OCaml, you have static type checking,
and that saves so much time!&lt;/p&gt;
&lt;p&gt;To be followed...&lt;/p&gt;</content:encoded>
	<dc:date>2013-09-24T14:21:00+00:00</dc:date>
	<dc:creator>Philippe Wang</dc:creator>
</item>
<item rdf:about="http://amirchaudhry.com/ocamlorg-request-for-feedback">
	<title>Amir Chaudhry: Feedback requested on the OCaml.org redesign</title>
	<link>http://amirchaudhry.com/ocamlorg-request-for-feedback</link>
	<content:encoded>&lt;p&gt;There is a work-in-progress site at
&lt;a href=&quot;http://ocaml-redesign.github.io&quot;&gt;ocaml-redesign.github.io&lt;/a&gt;, where we've
been developing both the tools and design for the new ocaml.org pages.  This
allows us to test our tools and fix issues before we consider merging
changes upstream.&lt;/p&gt;

&lt;p&gt;There is a more detailed post coming about all the design work to date and
the workflow we're using, but in the meantime, feedback on the following
areas would be most welcome.  Please leave feedback in the form of issues on
the &lt;a href=&quot;https://github.com/ocamllabs/sandbox-ocaml.org/issues&quot;&gt;ocaml.org sandbox repo&lt;/a&gt;.  You can also raise points on the
&lt;a href=&quot;http://lists.ocaml.org/listinfo/infrastructure&quot;&gt;infrastructure mailing list&lt;/a&gt;.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;OCaml Logo&lt;/strong&gt; - There was some feedback on the last iteration of the
logo, especially regarding the font, so there are now several options to
consider.  Please look at the images on the
&lt;a href=&quot;https://github.com/ocaml/ocaml.org/wiki/Draft-OCaml-Logos&quot;&gt;ocaml.org GitHub wiki&lt;/a&gt; and then leave your feedback on
&lt;a href=&quot;https://github.com/ocamllabs/sandbox-ocaml.org/issues/16&quot;&gt;issue #16 on the sandbox repo&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Site design&lt;/strong&gt; - Please do give feedback on the design and any glitches
you notice. Text on each of the new landing pages is still an initial draft
so comments and improvements there are also welcome (specifically: Home
Page, Learn, Documentation, Platform, Community). There are already a few
&lt;a href=&quot;https://github.com/ocamllabs/sandbox-ocaml.org/issues&quot;&gt;known issues&lt;/a&gt;, so do
add your comments to those threads first.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;</content:encoded>
	<dc:date>2013-09-24T14:00:00+00:00</dc:date>
</item>
<item rdf:about="http://pw374.github.io/posts/2013-09-24-01-50-14-opamdoc-take1.html">
	<title>Philippe Wang: OPAM-DOC with multiple OCaml packages</title>
	<link>http://pw374.github.io/posts/2013-09-24-01-50-14-opamdoc-take1.html</link>
	<content:encoded>&lt;h3 id=&quot;OPAMDOC&quot;&gt;&lt;a href=&quot;https://github.com/ocamllabs/opam-doc/&quot;&gt;OPAM-DOC&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The tool &lt;code&gt;ocamldoc&lt;/code&gt; shipped with the standard distribution of the
OCaml compiler suffers from some limitations because it doesn't have
access to all the information it needs. Notably, if you want to build
the documentation of some package &lt;code&gt;a&lt;/code&gt; that depends on some package
&lt;code&gt;b&lt;/code&gt;, you'll find out that the documentation of the package &lt;code&gt;a&lt;/code&gt; will
not automatically refer to the documentation of the package &lt;code&gt;b&lt;/code&gt;.
Well, opamdoc solves this problem and it's very nice.&lt;/p&gt;
&lt;p&gt;On &lt;a href=&quot;http://ocaml-redesign.github.io/&quot;&gt;this site&lt;/a&gt;, which is work in progress,
you can find a &lt;a href=&quot;http://ocaml-redesign.github.io/pkg/&quot;&gt;list of packages&lt;/a&gt; 
with their descriptions. This list is built using &lt;a href=&quot;https://github.com/OCamlPro/opam2web&quot;&gt;opam2web&lt;/a&gt;.
And each package description links to its documentation. And the documentation
for all packages is built as a whole, which means that if the documentation of 
a package links to all other packages on which it depends. Isn't it nice? 
:)&lt;/p&gt;
&lt;h3 id=&quot;Installandrunopamdoc&quot;&gt;Install and run opamdoc&lt;/h3&gt;
&lt;p&gt;opamdoc is still under active development, the current step is
&lt;a href=&quot;https://github.com/ocamllabs/opam-doc/issues/&quot;&gt;finding and fixing remaining issues&lt;/a&gt; and
packaging.&lt;/p&gt;
&lt;p&gt;If you want to use opamdoc now, here's some instructions based on
&lt;a href=&quot;https://github.com/ocamllabs/opam-doc/issues/1#issuecomment-23430108&quot;&gt;Anil's instructions&lt;/a&gt;, 
which are those:&lt;/p&gt;
&lt;blockquote&gt;&lt;pre&gt;&lt;code&gt;opam remote add opamdoc git://github.com/avsm/opamdoc-dev
opam switch 4.01.0beta1+opamdoc
eval `opam config env`
opam install opamdoc
opamdoc-rebuild
opamdoc-generate
open ~/.opam/4.01.0beta1+opamdoc/opamhtml/index.html&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
 &lt;li&gt;&lt;code&gt;opamdoc-rebuild&lt;/code&gt; builds a database of cmt/cmd files in &lt;code&gt;~/.opam/4.01.0beta1+opamdoc/opamdoc&lt;/code&gt;.&lt;/li&gt;
 &lt;li&gt;&lt;code&gt;opamdoc-generate&lt;/code&gt; builds a package HTML list in &lt;code&gt;~/.opam/4.01.0beta+opamdoc/opamhtml&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;Well, they work quite well, except &lt;code&gt;opamdoc-rebuild&lt;/code&gt; uses &lt;code&gt;.cmd&lt;/code&gt;  files as a base, whereas
it should use &lt;code&gt;.cmt&lt;/code&gt; files instead because sometimes &lt;code&gt;.cmt&lt;/code&gt; files exist while &lt;code&gt;.cmd&lt;/code&gt; don't.
This is a problem for a few packages (&lt;code&gt;Core&lt;/code&gt; is one of them).&lt;/p&gt;
&lt;p&gt;My advice: if something doesn't work as expect, 
please &lt;a href=&quot;https://github.com/ocamllabs/opam-doc/issues&quot;&gt;open an issue&lt;/a&gt;, 
and if you want to customize the way the documentation is built, 
don't hesitate to edit &lt;code&gt;opamdoc-rebuild&lt;/code&gt; and/or &lt;code&gt;opamdoc-generate&lt;/code&gt; (they are Bash scripts).&lt;/p&gt;
&lt;h4 id=&quot;Afewnotesaboutthoseinstructions&quot;&gt;A few notes about those instructions&lt;/h4&gt;
&lt;p&gt;The first line, which is &lt;code&gt;opam remote add opamdoc git://github.com/avsm/opamdoc-dev&lt;/code&gt;, 
will give sense to the second one, which is &lt;code&gt;opam switch 4.01.0beta1+opamdoc&lt;/code&gt;.
And &lt;code&gt;4.01.0beta1+opamdoc&lt;/code&gt; is a customised compiler that produces on the side the &lt;code&gt;.cm{t,d}{,i}&lt;/code&gt; files
that are used by opamdoc. Using it is very convenient! If you don't use it, you need to produce
those files in an other way &lt;strong&gt;of your choice&lt;/strong&gt; (really? you want to go through such trouble?).&lt;/p&gt;
&lt;p&gt;Note that opamdoc is written in such  a way that it would ask a lot of
work to  make it work  with versions of  the compiler prior  to 4.01.0
because it uses features introduced by this very version.&lt;/p&gt;
&lt;p&gt;Just in case, here follow the customised version of &lt;code&gt;opamdoc-rebuild&lt;/code&gt; and &lt;code&gt;opamdoc-generate&lt;/code&gt; that 
I used to build the documentation available on &lt;a href=&quot;http://ocaml-redesign.github.io/pkg/docs/&quot;&gt;http://ocaml-redesign.github.io/pkg/docs/&lt;/a&gt;.&lt;/p&gt;
&lt;h4 id=&quot;opamdocrebuild&quot;&gt;&lt;code&gt;opamdoc-rebuild&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;Here's my customised version of &lt;code&gt;opamdoc-rebuild&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/usr/bin/env bash
# Rebuild the cmd/cmt archive in ~/.opam/&amp;lt;switch&amp;gt;/opamdoc
# Copies all the cmt/cmti/cmd files found in the OPAM build
# dir into a single directory structure, separated by MD5
# to keep files distinct.

set -e
#dry=echo
SWITCH=$(opam switch show)
if [ &amp;quot;${SWITCH}&amp;quot; = &amp;quot;system&amp;quot; ]; then
  echo Must be using a custom OPAM switch for this to work.
  exit 1
fi

function calc_md5_for_file()
{
  if builtin command -v md5 &amp;gt; /dev/null; then
    md5=$(cat $1 | md5)
  elif builtin command -v md5sum &amp;gt; /dev/null ; then
    md5=$(cat $1 | md5sum | awk '{print $1}')
  else
    echo &amp;quot;Neither md5 nor md5sum were found in the PATH&amp;quot;
    exit 1
  fi
}

BASE=&amp;quot;$(dirname $(dirname $(ocamlc -where)))&amp;quot;
BUILD=${BASE}/build
DOC=${BASE}/opamdoc
rm -rf ${DOC}
mkdir -p ${DOC}

PKGS=$(find ${BUILD}/ -mindepth 1 -maxdepth 1 -type d &amp;quot;$@&amp;quot;)
echo ${PKGS}

for pkg in ${PKGS}; do
  pkgname=$(basename $pkg)
  echo $pkgname
  mkdir -p ${DOC}/$pkgname

  CMTS=$(find ${pkg} -type f -name '*.cmt')
  for cmt in ${CMTS}; do
    d=$(dirname $cmt)
    calc_md5_for_file &amp;quot;$cmt&amp;quot;;

    f=$(basename $cmt .cmt)
    mkdir -p ${DOC}/$pkgname/$md5
    r=${DOC}/$pkgname/$md5/$f
    for ext in cmt cmti cmd cmdi cmi ; do
        if [ -e $d/$f.$ext ]; then
            $dry cp $d/$f.$ext $r.$ext
        fi
    done
  done
done&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;opamdocgenerate&quot;&gt;&lt;code&gt;opamdoc-generate&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;Here's my customised version of &lt;code&gt;opamdoc-generate&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/usr/bin/env bash
# Rebuild the cmd/cmt archive in ~/.opam/&amp;lt;switch&amp;gt;/opamdoc
# Copies all the cmt/cmti/cmd files found in the OPAM build
# dir into a single directory structure, separated by MD5
# to keep files distinct.

set -e
#dry=echo
SWITCH=$(opam switch show)
if [ &amp;quot;${SWITCH}&amp;quot; = &amp;quot;system&amp;quot; ]; then
  echo Must be using a custom OPAM switch for this to work.
  exit 1
fi

OPAMDOC=${OPAMDOC:-opamdoc}


BASE=&amp;quot;$(dirname $(dirname $(ocamlc -where)))&amp;quot;
BUILD=${BASE}/build
DOC=${BASE}/opamdoc
HTML=${BASE}/opamhtml

rm -rf ${HTML}
mkdir -p ${HTML}

# Grab the build dir in reverse mtime order to get the
# ordering of generation &amp;quot;correct&amp;quot;.
PKGS=$(ls -1tr $BUILD)

rm -rf $HTML
mkdir -p $HTML
cd $HTML
for pkg in ${PKGS}; do
  fs=&amp;quot;$(find $DOC/$pkg -type f)&amp;quot;
  if [ &amp;quot;$fs&amp;quot; != &amp;quot;&amp;quot; ]; then
    name=$(echo $pkg | awk -F. '{print $1}')
    echo $pkg $name
    $dry $OPAMDOC -p $name $fs
  fi
done&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Enjoy.&lt;/p&gt;</content:encoded>
	<dc:date>2013-09-24T00:50:14+00:00</dc:date>
	<dc:creator>Philippe Wang</dc:creator>
</item>
<item rdf:about="http://www.syslog.cl.cam.ac.uk/?p=1347">
	<title>SRG Syslog: Liveblogging CUFP 2013</title>
	<link>http://www.syslog.cl.cam.ac.uk/2013/09/22/liveblogging-cufp-2013/</link>
	<content:encoded>&lt;p class=&quot;lead&quot;&gt;I&amp;#8217;m here at the &lt;a title=&quot;CUFP 2013&quot; href=&quot;http://cufp.org/conference/schedule&quot;&gt;Commercial Users of Functional Programming&lt;/a&gt; workshop at &lt;a href=&quot;http://icfpconference.org/icfp2013/&quot;&gt;ICFP 2013&lt;/a&gt;) with Heidi Howard, David Sheets and Leo White.&lt;/p&gt;
&lt;img class=&quot;size-medium wp-image-1410 alignright&quot; alt=&quot;marius1&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/marius1-300x292.jpg&quot; width=&quot;150&quot; /&gt;
&lt;p&gt;Marius Eriksen and Michael Sperber are co-chairing this year. Functional programming is a hot topic these days, and this year&amp;#8217;s program reflects the maturing nature of the program. Record number of submissions, and we could easily have made this a multi-day program.  Videos will be available online after the event.&lt;/p&gt;
&lt;p&gt;Keynote is from &lt;a href=&quot;http://www.davethomas.net&quot;&gt;Dave Thomas&lt;/a&gt; on what we can learn from the &amp;#8220;language wars of the past&amp;#8221;.  His talk will cover the business, social and technical ends of building Smalltalk and his &amp;#8220;objaholic&amp;#8221; experiences with pushing language technology into businesses, where they never had any intention of changing in this regard.  This worked over the years because it made a material difference to these businesses.  Dave still uses the &lt;a href=&quot;http://en.wikipedia.org/wiki/K_(programming_language)&quot;&gt;K&lt;/a&gt; programming a lot at work.&lt;/p&gt;
&lt;p&gt;&lt;span id=&quot;more-1347&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/clark1.jpg&quot;&gt;&lt;img class=&quot;size-medium wp-image-1409 alignright&quot; alt=&quot;clark1&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/clark1-300x294.jpg&quot; width=&quot;150&quot; /&gt;&lt;/a&gt;
&lt;p&gt;Dave is responsible for the Eclipse IDE and the IBM Java virtual machines, and has delivered software on everything from mainframes to wristwatches.&lt;/p&gt;
&lt;p&gt;Rush in the 70s with Symbolics and the amazingly cool hardware, followed by the rush to logic programming that led to his grants disappearing. Midway through the 80s, they discovered we wouldnt get parallelism for free with all this magic. After that came the era of machine learning and knowledge ontology crusades, but they are very specialised bits of tech. There remain sectors where ontologies are useful. Nowadays its the multicore crusades, and FP is emerging as useful.&lt;/p&gt;
&lt;p&gt;Every road leads to some form of FP, because the principles underlying it apply. Dave does vector programming, Haskell does this with array transformation.&lt;/p&gt;
&lt;p&gt;Dave was talking to Simon PJ outside and claimed that &amp;#8220;FP has won!&amp;#8221;, at which point Simon replied &amp;#8220;really?&amp;#8221; (laughter). OO techniques can also lead to a lot of tangled code: witness the evolution of Smalltalk to the current generation of languages.&lt;/p&gt;
&lt;p&gt;FP technical challenges: what happens when you have a lot of functions, and a group of consenting adults are doing it together. This is called software engineering, or at worst, IT!&lt;/p&gt;
&lt;p&gt;Lots of good work in the community on approaching large scale programming. Scala is a bit too complex for Dave (and audience rumbles in agreement or disagreement?). Java and JNI should just die. Erlang and actors are successful to decouple software. But do we really need to hide all our queues, and do we really need to hide our queues? Static analysis of queues are desired.&lt;/p&gt;
&lt;p&gt;Want to go fast? Computers like rectangles, all the way down! Array operations and vector processing is the way to go in the long-term.&lt;/p&gt;
&lt;p&gt;To go to industry, we need end-to-end toolchains. If you use MS Project, then you probably shouldn&amp;#8217;t introduce any new tools.&lt;/p&gt;
&lt;p&gt;The first commercial customer for Smalltalk in the 1980s was Techtronix, who wanted to embed reusable tech in their oscilloscopes. If you&amp;#8217;re building a serious product like this, it needed language interop between C++ (the logic sensor) and the Smalltalk. Respect the language cultures among components (anyone remember s-records?). ROM had to be replaced with Flash because noone can write code that doesn&amp;#8217;t need upgrading (groans from the audience).&lt;/p&gt;
&lt;p&gt;With the right tools, programmers will be able to go as quickly as Smalltalk, or at worse Java. We need the work of Simon [PJ] and colleagues on Haskell. Scala is so complex will become the Java (which is the Cobol of tomorrow).&lt;/p&gt;
&lt;p&gt;When shipping products, you need to track all the versions of language components in the toolchain. Too many FP toolchains are monolithic and make it hard to track components in the field. JVMs are so slow because they don&amp;#8217;t have a good sharing model (DLLs).&lt;/p&gt;
&lt;p&gt;What Dave would like is version-to-version transformation in languages. Y2K was a problem not because IBM hadn&amp;#8217;t fixed it in their OS, but because customers had modified their local installations and were pinned 6-10 versions behind! The same will happen for existing FPs that fragment into multiple implementations, so will they descend into multiple version hell or will standards emerge from the community?&lt;/p&gt;
&lt;p&gt;Also, lets not leave the data behind. Can we alias data from existing legacy sources into our new languages, and not aim for the perfect representations? Most of our programs are dealing with problems with existing data, not code.&lt;/p&gt;
&lt;p&gt;Onto deployment issues. Erlang works very well for the problem domain that it&amp;#8217;s designed for, but more complex domains exist like OSGI. Hot codeswap and live updates are often viewed as &amp;#8220;boring problems&amp;#8221; but are vital to real world deployments. Space usage must be paid attention to: how long can a given JVM stay up without leaking? Serialization is important to persist data across versions. If we&amp;#8217;re going to use &amp;#8220;esoteric control structures&amp;#8221; like CallCC, tailcalls or tags, the JVM isn&amp;#8217;t going to get us there.&lt;/p&gt;
&lt;p&gt;These days, if you can&amp;#8217;t stay in your local cache, you will lose several orders of magnitude performance&amp;#8230; you&amp;#8217;ll need directly connected CPU (or SSD!) memory, and static initalization, and language interop (eagerly vs laziness). Functional data structures and immutable collections are still immature, but need more work to convince doubting Thomas&amp;#8217; about their scalability in real applications.&lt;/p&gt;
&lt;p&gt;Hardware support for these are important. Intel Haswell has hardware transaction support (hence can be used by Azul JVMs etc) but we need more for functional langauge performance. There have been $2bn put into speeding up the JVM to make it as fast as C++. Google has a technology called Pinnacle which uses software write barriers that use VMs that execute directly, with a register model and not a stack model (which is easy to put together but hard to make fast). The new generation of language VMs will support direct execution and support modern functional programming languages.&lt;/p&gt;
&lt;p&gt;&amp;#8220;We all love types&amp;#8221; &amp;#8212; Dave on objects, but not variables (&amp;#8220;its easy to be cooperative with that definition!&amp;#8221;). Pluggable types by Gilad are really cute, because they move us towards a world where particular features (Dave likes behavioural types) can be woven in. Perhaps can be done in a dependently typed world. Another good candidate are approximate types and dimensional types. When all these are put together though, it all needs to fit together with sound compositional semantics.&lt;/p&gt;
&lt;p&gt;When using an interesting PL, Dave wants warnings to be emitted when the compiler makes space/time tradeoffs so that the programmer can decide between elegance and performance (also mentioned that Haskell programmers do this for .&lt;/p&gt;
&lt;p&gt;How does language evolution work? Arthur Whitney maintains K, and he ensures that every version of K is incompatible with the previous one. This is a blessing (!) since it avoids a kitchen sink language and ensures a high quality set of libraries. Quite often there&amp;#8217;s a tussle between languages and libraries because there&amp;#8217;s not enough coevolution. For example, are closures in Java really useful for the tradeoff in the complexity of the VM? Perhaps we should be looking towards a collection of small correct languages instead of a few partly right and largely wrong languages such as Ada or Java (the Java hate is strong here &amp;#8212; editor).&lt;/p&gt;
&lt;p&gt;Those of us that have programmed in vector languages (going back to APL) are largely write once read once languages because the code is so hard to read. One trick Dave does with K is to annotate comments inside expressions and use cold-folding without a point-free style to understand vector codeflow better. Also seeing the environment and current name bindings is extremely useful for teaching new languages.&lt;/p&gt;
&lt;p&gt;The real problem is: comprehensions, folds, monads &amp;#8212; WTF? Yet to see anyone from the monad community give a talk to understand monads. It&amp;#8217;s typically &amp;#8220;you dont need monads&amp;#8221; and then the word is used multiple times in the talk. If it&amp;#8217;s not important, why mention it so often? Quite often, the FP experience makes normal programmers feel stupid because they don&amp;#8217;t break through this terminology barrier. We as a community need to help people break through the barrier of not being formally trained in mathematics for whatever reason (&amp;#8220;category theory for breakfast?&amp;#8221;) and *be productive* in FPs.&lt;/p&gt;
&lt;p&gt;Smalltalk was like this in the early days. People see a blank window and aren&amp;#8217;t sure what to do next. Objects irritated people when they came out, but FP scares people. This is a danger as we go through and wow people with what we can do, but make it look like magic. People change their habits are different rates and we need to understand that. With Haskell, it was odd that he had to get the program &amp;#8220;right&amp;#8221; (or right/wrong) before it work, as opposed to not working.&lt;/p&gt;
&lt;p&gt;Bill Buxton (UI researcher friend) pointed out that people can&amp;#8217;t much get beyond programming a VCR. 4GLs were pretty much their limit. Dave&amp;#8217;s done a lot of work on evangelizing Smalltalk, but feels it was still too hard. People just didn&amp;#8217;t understand how to separate behavior, as the best practices on how to build objects were foreign to most of them. This all settled on some mix of SQL and some glue code, which doesn&amp;#8217;t require learning a lot of new technologies.&lt;/p&gt;
&lt;p&gt;Given there are many different types of programmers, do they all really need the full power of FP? Some subset of features is more useful, with one way to do things that doesn&amp;#8217;t change from release to release. For example, a simple dictionary keeps changing from Hashmap to concurrent Hashmap to something else, but ultimately is still a dictionary. How do we separate the reasoning over performance and structure and not scare people with both at the same time. Knuth started doing this decades ago with literate code, and we *still* dont have a decent way of writing documentation and code in the same place.&lt;/p&gt;
&lt;p&gt;We are still missing a pure FP book that is built in the same style and comprehension as &lt;a href=&quot;http://mitpress.mit.edu/sicp/&quot;&gt;SICP&lt;/a&gt;. We need thinks that you look the code and represent things more densely (for example, why don&amp;#8217;t we use Unicode in the same style as APL symbols to increase the succinctness?). They are working on J programs that move glyphs around on the iPad as an example of this 4GL density.&lt;/p&gt;
&lt;p&gt;We need to take all these ideas and *talk more* about metaphors in FP. Where&amp;#8217;s the &amp;#8220;Scala, F#, Clojure, the good parts&amp;#8221; and a frank exposition about the antipatterns? Don&amp;#8217;t lie about where the dragons are, but colour code them appropriately to not surprise programmers.&lt;/p&gt;
&lt;p&gt;We need to understand how to design with types. In the vector languages, this is called &amp;#8220;shape shifting&amp;#8221; as they don&amp;#8217;t have types, but similar concept. It&amp;#8217;s also hard to get the community people to talk about shape shifting, and as a result the art is being lost in the new generation of languages. For FP, can the Yodas in the audience help their audience to &amp;#8220;trust the types&amp;#8221; ?&lt;/p&gt;
&lt;p&gt;Q: In the top 20 languages, every language has a free-or-open-source runtime. This will make a huge difference as it lets people experiment.&lt;/p&gt;
&lt;p&gt;A: It&amp;#8217;s not been a barrier in experimentation for Dave, but it has been a barrier for commercial use. Dave would not attribute a particular significance to open source as it&amp;#8217;s never been a real problem for him (using trial versions and so forth). Open source is a mixed sword, as it tends to product impoverished language teams that don&amp;#8217;t have enough resources to move forward. The really good virtual machine implementors are commercially polished (c.f. the $2bn behind the JVM performance from earlier). Clojure is a great example where they appealed to the community to pay on their own behalf to donate for a production version. To build a serious production PL, you need a lot of government research money or a major commercial sponsor.&lt;/p&gt;
&lt;p&gt;Q: Marius asks about mobile and embedded and why FP hasn&amp;#8217;t cracked it.&lt;/p&gt;
&lt;p&gt;A: they are often late to the game, and it&amp;#8217;s often not easy to target the runtimes with a high performance runtime. You have to be willing to understand the interface.&lt;/p&gt;
&lt;p&gt;Q: Phil Walder says the scariest thing is that if you become a success, then Smalltalk takes the form of C++&lt;/p&gt;
&lt;p&gt;A: (or Java!). Being able to maintain the independence of the language creators vs a major player is crucial to conceptual integrity. (Phil) Tools that will migrate between version X and Y and a sustainable ecosystem. It&amp;#8217;s important to ensure that the creators get paid to maintain &amp;#8212; even the JVM only has 10-20 people in the core team and a vast ecosystem.&lt;/p&gt;
&lt;h3&gt;OCaml at Facebook via the Hack language&lt;/h3&gt;
&lt;p&gt;Julien Verlauget is talking about how Facebook is adopting OCaml.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/1148380_10151682552766094_1789859397_n.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1458&quot; alt=&quot;1148380_10151682552766094_1789859397_n&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/1148380_10151682552766094_1789859397_n-300x225.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Why PHP is good: fast installation times, lots of libraries, easy to learn, and scales in a parallel way (multiple instances).&lt;/p&gt;
&lt;p&gt;However, Facebook doesn&amp;#8217;t care about any of these features. What Facebook wants is a fast feedback loop between writing code and having it appear on screen. There&amp;#8217;s no good way to write a unit test for an experience, and instead a fast feedback loop between code and a live site is how people still work at Facebook today.&lt;/p&gt;
&lt;p&gt;Performance at the scale of Facebook really matters. 1% can be a huge bump, but PHP is really hard to optimize due to all the dynamic features in the language. Aside from runtime performance, the other concern is development time for engineers, who need to avoid security problems and general bugs in an incredibly large codebase.&lt;/p&gt;
&lt;p&gt;The first attempt at this was to scale the runtime via HipHop. The first attempt was to compile PHP into an interpreter (via sandboxes) and then compile production code to C++. Unfortunately this lead to a huge divergence in performance characteristics between the interpreter and compiled code which led to confusion in production.&lt;/p&gt;
&lt;p&gt;The current one is HHVM which is a combined model via JIT runtime that patches code at runtime and helps merge these models.&lt;/p&gt;
&lt;p&gt;HHVM is still a PHP platform, and a new model called Hack provides a *new programming language* that targets HHVM (which is essentially a PHP runtime).&lt;/p&gt;
&lt;p&gt;Hack is a &lt;b&gt;statically typed language for HHVM&lt;/b&gt;. It&amp;#8217;s compatible with PHP and interoperates with no overhead and has the same runtime representation as PHP. It has evolved from PHP, and so if you know PHP, you know Hack. It&amp;#8217;s designed for &lt;i&gt;incremental adoption&lt;/i&gt; via introducing gradual typing (c.f. keynote talk about not scaring programmers not used to types).&lt;/p&gt;
&lt;pre&gt;function foo(): void {
  $x = 'hello';
  return $x;
}&lt;/pre&gt;
&lt;p&gt;This returns a readable error message in the style of a statically typed language, since the inference algorithm keeps a witness about every value&amp;#8217;s type and shows counter examples.&lt;/p&gt;
&lt;p&gt;The Hack type system must be annotated with class members, function parameters and return types. Everything else is inferred to minimize programmer burden.&lt;/p&gt;
&lt;p&gt;Hack types include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Nullable such as
&lt;pre&gt;?int&lt;/pre&gt;
&lt;p&gt;mainly because of the huge code base that had no pattern matching, so null propagation is important&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Tuples&lt;/li&gt;
&lt;li&gt;Closures&lt;/li&gt;
&lt;li&gt;Collections such as
&lt;pre&gt;Vector&amp;lt;int&amp;gt;&lt;/pre&gt;
&lt;p&gt;that have generics too&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;Constraints&lt;/li&gt;
&lt;li&gt;Type Aliasing&lt;/li&gt;
&lt;li&gt;Extensible Records&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Demo of a simple mailbox demo follows. HH has a command line mode that lets you syntax highlight which parts of the source code are dynamically checked, by outputing the code with red if it&amp;#8217;s potentially unsafe. Awesome!&lt;/p&gt;
&lt;pre&gt;class Mailbox {
  private $data;
  public function send($data) {
    $this-&amp;gt;data = $data
  }
  public function fetch() {
    return $this-&amp;gt;data;
  }
}&lt;/pre&gt;
&lt;p&gt;(very PHP like but now he annotates it with specific types)&lt;/p&gt;
&lt;pre&gt;class Mailbox {
  private string $data;
  public function send($data) : void {
    $this-&amp;gt;data = $data
  }
  public function fetch() : string {
    return $this-&amp;gt;data;
  }
}&lt;/pre&gt;
&lt;p&gt;As a programmer, I now want to know if this has all been statically checked (since the previous checking mode showed several red sections which were potentially unsafe). He runs the compiler with a strict mode that rejects the source if there is any unsafe bits.&lt;/p&gt;
&lt;p&gt;He then demonstrates how to propagate null types through the code, and then introduces several subtle errors that are all caught.&lt;/p&gt;
&lt;p&gt;An audience members asks what happens if you send both an int and a string to a mailbox, and Julien demonstrates a &amp;#8220;mixed&amp;#8221; type that covers both (is this some sort of row polymorphism? &amp;#8212; editor).&lt;/p&gt;
&lt;p&gt;The response time of the type checker is close to instantaneous (for the developer loop). Even with a thousand files, the type checkers gets back in a second or less with an error message.&lt;/p&gt;
&lt;p&gt;To get the tooling right, Hack uses js_of_ocaml to compile &lt;i&gt;the entire OCaml type checker&lt;/i&gt; to Javascript and then run in a complete web-based IDE (demonstrates a full cloud9-like IDE they use internally at FB). To work at scale, they created a server that runs persistently in the background and type checks all the files and responds from a memory cache.&lt;/p&gt;
&lt;p&gt;At scale, the the autocomplete requires very lowlatency in the webbased editor, and users also use version control (e.g. switching between branches). The server also has to use a reasonable amount of RAM and have a reasonable initalization time. Fundamentally it has to be stable as developers have to depend on their tools.&lt;/p&gt;
&lt;p&gt;A vast amount of code is written in OCaml for the tools. Good choice because it is ideal for symbolic computation, excellent performance and can be compiled to Javascript. Good C interop is really good. The main challenge is the lack of multicore, although Facebook works around it with their multiprocess architecture.&lt;/p&gt;
&lt;p&gt;Architecture: the master process has multiple processes which uses shared memory to avoid having to go through the master. The underlying buffers are lock free (similar to our Xen shared memory ring! &amp;#8212; editor).&lt;/p&gt;
&lt;p&gt;Advice on OCaml at scale:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IPC &amp;#8212; use lockfree structures and think about sockets/pipes instead of just TCP&lt;/li&gt;
&lt;li&gt;GC small heap and shared memory is compacted by master&lt;/li&gt;
&lt;li&gt;OCaml makes you think hard about shared objects, which is a good thing.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Q: is it open source??&lt;br /&gt;
A: soon, this is the first time Facebook has talked about it publically.&lt;/p&gt;
&lt;h2&gt;OpenX and Erlang ads&lt;/h2&gt;
&lt;p&gt;What is OpenX: (i) An opensource PHP ad server (ii) OpenX is a global company with an ad service featuring a big ad exchange written in Erlang. This talk is about the transition from PHP to Erlang.&lt;/p&gt;
&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo-1.jpg&quot;&gt;&lt;img class=&quot;size-medium wp-image-1401 alignright&quot; alt=&quot;photo 1&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo-1-300x300.jpg&quot; /&gt;&lt;/a&gt;
&lt;p&gt;1998-2007. it was a conventional PHP management system and MySQL. The company started using it as an EC2-based SaaS ad server and serving up clients successfully.&lt;/p&gt;
&lt;p&gt;In 2008, they wanted to mix in an ad exchange, to add liquidity to marketplaces that have empty ads. At the same time, they moved offices to Pasadena and looked at new tech. Switched to Hadoop (Java) and Postgres (for some reason). Poor technical choices were made, such as writing to the database for every request (sometimes multiple times!).&lt;/p&gt;
&lt;p&gt;In 2009 as the customers increased, there was a big push to scaling things up for performance (this is when the speaker joined the company). Switched Postgres to Cassandra to move from a relational database to a more NoSQL approach that had the appropriate consistency properties. At this time, the architecture was also decomposed to give them headroom to scale for a while, particularly by adding HTTP load balancers and so on.&lt;/p&gt;
&lt;p&gt;They wanted to add even more low latency stuff, such as spot bids for immediate bids on empty slots. Anthony decides that the model was a good fit for Erlang, since one request needed to fan out to multiple backend services with a soft-realtime limit to return a response to the user. It took a few months to prototype an Erlang based solution which worked very well.&lt;/p&gt;
&lt;p&gt;After this first experience with Erlang and evangelising it, and pointing it out to his coworkers, they came up with another good problem: analyzing the frequency of how often someone looks at an ad. This required a new database that would hold bespoke data efficiently, and also integrated Riak from Basho to interface with the database to run the query engine. This now holds on the order of billions of keys.&lt;/p&gt;
&lt;p&gt;In 2007, they ran into problems with Cassandra due to making an incompatible upgrade which would have required OpenX to shut down their business to upgrade, which was unacceptable. Since they had a good experience with Riak core, they developed a new system to move away from Cassandra and add more Erlang for management stack.&lt;/p&gt;
&lt;p&gt;In 2011, they decided to split their UI layer into a more Web 2.0-like UI API. The API continues to be implemented in PHP (with a Javascript UI clientside), but the Erlang evolution continued with a gateway service and marketplace service that are both pure Erlang. The basic problem is ad selection, and the logic for this is written as a DSL implemented in both Erlang and Java to enable code reuse across the tools.&lt;/p&gt;
&lt;p&gt;However, Cassandra was still sticking around, and they wanted to move away from it. They implemented a data service layer to abstract away from the database. From the early days, they made a bad (but fast) choice to have clients directly call Cassandra via Thrift, as it was easy. They moved away to a more abstract model to get away from Thrift, and so could change clients. The new system could call both Cassandra and Riak to help evolve with both services running simultaneously and provide a &lt;i&gt;seamless migration path&lt;/i&gt; to the new service (in stark contrast to the Cassandra upgrade story from earlier).&lt;/p&gt;
&lt;p&gt;They also decided that the PHP use for the API was a bad idea, and so switched to Python. They engaged Erlang Solutions to write them an API router since their core team was busy (an example of external consultants coming in and being useful &amp;#8212; editor). The current system involved RabbitMQ coordination, and Riak&amp;#8217;s replication logic to move out to the colos for publication.&lt;/p&gt;
&lt;p&gt;Currently they have 14-15 services in Erlang 7-8 in Java, and a blend of Python/PHP.&lt;/p&gt;
&lt;p&gt;How did a PHP shop end up with so much Erlang? Well, they laid off all the PHP developers when they moved offices (lots of audience laughter).&lt;/p&gt;
&lt;p&gt;More seriously, the architectural choices are important:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cloud based (generic hardware, automated bootstrap, deployment, package oriented development and fault tolerance).&lt;/li&gt;
&lt;li&gt;Service based (loosely coupled, single purpose components, pools of components, polyglot so multiple languages/&lt;/li&gt;
&lt;li&gt;Cross language tools: Thrift (RPC between components), protobuf (RTB and Riak) and &lt;a href=&quot;http://www.lwes.org&quot;&gt;Lwes&lt;/a&gt; (logging and monitoring) which was open sourced by Yahoo after being originally written at Goto.com. A system called Framework that provides templates for code layout, builds RPMs/debs and integrates with autotools. It enforces versioning and reproducibility across languages.&lt;/li&gt;
&lt;li&gt;Finally, evangelism is really important. If possible fix the game via architectural choices to set the scene for change. Find a project to showcase the technology, and be responsible for the project&amp;#8217;s success. Make sure to share work, and remember that tools are &lt;i&gt;really important&lt;/i&gt; to make it easy for others to use.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Really important is figuring out build toolchain &amp;#8212; it can be so arcane. They did spend time on integrating with Erlang (erlrc inegrates with packaging system, erlstart to manage lifecycle, erlnode for ?).&lt;/p&gt;
&lt;p&gt;Hiring: train people rather than trying to hire knowledgeable. Operations have unfamiliar systems to manage, and developers have new concepts and patterns.&lt;/p&gt;
&lt;p&gt;How did Erlang help OpenX developers? The language fit the service model very well. The let-it-crash philosphy and supervision trees led to fewer real service outages.&lt;/p&gt;
&lt;p&gt;OpenX is doing really well as a business, too: 250+ billion monthly transactions, 12+ billion daily bids, thousands of machines in 5 colos, 300 employees and $150m+ revenue in 2012.&lt;/p&gt;
&lt;p&gt;Q: Marius: with a service based solution, how do you library them up?&lt;br /&gt;
A: Their services aren&amp;#8217;t hugely fine grained and so usually a module or two (not a lot of state)&lt;/p&gt;
&lt;p&gt;Q: Anil: is framework usable from languages? RPM integration seems killer&lt;br /&gt;
A: It&amp;#8217;s still esoteric and internals not docced, but would welcome a chat!&lt;/p&gt;
&lt;h3&gt;BAE systems on Redesigning the Computer for Security&lt;/h3&gt;
&lt;p&gt;Tom Hawkins speaking on DARPA funded project.&lt;/p&gt;
&lt;p&gt;SAFE is a codesign of:&lt;br /&gt;
a new application langauge (breezE)&lt;br /&gt;
a new systems programming language (Tempest)&lt;br /&gt;
A new OS&lt;br /&gt;
A new processor&lt;br /&gt;
and security at every level for defense in depth.&lt;/p&gt;
&lt;p&gt;Emphasising hardware enforced security since dynamic checking is too much overhead in software, for example for fine-grained information flow control. Hardware IFC handles the most general attack model (scripting down to machine code injection).&lt;/p&gt;
&lt;p&gt;Hardware overview: every word of data contains a tuple of (group 5 bits, tag 59 bits and payload 64 bit). The Atomic Group Unit checks atom typs (e.g. instructions, data pointers and streams). The Fat Pointer Unit (confusingly, FPU) checks pointer operations, and tag management unit (TMU).&lt;/p&gt;
&lt;p&gt;The label model can be used for efficient hardware typing, and more recently they are using labels for Control Flow Integrity (e.g. to prevent return oriented attacks). Register file is 32 elements deep, memory is accessed through load/store, and every bit of data in the system is a well-formed atom (and so has tag/groups associated with it).&lt;/p&gt;
&lt;p&gt;FPU deals with buffer range checks (e.g. underflow or overflows for a buffer).&lt;/p&gt;
&lt;p&gt;The TMU is where the magic is. It combines all the operations from the various operations being worked on (instructions, memory) and the TMU acts as a &amp;#8220;database&amp;#8221; checking that the operation is consistent with local policy, and the machine can continue execution or raise a security exception.&lt;/p&gt;
&lt;p&gt;At day 1, they had an outline for an ISA but nothing else. TIARA project was a baseline (Howie Shrobe, Andrw DeHon, Tom Knight) and they had no languages, no hardware and no toolchain.&lt;/p&gt;
&lt;p&gt;They started by sketching out an assembly language and then building an ISA simulator. They simulated simple assembly programs, and HW researchers started coding in Bluespec (a Haskell-like FP that Lennart keynoted about at CUFP 2011 in Japan).&lt;/p&gt;
&lt;p&gt;The PL researchers started designing Breeze. Plan was to &amp;#8220;steal&amp;#8221; Andrew Meyers work on JIF, and &amp;#8220;Breeze should be done in a couple of months&amp;#8221;!. It didn&amp;#8217;t quite work out that short (laughter).&lt;/p&gt;
&lt;p&gt;SAFE assembly is as low level as expected, but it adds some new properties:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;frames manage fat pointer bounds&lt;/li&gt;
&lt;li&gt;Atomic group declarations on data mark critical sections&lt;/li&gt;
&lt;li&gt;Tags on data can be marked (e.g. bootloader private)&lt;/li&gt;
&lt;li&gt;Secure closures is code/data with the authority to run code over the data (they call it gates)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Assembly is tedious and so they started with macros. The Breeze interpreter is now running and there was pressure to start building the compiler. The OS guys wanted a language to build the higher level components.&lt;/p&gt;
&lt;p&gt;Solution: a SAFE assembly DSL embedded in Haskell that uses Haskell as the macro language and becomes the library for the future Breeze compiler.&lt;/p&gt;
&lt;p&gt;Breeze Language: version 7 &amp;#8212; just the datatypes for Booleans was hard and took 4-5 weeks (&amp;#8220;this IFC stuff is kind of tricky&amp;#8221;). The convenience and modularity of lexical authority passing and one-principal per module is extremely inconvenient!&lt;/p&gt;
&lt;p&gt;SAFE Assembly in Haskell looks like a typical EDSL. A monad captures program descriptions, and macros set up data tags and also for better control flow (such as a while loop or ifelse conditionals in the asssembly).&lt;/p&gt;
&lt;p&gt;At Year 1.5, the EDSL is still assembly language, no matter how many macros there are. Manual register allocation, calling conventions and data structures. Meanwhile the Breeze compiler was inching off the ground, but there is an awkward transition from high level CPS IR to assembly. There needs to be an intermediate form somewhere. However, the SAFE EDSL in Haskell works great in the compiler backend plugged in seamlessly with the Breeze code generator, which was nice.&lt;/p&gt;
&lt;p&gt;Breeze Language is now on Version 12 and continues to answer questions. &amp;#8220;What do we do on an access violation?&amp;#8221;. Simply stopping the machine isn&amp;#8217;t enough, since &amp;#8220;What if I maliciously send you data that you can&amp;#8217;t access?&amp;#8221;. &amp;#8220;Simple I&amp;#8217;ll just check the label before I attempt to read it?&amp;#8221;. &amp;#8220;But what if the label itself is private?&amp;#8221;. This was the big &amp;#8220;aha&amp;#8221; moment in IFC, since private labels end up being a poison pill in IFC.&lt;/p&gt;
&lt;p&gt;At Year 2.0, the Breeze compiler is going through a major overhaul since it needs improvements (the middle IR is improved but not enough). They temporarily shelve the compiler and they realize it wont come to the rescue of the OS. They really needed a higher low-level language than just assembly.&lt;/p&gt;
&lt;p&gt;Breeze language v23 has a solution to poison pills: make all labels public! To label data you must specify the label in advance (brackets), but public labels are not compatible with lexical authority passing so they had to relax their original vision a little.&lt;/p&gt;
&lt;p&gt;Year 2.5: Tempest is started as the systems PL for SAFE. Imperative with register allocation and optimizations and control of assembly with inlining and user specified calling conventions. It uses the SAFE EDSL to generate assembly (that was a successful DSL) and nicely fills the Breeze IR gap in the compiler for when that is resurrected.&lt;/p&gt;
&lt;p&gt;Breeze language 34: delayed exceptions with not-a-value values (Nav).&lt;/p&gt;
&lt;p&gt;The Tempest EDSL with inline assembly has a SAFE assembly sublanguage. The SAFE flow isnow the Breeze, Templest and Safe Assembly layers, with EDSLs of each gluing the compiler pipeline together. There is a SAFE ISA simulator and debugger, along with a Bluespec simulator to save on the FPGA debugging cycles. The TMU is an elaborate piece of hardware (an exotic CAM and cache structure) that a lot of the effort has gone into.&lt;/p&gt;
&lt;p&gt;Lessons learnt:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;designing a higher order IFC language is &lt;i&gt;very hard&lt;/i&gt; even with some of the most brilliant PL researchers in the world. Optimal number of researchers is 2-7 rather than any more :) Ben Pierce and Greg Morrisett arguing over very hard problems was a lot of fun in a hard problem space.&lt;/li&gt;
&lt;li&gt;Day 1 should have started with Tempest, not assembly. Hard to be productive with assembly code, and tempest is the right level of runtime/processor codesign. Level of indirection provides insulation from a changing ISA.&lt;/li&gt;
&lt;li&gt;EDSLs are great for bootstrapping a language and make excellent backend libraries. However, engineers must be comfortable with the host language and not all the engineers were comfortable with Haskell when they started. EDSLs are hard to debug (line number information apparently hard to get out of error messages vs a concrete syntax).&lt;/li&gt;
&lt;li&gt;Concrete syntax is more relevnt for some languages than others (e.g. Tempest vs SAFE assembly). The best transition point to a concrete syntax is after developer pressure for modular programming. Once language has modularity, then the switch can be made without disruption.&lt;/li&gt;
&lt;li&gt;Would a DSL have helped hardware design? Forever debugging ISS and FPGA instead of raw Bluespec. A DSL describing ISA semantics would have kept is synchronized by generating Bluespec, ISS and SAFE EDSL and Coq documentation.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This has been a huge project spanning a vast number of layers. It has produces a large number of interesting &lt;a href=&quot;http://www.crash-safe.org/papers&quot;&gt;papers&lt;/a&gt; including one at ICFP this week on testing non-interference quickly by using QuickCheck to generate programs that don&amp;#8217;t violate non-interference properties.&lt;/p&gt;
&lt;h2&gt;FRP at Netflix by Jafar Hussain&lt;/h2&gt;
&lt;p&gt;Netflix used to have tight coupling between the middle tier and the UI teams. One-sized fits all messages and led to inefficient call patterns.&lt;/p&gt;
&lt;p&gt;The plan was to decouple this by giving UI developers the ability to decouple components (or &amp;#8220;force!&amp;#8221;).&lt;/p&gt;
&lt;p&gt;Two developer personas at Netflix: Cloud and UI people. Netflix deals with a third of all US broadband traffic, so they need to think at scale but also to run on really tiny cheap devices that eke out all performance. How do they turn UI developers into effective cloud developers who think at scale?&lt;/p&gt;
&lt;p&gt;Gave them UI comforts: Groovy, OO API and a Reactive API. Most UI developers (or indeed any developers) can&amp;#8217;t be trusted with locks. This means that reactive programming isn&amp;#8217;t enough, which leads to &amp;#8220;how do we make parallel programs safe for developers&amp;#8221;&lt;/p&gt;
&lt;p&gt;Enter Erik Meijer, the legend himself! He asked &amp;#8220;Whats the difference between a database query and a mouse drag event?&amp;#8221;. Database would use functional code and a mouse drag might be imperative. Erik points out that they are both collections.&lt;/p&gt;
&lt;p&gt;New JS closure syntax in ES6 is fantastic to make them easier to use. If you imagine a query for well-rated movies, then you need to map over video lists. He then shows a mouse drag event, but points out that the structure of the code is very simpler. Instead of a &amp;#8220;filter&amp;#8221; operator, he uses &amp;#8220;takeUntil&amp;#8221; which stops the operation after some predicate has been satisfied.&lt;/p&gt;
&lt;p&gt;The iterator pattern is similar to the observer, except for the bidirectional signalling. Iterators can throw next/hasNext/Throwable, but Observers dont have a similar completion semantic. What happens when we add these to the Observer? We end up with &amp;#8220;onNext&amp;#8221; and &amp;#8220;onCompleted&amp;#8221; and &amp;#8220;onError&amp;#8221;, so now the Observer has comparable semantics to Iterator, so the only thing that changes is the direction of the errors.&lt;/p&gt;
&lt;p&gt;Some platforms also have an Iterable. There is now also an Observable to which you can pass an Observer, in the same vein as passing an iterator to a Java Iterable. We also add a Disposable to both, so that when the IO stream has terminated, it can be stopped immediately without having to junk the rest of the data.&lt;/p&gt;
&lt;p&gt;Erik and his team at MSR demonstrated that these patterns are dual, so that Iterable and Observable are dual! These are the Reactive Extensions libraries that is a combinator library for the Observable type. It&amp;#8217;s open source and has been ported to a number of other languages than C# (including Java).&lt;/p&gt;
&lt;p&gt;Observable Monad is a Vector version of the Continuation monad. Null propagation semantics of the Maybe monad and Error propgation semantics of the Either monad. Produced and consumed with side-efects and acts as a fault line between pure and impure code. It can be composed functionally and cancellation semantics are clean. It can be synchronous or asynchronous which is a common mistake (to assume that Iterable is async &amp;#8212; either can also be sync simply by calling the functions immediately).&lt;/p&gt;
&lt;p&gt;If you Map over Observable, then&lt;/p&gt;
&lt;pre&gt;(rapid transcript)
var map = (observable, func) =&amp;gt;
  { forEach: observer =&amp;gt; 
    {
    var subscription =
     observable.forEach
       onNext : item =&amp;gt; oserver.onNext(func(item))
       onError : error =&amp;gt; observer.onError (error)
       onCompleted () =&amp;gt; observer.onCompleted()&lt;/pre&gt;
&lt;p&gt;We can use this to come up with a single reactive type for cloud and UI developers! Jafar demonstrates example of social notifications in the middle tier, but using Observable to filter notifications from a composition of the socialService and messageService. Both underlying services are returning observables, and are non-blocking and completely parallel. Both can execute synchronously or asynchronously and decide which knobs to turn for their particular scheduling needs. The programmer doesn&amp;#8217;t need to care about the details.&lt;/p&gt;
&lt;p&gt;Another example is search autocomplete, which is surprisingly hard. Need to decide how often to send requests (throttle them to be not per-key) and also deal with concurrent responses from keypresses coming in out of order.&lt;/p&gt;
&lt;pre&gt;var res = 
  keyPresses.throttle(20).flatMap(
    search =&amp;gt; 
      getSearchResults(search).takeUntil(keypresses));

res.forEach(resultSet =&amp;gt; listBox.setItems(resultSet)&lt;/pre&gt;
&lt;p&gt;This code fragment does all this composably and handles all that logic. It&amp;#8217;s throttled, ordered correctly and terminates until the keypresses stop (with respect to the throttling policy.&lt;/p&gt;
&lt;p&gt;The full tier is a UI (huge amount of mutable state), dropping in to a distributed functional style, and heading into the data tier. Recall this is at huge scale.&lt;/p&gt;
&lt;p&gt;Wins: Rx is open sourced from MS and ported to Java (Observable) and generally better tooled now.&lt;br /&gt;
Evangelism comes up again since you can&amp;#8217;t assume the best technical solution will win. Practice public speaking and focussing on soft skills! Speaker got better in a short amount of time at distilling the essence of the benefits, and explaining to the target audience why something matters (e.g. to a UI developer vs a cloud developer as he explained earlier).&lt;/p&gt;
&lt;p&gt;Challenges: Training/Hiring. Netflix didn&amp;#8217;t fire all their UI developers as the previous speaker did (audience laughter). Instead, they leveraged their skills at eking out mobile performance, and taught them alternatives: functional programming, vector programming and reactive programming. Be available to help out people (developers work weird hours!) and interactive training exercises really help too. Also help them understand &lt;i&gt;when&lt;/i&gt; to apply each technqique for a particular programming task.&lt;/p&gt;
&lt;p&gt;Some of the Javascript programmers had some intuition for these techniques from things like Promises. It wasn&amp;#8217;t quite the right answer, as sometimes you need vector versions for performance instead (since it degenerates to a scalar version by passing a vector of size 1). Netflix dont bother teaching scalar, only vector.&lt;/p&gt;
&lt;p&gt;Although the programmers are used to mapreduce, the embedded version of this is a lot harder for them to grasp &amp;#8212; it&amp;#8217;s just a programming style and not just magic in Hadoop. Hiring process adapts to spot the competent functional programmer.&lt;/p&gt;
&lt;p&gt;bind/flatMap/concatMap/mapcat/mapMany are all monadic versions with subtle semantics and so they use interactive training exercises to train developers in their runtime semantics.&lt;/p&gt;
&lt;p&gt;Challenges: performance needs some chunking for lowend devices (vector a manually chunked scalar monad) and is best applied to less chatty event streams. It worked for search on lowend devices since it takes so damn long to type anything in, so a less chatty UI stream (audience laughter). &amp;#8220;We are screwed if the hardware UIs improve&amp;#8221;.&lt;/p&gt;
&lt;p&gt;Type-unsafe flatMap is easier to understand but needs to be used carefully, but is useful on lowend deviecs.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://github.com/Reactive-Extensions/RxJS&quot;&gt;http://github.com/Reactive-Extensions/RxJS&lt;/a&gt; has all the source, so give it a try!&lt;/p&gt;
&lt;p&gt;Q: How do Databinding in Rx?&lt;br /&gt;
A: No templates, but many other tiers before the view layer are bound together. We introduce an Observable with both pure and impure code (an Observable type with a value property). However they learnt how to do this directly since Observable&amp;#8217;s lazy default is the wrong for data binding. Implementing a different type that is strict and publishes the result directly.&lt;/p&gt;
&lt;h3&gt;Medical Device Automation using message passing concurrency in Scheme&lt;/h3&gt;
&lt;p&gt;What does a molecular diagnostic device do and what does Scheme have to do with all this?&lt;/p&gt;
&lt;p&gt;Detects the presence of specific strands of DNA/RNA in sample and then does necleic acid extractions and purification. Sample are excited using lasers as they undergo PCR which results in spectrographs.&lt;br /&gt;
Device contains 19 boards with temp, motor control with many parts that move simultaneously at very high precisions. (author shows demos of the motors running and playing music from the system!)&lt;/p&gt;
&lt;p&gt;Client is written in C# and WPF and is thin/stateless. Sever is written in Scheme and Erlang with OTP embedded. Supervision structure to isolate hardware failures. A DSL provides the glue logic.&lt;/p&gt;
&lt;p&gt;Scheme is exceptionally clear and simple syntax, and they love the hygeinic syntactic abstractions for their DSL and the first-class functions and continuations are key. Arbitrary precision arithmetic is important for result calculations.&lt;/p&gt;
&lt;p&gt;The Erlang embedding in Scheme is how they interop. They embed records by referring to structured data by field name instead of field index. This allows for copying a record and changing particular fields.&lt;/p&gt;
&lt;p&gt;There&amp;#8217;s no pattern matching built into Scheme and enables matching on all the usual datatypes (strings, lists, vectors and records). It also allows matching the value against a local variable and/or binding values to local variables in the pattern itself, which is new in Scheme (but quite ML-like? &amp;#8212; editor)&lt;/p&gt;
&lt;p&gt;Processes are on-shot continuations with software timer interrupts. The Gen-server patterns provide a functional way of serializing messages and mutating state. The init/handle-call/handle-cast/handle-info and terminate are all encoded, and so it&amp;#8217;s all done except code-change (the FDA wouldnt appreciate code changing on the fly!)&lt;/p&gt;
&lt;p&gt;The event manager is responsible for event logging and subscriptions, and supervisors monitor processes and execute a restart or clean shutdown semantic (with enough logging for a field debug cycle).&lt;/p&gt;
&lt;p&gt;How it works in the instrument server: &amp;#8220;let is crash&amp;#8221; throughout and a notable lack of defensive programming due to the actor model. They manage some big hardware which fails all the time and this architecture directly addresses that reality.&lt;/p&gt;
&lt;p&gt;Easy assay is executed via a DSL which defines the pipeline in a &lt;i&gt;confirm mode&lt;/i&gt; to estimate running time, suggest missing resources and warn about a lack of timeslots. Once satisfied this is all taken care of, the queuing is done via a Tetris-style binpacking heuristic. Each action has its own process for fault tolerance. The DSL exposes an option to ignore action failures which is important for test runs and debugging (also during hardware development).&lt;/p&gt;
&lt;p&gt;Some examples of device failures are very bad: &lt;b&gt;Therac 25&lt;/b&gt; was a RTOS that gave people fatal radiation doses. It was tracked down to bad use of mutable state and integer overflow (taken care of in their system with FP and arbitrary precision math). &lt;b&gt;Ariane 5&lt;/b&gt; was due to interger overflow due to conversion precision, which also doesn&amp;#8217;t happen in their Scheme system which has non-lossy conversion. And finally the space shuttle simulator crashed due to memory unsafety (a restart was unclean), which cannot happen in Scheme. The supervision hierarchy in Erlang/Scheme can handle crashes with a stable strategy at any layer.&lt;/p&gt;
&lt;p&gt;Why a DSL? The assay developers need to write their own recipes such as &amp;#8220;which recipes for this instrument, and in which order?&amp;#8221;. The scientists shouldn&amp;#8217;t need software engineers to help them work, so the DSL sorts that out. Mechanical engineers need to check reliability and timing/variability on the hardware, which they can do by configuring DSL parameters.&lt;/p&gt;
&lt;p&gt;There are a few bits to the DSL: an extraction/purification language (tip loading, pipetting, moving magnets) and the protocol language (aspirating, dispensing, etc) and finally the motor language.&lt;/p&gt;
&lt;p&gt;Shows an example of the PCR language, which is a complex recipe involving baking, thermal cycling in loops. The DSL follows the logic flow of the English language version of the recipe very closely (with more brackets).&lt;/p&gt;
&lt;p&gt;Wrote a web server that supports HTTP requests and JSON/jQuery and an sexpression-based HTML code generator. Can render pages with Scheme logic and render to webbrowsers. Use by engineers for debugging and prototyping without having to touch the real UI, and non-engineers use it to map data sources from instruments into JSON (which can be fed into validation tools, for example to send to the FDA for regulation).&lt;/p&gt;
&lt;p&gt;Lessons learnt:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Message passing is great but not a silver bullet. Gen servers can deadlock between each other despite being deadlock free internally. Timeouts in genservers and supervisor logging makes this possible to catch at a higher level, which is crucial!&lt;/li&gt;
&lt;li&gt;Not much on the web about a design pattern for the supervisor structure, so they had to pioneer it (didnt really want to pioneer it though)&lt;/li&gt;
&lt;li&gt;Automated unit test frameworks also built by them by hand&lt;/li&gt;
&lt;li&gt;Hiring remains hard into this unique environment.&lt;/li&gt;
&lt;li&gt;Existing quality metrics like bug density are problematic, since Scheme is terse and so looks artificially worse than more verbose languages!&lt;/li&gt;
&lt;li&gt;FDA has more scrutiny into this system since this is different from the usual C/C++/C# codebases and also the large number of open source tools such as Sqlite/Emacs/git. Unique to this regulated problem space of course.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Message passing concurrency makes reasoning about semantics of concurrent process easier, ass well as debugging problems via fault isolation. Let-it-crash leads to shorter, less defensive code with fewer branch points and test cases. Strong typing and runtime checks provide cognizant failure instead of silent corruption (crucial to avoid in this medical space).&lt;/p&gt;
&lt;p&gt;Mixing languages has been nice, since they can pick the good bits of Scheme (macros, arbitrary precision math) and Erlang (OTP). DSLs provide the glue here, and rapid prototyping for non-expert software developers.&lt;/p&gt;
&lt;h2&gt;Gilt and Scala microengines&lt;/h2&gt;
&lt;p&gt;Clothing group, and they need to customize the website with per-user targetting. The customer facing stuff is the tip of the iceberg with a bunch of backoffice features that need to be plumbed through. The traffic patterns are all about flash traffic that spike massively during sales, and if they go down in these times they lose lots of money.&lt;/p&gt;
&lt;p&gt;Gilt is about six years old, and it was built as a Rails app in the beginning that was quite large. It had unclear ownership, complex dependencies, lengthy test cycles, and unexpected performance impacts from small changes. Rails encourages to &amp;#8220;throw everything into one directory &amp;#8212; a thousands models in one directory&amp;#8221; which is really unscalable as the number of engineers grew. Some bad production issues came out of this problem.&lt;/p&gt;
&lt;p&gt;Then they started to transition to microservices by transitioning a few core critical pieces into microserviecs such as inventory management. The number of services grew to over 300 services in just 4 years (each HTTP microprotocols), all built using Scala. They developed an architecture to support this sort of growth of microservices.&lt;/p&gt;
&lt;p&gt;Cornerstones of infrastructure (goal==cool stuff for customers!)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;b&gt;Build system:&lt;/b&gt; SBT is a &amp;#8220;simple build tool&amp;#8221; which then turned into &amp;#8220;Scala build tool&amp;#8221; due to its complex mental model. Configuring everything correctly can be tricky if you have a number of dependencies. Gilt wanted to abstract developers from this so they could focus on writing appliction code. They solved it via a large SBT plugin that takes care of dependency management that provides a standardized configuration for everything.&lt;br /&gt;
A complete build specification is shown which is very succinct: it just has a combinator for adding dependencies. Behind the scenes, the plugin provides a huge amount of support (testing, rpms, dependency, continuous builds, and many more)&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Configuration&lt;/b&gt; is handled by a Zookeeper cluster and can be overridden with local files or system properties. It&amp;#8217;s mapped into strongly-typed classes in Scala and validated via Hibernate so that configuration must match up with service expectations.&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Testing&lt;/b&gt; is the most challenging part of a microservice architecture. Functional tests are the gold standard, but hard for developers to run 300 services on their local laptops. Unit tests can run locally, but there&amp;#8217;s no mocking service for these (and overmocking results in useless testing that in non representative). They use the Cake pattern for dependency injection, which enables type-safe and scalable composition. It uses Scala&amp;#8217;s self-types and multiple trait inheritance. Things like object repositories or configuration providers can be expressed in this way. The pattern lets them mixin different sources and weave in real/mocked sources.&lt;b&gt;UI Testing&lt;/b&gt; is handled via Selenium and is built on ScalaTest. Automated browser testing with reusable components works well, and leverages Scala&amp;#8217;s type system well to reject invalid tests/code/configuration.&lt;/li&gt;
&lt;li&gt;Continuous Delivery lets them deliver 20 to 30 service versions every day using the aforementioned structures&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Some cool stuff: on their website, there are badges on their website showing inventory for each item. The inventory badges update in realtime as you look at the page, which really motivates people to buy as they spot inventory dropping down. Shoppers get excited and feel like they&amp;#8217;re in a Black Friday sale and are engaged in the shopping activity! Building this stuff was quite easy to do using event-driven Play application and Akka actors.&lt;/p&gt;
&lt;p&gt;They build on this for &amp;#8220;freefall sales&amp;#8221;. Essentially a Dutch auction and is also web sockets and Play based. It initiates a sale that lasts for a fixed time with the price dropping regularly. The highlight is a $16000 purse that leads to audience laughter.&lt;/p&gt;
&lt;p&gt;Q: how to deal with production side of microservices such as service discovery or log aggregation?&lt;br /&gt;
A: no service discovery as Zookeeper tracks where everything is (which ports something is on). Log aggregation isnt great at the moment, so they&amp;#8217;re working on centralized collection atm.&lt;/p&gt;
&lt;p&gt;Q: what&amp;#8217;s the greatest win of FP here? Is type safety really important or something like that?&lt;br /&gt;
A: in the context of the company development and the technical stack, one nice thing about Scala is that it combines the &amp;#8220;good parts&amp;#8221; of Ruby (concise, expressive) with type safety and performance (as they had in Java). Scala provided a balance between Java and Ruby by giving them type safety, performance and conciseness, which is a big win in terms of expressivity and reuse of components.&lt;/p&gt;
&lt;p&gt;Q: how do you handle versioning of microservices?&lt;br /&gt;
A: each service maintains back compat in its API until they ensure all their clients are upgraded. The URI path has the version number, so service providers bump the version number for new clients and keep the old version working. They then migrate all the clients of the service as quickly as is practical.&lt;/p&gt;
&lt;h2&gt;PalletOpts and infrastructure automation&lt;/h2&gt;
&lt;p&gt;(I missed a lot of this talk due to a lunch chat spilling over. I&amp;#8217;ll fill it in later &amp;#8211;editor)&lt;/p&gt;
&lt;p&gt;A Clojure DSL that runs shell scripts and handles very complex infrastructure automation.&lt;/p&gt;
&lt;p&gt;Q: Yaron: How do you handle error propagation through scripts (the equiv of set -e in sh)&lt;br /&gt;
A: Each combinator propagates errors and there are different run strategies that handle errors differently depending on needs.&lt;/p&gt;
&lt;h2&gt;Streaming data at Twitter with Summingbird&lt;/h2&gt;
&lt;p&gt;Speaker is &lt;a href=&quot;http://twitter.com/sritchie&quot;&gt;@sritchie&lt;/a&gt; (&lt;a href=&quot;https://speakerdeck.com/sritchie/summingbird-at-cufp&quot;&gt;his slides&lt;/a&gt;). &lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo-3.jpg&quot;&gt;&lt;img class=&quot;size-medium wp-image-1399 alignright&quot; alt=&quot;photo 3&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo-3-300x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Summingbird is how to do streaming Map Reduce at the scale they have at Twitter (scale is &amp;#8220;staggering&amp;#8221;). It has been open sourced since Sep 3rd and a bunch of internal systems at Twitter run on it. Mainly three people: @posco @sritchie and Ashu &amp;#8212; small teams.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Vision&lt;/b&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;b&gt;&amp;#8220;Write your logic once&amp;#8221;&lt;/b&gt;: Twitter has a number of 1000+ host Hadoop clusters and a lot of their data is done via k/v processing with Hadoop. Going streaming had to be done evolutionary by letting it be done either on Hadoop or on some new streaming service. Programmers experimenting with data shouldn&amp;#8217;t have to make systems decisions early on in the process. Twitters scale: 200m+ active users, 500M tweets/day and scale is pervasive.&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Solve systems problems once&lt;/b&gt; so that systems that are scaling stay fixed.&lt;/li&gt;
&lt;li&gt;&lt;b&gt;Make non-trivial realtime compute as accessible as Scalding&lt;/b&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This leads onto Summingbird: a declarative map/reduce streaming DSL. It&amp;#8217;s a realtime platform that runs on Storm, and a batch platform that runs on Hadoop. The datastructures that come out of the DSL can be run on either platform (so you can choose between batch/streaming very late in the process).&lt;/p&gt;
&lt;p&gt;One of the big concepts that Summingbird embraces is the idea of &amp;#8220;associative plus&amp;#8221; operations &amp;#8212; the monoid.&lt;br /&gt;
The 4 S&amp;#8217; of Summingbird (&amp;#8220;you know you&amp;#8217;re onto something when they all have something in common!&amp;#8221;):&lt;/p&gt;
&lt;pre&gt;Source[+T]
Store[-K,V]
Sink[-T]
Service[-K,+V]&lt;/pre&gt;
&lt;p&gt;Source is where data comes from, Store is a k/v store that is being aggregated into. Sink is a dump as processing items, and Service permits k/v lookups during a job.&lt;/p&gt;
&lt;p&gt;Store: what values are allowed? What constraints can we place on a MR job such that any valid value can make progress.&lt;/p&gt;
&lt;pre&gt;trait Monoid[V] {
  def zero: V
  def plus(l:V, r:V):V
}&lt;/pre&gt;
&lt;p&gt;&amp;#8220;less scary than a monad!&amp;#8221;. If you can take any two values and smash them together, you have a monoid &amp;#8212; e.g. integers. Also Sets have a monoid (concat) and lists (concat) and maps (recursively pull in the monoid on the value). Others include: HyperLogLog, CMS, ExponentialMA, BloomFilter, Moments,MinHash,Topk. All you need to do is find a datastructure with a monoid and you can use Summingbird. There is an open source library called Algebird (birds birds birds!).&lt;/p&gt;
&lt;p&gt;It took some convincing (the words like &amp;#8220;monoid&amp;#8221; still scared people at Twitter, sadly).&lt;/p&gt;
&lt;p&gt;Monoids are amazing due to Associativity. If you know that the values you are reducing are associative, then it&amp;#8217;s easy to parallelise since they can be built &amp;#8220;in any order&amp;#8221;.&lt;/p&gt;
&lt;p&gt;Even though realtime is important at Twitter, noones wanted to dip in due to the difficulty of getting started. Summingbird can pull in data from an existing static Hadoop cluster and then union it with a realtime feed. If you give the logic to Summingbird, it will run the logic on Hadoop (consuming discrete batches of data) and the client will keep track of how far it&amp;#8217;s gone. The realtime comes from partial aggregations over fixed time buckets, and is merged together in the client using the monoid to aggregate them together to look like a proper realtime feed.&lt;/p&gt;
&lt;p&gt;One cool feature: when you visit a tweet, you want the reverse feed of things that have embedded the tweet. The MR graph for this comes from: when you see an impression, find the key of the tweet and emit a tuple of the tweetid and Map[URL,Long]. Since Maps have a monoid, this can be run in parallel, and it will contain a list of who has viewed it and from where. The Map has a Long since popular tweets can be embedded in millions of websites and so they use an &amp;#8220;accountment sketch&amp;#8221; which is an approximate data structure to deal with scale there. The Summingbird layer which the speaker shows on stage filters events, and generates KV pairs and emits events.&lt;/p&gt;
&lt;p&gt;Twitter advertising is also built on Summingbird. Various campaigns can be built by building a backend using a Monoid that expresses the needs, and then the majority of the work is on the UI work in the frontend (where it should be &amp;#8212; remember, solve systems problems once is part of the vision).&lt;/p&gt;
&lt;p&gt;Future plans:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Akka, Spark, Tez platforms&lt;/li&gt;
&lt;li&gt;Pluggable graph optimizations since various planners do improved filter push&lt;/li&gt;
&lt;li&gt;Metadata publishing with HCatalog &amp;#8212; in OSS, this means better tooling for EC2 and other cloud platforms.&lt;/li&gt;
&lt;li&gt;And of course, more tutorials&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;All work happens on Github so contributors are welcome.&lt;/p&gt;
&lt;p&gt;Summingbird is working well for the majority of realtime apps at Twitter. It&amp;#8217;s all about the Monoid! Data scientists who arent familiar with systems can deploy realtime systems, and 90%+ of the code is reused across the realtime and batch systems.&lt;/p&gt;
&lt;p&gt;Q: Did Hadoop need any changes to cope with the interfacing with Summingbird.&lt;br /&gt;
A: Scalding (written at Twitter) handles much of the interfacing with Hadoop. Hadoop is really the classical k/v store now. Real problem is figuring out which operations can work on both the batch and realtime and only admitting realtime.&lt;/p&gt;
&lt;p&gt;Q: Yaron: associativity is one nice thing about Monoid, but what about commutativity is also important. Are there examples of non-commutative datastructures&lt;br /&gt;
A: Good examples. It should be baked into the algebra (non-commutativity). This helps with data skew in particular. An important non-commutative application is Twitter itself! When you want to build the List monoid, the key is userid,time and the value is the list of tweets over that timeline (so ordering matters here). It&amp;#8217;s not good to get a non-deterministic order when building up these lists in parallel, so that&amp;#8217;s a good example of when associativity and commutativity are both important.&lt;/p&gt;
&lt;h2&gt;Functional Probabilistic Programming&lt;/h2&gt;
&lt;p&gt;Avi from Charles River, introducing the Figaro language.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Problem&lt;/b&gt;: Suppose you have some information (&amp;#8220;suppose Brian ate pizza last night&amp;#8221;) and you want to answer some questions based on this (&amp;#8220;is Brian a student or a programmer?&amp;#8221;) and keep track of the uncertainty in the answers.&lt;/p&gt;
&lt;p&gt;&lt;b&gt;Solution&lt;/b&gt;: Create a joint probability distribution over the variables, assert the evidence and use probabilistic inference to get the answer back.&lt;/p&gt;
&lt;p&gt;One common way to do this generative models. Probabilistic models in which variables are generated in order. Later values can depend on previous variables with a binding. This is a v popular approach with several implementations available over the years.&lt;/p&gt;
&lt;p&gt;Developing a new model requires figuring out a representation, an inference algorithm and a learning algorithm. All of these are significant challenges with each of them still being considered paper-worthy.&lt;/p&gt;
&lt;p&gt;The dominant paradigm is functional probabilistic programming. An expression describes a computation that produces a value.&lt;/p&gt;
&lt;pre&gt;let student = true in
let programmer = student in
let pizza = student &amp;amp;&amp;amp; programer in 
(student, programmer, pizza)

let student = flip 0.7 in
let programmer = if student flip(0.2) else flip(0.1) in
let pizza = if student &amp;amp;&amp;amp; programmer flip(0.9) else flip(0.3)
(student, programmer, pizza)&lt;/pre&gt;
&lt;p&gt;How are we supposed to understand this kind of program. Sampling semantics: run this program many times, each with a sample outcome. In each run, each outcome has some probability of being generated. The program defines a probability distribution over all the outcomes.&lt;/p&gt;
&lt;p&gt;This is a powerful approach since we are taking a Turing powerful language and probabilistic primitives are added, and this naturally expresses a wide range of models.&lt;/p&gt;
&lt;p&gt;Structured variable elimination, Markov chain Monte Carlo, importance sampling and so forth can all be built using functional probabilistic programming. PPLs aim to &amp;#8220;democratize&amp;#8221; model building &amp;#8212; one shouldn&amp;#8217;t need extensive training in ML or AI to build such models, or use them effectively.&lt;/p&gt;
&lt;p&gt;IBAL (2000-2007) is the first practical PPL, implemented in OCaml but not embedded in OCaml. Exact inference using structured variable elimination and later had intelligence important sampling. However, it was hard to integrate it with applications and data (in IBAL the data had to be hardcoded into the data, which wasnt practical). It also lacked continuous variables. Therefore the speaker built Figaro to work around the limitations.&lt;/p&gt;
&lt;p&gt;Figaro (2009-present) is a EDSL in Scala and allows distributions over any data type. It has a highly expressive constraint system that allows it to express non-generative models. There is an extensible library of inference algorithms that contains many of the popular probabilistic inference algorithms (eg. variable elimination).&lt;/p&gt;
&lt;p&gt;The goals of Figaro are to implement a PPL in a widely used library: Scala is the interop language as Java compat is a prime goal. Figaro provides various good abstractions such as OO that come out of Scala (not sure, he skipped slide rapidly here? &amp;#8212; editor)&lt;/p&gt;
&lt;p&gt;Figaro has an &lt;code&gt;Element[T]&lt;/code&gt; which is a class of probablistic models over type T. Atomic elements (Constant,Flip, Uniform, Geometric) are combined with compound elements &lt;code&gt;(If (Flip(0.9), Constant(0.5)...)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Under the hood, there is a probability monad to track the state. The Constant is the monadic unit and Chain(T,U) implements the monadic bind. Apply(T,U) implements monadic fmap. Most elements in Figaro are implemented using this monad.&lt;/p&gt;
&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo-4.jpg&quot;&gt;&lt;img class=&quot;size-medium wp-image-1400 alignright&quot; alt=&quot;photo 4&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo-4-300x300.jpg&quot; /&gt;&lt;/a&gt;
&lt;p&gt;Example 1: Probabilistic walk over a graph. In Figaro, we start by defining datastructures over the webpage graph (Edge, Node, Graph) and then we define some parameters of the random walk.&lt;/p&gt;
&lt;p&gt;Example 2: Friends and smokers. Create a person with a smokes variable. Friends are three times as likely to have the same smoking habit than different, so this is a constraint variable. Finally this is applied to all pairs of friends by adding constraints to the pairs. This is then instantiated in a particular situation by building a set of people (alice, bob, clara) and running the inference algorithm (VariableElimination) to calculate the probability that Clara smokes.&lt;/p&gt;
&lt;p&gt;Example 3: Hierarchical reasoning. We observe an object (say a vehicle on a road, or a person, or something) and we want to know what type of object it is. We have some observations about this object (its size, color or shape) and we want to know if its something we should be interested in. It&amp;#8217;s very natural to think of these objects via an inheritance hierarchy. In Figaro, every element has a name and belongs to an element collection. A reference is a sequence of names (such as vehicle size). Starting with an element collection, we can get to the vehicle associated with an element (go through through the sequence of nested element collections). However, there may be uncertainty in the identity of a reference (e.g. you dont know what vehicle1 is). Figaro resolve the element to the actual element.&lt;/p&gt;
&lt;p&gt;Obtaining Figaro is free and open source (cra.com/figaro) but v2 is on GitHub (like everything else today, it seems).&lt;/p&gt;
&lt;p&gt;Q: What are the limitations of Figaro, such as non-terminating Bernoulli tasks and what constraints cant be encoded?&lt;br /&gt;
A: Anything you can express can be put in constraints since any code can go in there. It&amp;#8217;s very easy to express something that you cant compute. Figaro is working on helping the programmer that can be computed over, such as via rejection sampling or simply rejecting the bad constraint.&lt;/p&gt;
&lt;p&gt;Q: Similar to Norman Ramsey&amp;#8217;s work (such as Church), whats the relationship&lt;br /&gt;
A: The languages fall into categories: their own languages and embedded libraries. The latter is Figaro and Infer.NET and Factory. INFER.NET is limited in expressivity and so can be compiled into a factor graph so is very efficient. Similarly Factory is lowlevel and compiles to factor graph. Lots to discuss here.&lt;/p&gt;
&lt;h2&gt;Haskell and FPComplete&lt;/h2&gt;
&lt;p&gt;Company exists to fix Haskell development tools. All the tools are cloud-based and run in a web browser. Content can be browsed anonymously. This talk will not have the Monad word in it!&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo4.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1425&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo4-300x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;There exists a feature to create tutorials and embed code within those tutorials.&lt;/p&gt;
&lt;p&gt;Latest product (being announced today) is a Haskell IDE that is a web based tool which requires no setup and no download. It has a number of cool features:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Errors are displayed immediately as it compiled as you type&lt;/li&gt;
&lt;li&gt;Git based so full version control&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Company goals: increase Haskell adoption and make it more accessible. Offer commercial grade tools and support and simplify Haskell development. Also to support the Haskell community and leverage the community to improve FP Complete&amp;#8217;s own products.&lt;/p&gt;
&lt;p&gt;The FP Haskell Center (released in Sep 2013) has:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a web front end (no setup,access to help and integrated with Haskell)&lt;/li&gt;
&lt;li&gt;Haskell backend has project management, developer feedback with errors, build system and a cloud based execution and deployment platform. The cloud allows for faster product evolution!&lt;/li&gt;
&lt;li&gt;Soon to have a personal version and version that will work behind firewalls etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It is all implemented in a Haskell web framework like Yesod. Lots of library support via conduits, and the UI uses Javascript (via Fay). All the heavy lifting is done in the backend and not via Javascript. Very few issues surfaced using Yesod and no major modifications were required to build their product.&lt;/p&gt;
&lt;p&gt;Challenges were outside the scope of Haskell usually, but Haskell was used to fix them.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Javascript coding was significant in the frontend&lt;/li&gt;
&lt;li&gt;Stable set of libraries are important&lt;/li&gt;
&lt;li&gt;Compiler integration (feedback and errors) must be available as a library to let the IDE spot identifier location problems&lt;/li&gt;
&lt;li&gt;Uses LXC containers to created isolation containers &amp;#8212; ephemeral storage and containers can run on either shared or dedicated systems.&lt;/li&gt;
&lt;li&gt;IDE uses isolation git state to separate users from each other. When projects are created, there is a visual representation of projects (in git repositories each, in S3) and each repo is accessed via Gitlib-2. Interesting is that this offers multiple backends for git access: Git C library, GitHub C library, IDE local repo in S3 or others in the future.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For building projects, code is being precompiled continuously in the backend and so bytecode can generated quickly and run within the IDE. Bytecode runs in the GHC frontend container and exceptions dont break the IDE. Keter and Chef provide deployment assistance to get it into a shared application server or container, and FP Complete offers this deployment as part of their product.&lt;/p&gt;
&lt;p&gt;Billing Processor provides SOAP APIs. Added SOAP Haskell libraries to Haskell via C++ bindings.&lt;/p&gt;
&lt;h2&gt;Mobile gaming from Japan&lt;/h2&gt;
&lt;p&gt;They normally built mobile games using Ruby, PHP, etc, but have switched to FP in recent years for reliability, high performance and productivity. However, they&amp;#8217;ve suffered from memory leak (blaming Haskell&amp;#8217;s laziness, to audience laughter), and some data loss and performance degradation.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo3.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1424&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo3-300x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Gree is one of the largest mobile games platforms, with 37 million users and 2000 games as of June 2013. They develop social games and a platform for 3rd party games. They also do social media and advertising and licensing, and also venture capital.&lt;/p&gt;
&lt;p&gt;Employees are 2582 with a significant number of engineers (cant disclose exact numbers). On client side, it&amp;#8217;s normally Java, ObjC, Javascript and Unity/C#. Server side is usually PHP, MySQL and Flare (a KV store written in C++ developed internally at Gree). They started a Haskell project in Jun 2012 and they have 6 Scala and 4 Haskell engineers.&lt;/p&gt;
&lt;p&gt;They developed a KVS management system using Haskell, to setup and destroy KVS nodes in response to hardware faults and sudden access spikes. It&amp;#8217;s used in a large social game application. Another example is an image storage gateway, which converts WebDAV to memcached/S3 for the SNS photo uploader to store images. It uses Warp and http-conduit to do this conversion.&lt;/p&gt;
&lt;p&gt;Some pitfalls they faced with Haskell:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Memory leaks via lazy evaluation: frontend server keeps a list of active thread ids in a TVar for monitoring. When deleting from the thread list, the function didnt reduce the function to a normal form and so held onto a reference. This led to a serious memory leak that took the service down. It was fixed easily by evaluating to the normalform and forcing sequentialisation. They felt it is too easy to mix up TVar/MVar writes with other IO operations (which do reduce to normal form and avoid the leak). There is much confusion over the strict/lazy alternatives for non-IO functions&lt;/li&gt;
&lt;li&gt;Race conditions: Data put in a queue is very rarely lost. The reason is that the timeout functions can be used only once safely with an IO function. (details omitted)&lt;/li&gt;
&lt;li&gt;Performance degradation: from forking a lot of threads to do monitoring. This was easy to fix but happens often since Haskell libraries are developed actively and the implications of changes are not always obvious.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;How to fix all this? Better &lt;b&gt;testing&lt;/b&gt; to start with. Haskell has a great QuickCheck framework and they developed HUnit. This lets services be started in the setup (in their example, memcached using a spare port), and then run services against it and make sure its torn down in a timely fashion. They used this to extensively test their KVS system and Flare (written in C++). Over 150 system tests and a control server with 5000+ assertions, so this is a big scale test.&lt;/p&gt;
&lt;p&gt;Next up is documentation in Haskell. A problem report describes details of the problem and linked from a bug tracker. The timeline, workaround, impact and details caused must all be captured and are mixed up with a number of other reports, so none of the Haskell people read it. They collected up the aggregation and summarised it for other Haskell products. Despite this, other Haskell programmers still dont read it (audience laughter). To sort this out, they do automated checking using hlint. They customize hlint to &amp;#8220;grep&amp;#8221; for their particular pitfall, and then check for Emacs. hlint isnt quite good enough for a lot of their pitfalls though, such as the timeout issue from earlier, so they had some workarounds to deal with this. The good thing is that hlint is integrated into their text editor. Not all pitfalls can be caught by hlint: high level design issues will remain problematic.&lt;/p&gt;
&lt;p&gt;Education is also important. They have a brown bag (lunch? &amp;#8212; editor) FP meeting where they &amp;#8220;Make GREE a better place through the power of FP&amp;#8221;. They cover both Scala and Haskell topics. They also run an education program for new graduates, and they have a Haskell code puzzle series from Project Euler to help the new graduates.&lt;/p&gt;
&lt;p&gt;They conclude that they love FP and they develop some key components of our service using FP. But there are many pitfalls, and they are developing tools to assist them sort them out.&lt;/p&gt;
&lt;h2&gt;Haskell for distributed systems&lt;/h2&gt;
&lt;p&gt;Jeff Epstein (formerly a masters student in the Cambridge SRG, so it&amp;#8217;s good to see him again!) talks about their new distributed system that they are building in Haskell. His company is also available for hiring!&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo5.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1428&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo5-300x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;HA middleware manages networked clusters, aiming for exabyte-scale clusters. It&amp;#8217;s architected by Mathieu Boespflug and Peter Braam (who has spoken about their FPGA work &lt;a href=&quot;http://cufp.org/videos/parallel-scientific-awesome-haskell-fpga-compiler&quot;&gt;at past CUFPs&lt;/a&gt;). It manages 10000+ nodes and creates consensus in the cluster about the location of active services. It can handle events due to failures, recovery time should be approx. 5 seconds.&lt;/p&gt;
&lt;p&gt;Zookeeper didn&amp;#8217;t scale &lt;i&gt;(audience interruption: why didnt Zookeeper scale? Jeff says he doesn&amp;#8217;t know and should chat offline, audience member notes that they maintain Zookeeper and wants to know more)&lt;/i&gt;.&lt;/p&gt;
&lt;p&gt;Events are sent by nodes and aggregated at a proxy node, and enqueued at an HA station. Events are processed by the hA coordinator and updates a node state graph (which is also replicated &amp;#8212; everything is replicated and is a key theme in the talk). The HA coordinator is the decision maker which decides what to do on failure. Its main action is updating the node state graph to reflect the new strategy after failure.&lt;/p&gt;
&lt;p&gt;Key components are: Haskell, Cloud Haskell and Paxos.&lt;/p&gt;
&lt;p&gt;How we used Haskell:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Functional Data structures result in a purely functional graph and replicated (impurely) between cluster managers. Most of the feels imperative though, which was important.&lt;/li&gt;
&lt;li&gt;Refactoring being easier was important due to strong typing.&lt;/li&gt;
&lt;li&gt;Laziness was yet again a problem causer in IO due to space leaks in low-level networking code. He notes that distribution is a natural barrier to laziness, since the act of serializing a message forces its evaluation. He also notes that processes much behave the same between processes on the same host as between hosts, and so even local communication must be forced.&lt;i&gt;Phil Walder interjects to ask &amp;#8220;why did you use Haskell? It&amp;#8217;s a bad fit! Jeff replies that &amp;#8220;we like Haskell&amp;#8221;&lt;/i&gt; and introduces Cloud Haskell, the topic of his MPhil thesis.Cloud Haskell is a library for distributed concurrency in Haskell and provides an actor-style message-passing interface, similarly to Erlang. It provides a &amp;#8220;typed erlang&amp;#8221;.Cloud Haskell is a good fit for this project in terms of interacting communicating components. Refactoring is easy, and this isn&amp;#8217;t a &amp;#8220;big data&amp;#8221; project in the sense of data size. There is a huge amount of communication messages though.CH has a pluggable transport layer such as TCP, but also for different underlying networks (they built Infiniband). However, CH requires ordered delivery of packets and this was a poor fit (they want out of order delivery, which could be built with UDP, but CH requires an ordering for some reason). Space leaks are a real problem in this layer.Cluster bringup is tough for CH, since nodes need to find each other at start of day, and there some hacks in there to work around a morning storm of messages.&lt;i&gt;(Interjection from audience: why not use Erlang? Jeff: performance wasnt up to par, and static types are important for them). Possibly the native code / bytecode erlang might be useful but speaker wasn&amp;#8217;t sure if it would work.&lt;/i&gt;
&lt;p&gt;Paxos: is all about making systems agree (well-known proven algorithm for consensus). They implemented this as a general purpose library on top of CH. The algorithm is a good match for the programming model, with the client, acceptor, proposer learning and leader all built as CH processes. It ended up being a small readable implementation (1.5kLOC) that closely matched the pseudocode in the original Paxos paper (made them feel better about correctness). It&amp;#8217;s used for synchronizing the state graph and for the distributed message queue.&lt;/p&gt;
&lt;p&gt;Challenges: Paxos is hard and untyped messages in CH make it worse. Getting reasonable performance from it also requires the modified variants. Liveness also is tricky to avoid overapproximations to prevent nodes being fenced out of the consensus unnecessarily. Multipaxos is something that solves some of this, and they&amp;#8217;re working on more specific stuff also.&lt;/p&gt;
&lt;p&gt;Debugging: The CH programming model makes it tractable to debug a distributed application on a single machine. Nevertheless, distributed code is still parallel and involves race conditions and mixing messages. They would like a distributed &lt;a href=&quot;http://www.haskell.org/haskellwiki/ThreadScope&quot;&gt;ThreadScope&lt;/a&gt; but instead mainly used oldskool logging.&lt;/p&gt;
&lt;p&gt;They did build a deterministic CH thread scheduler to replace CH&amp;#8217;s core message handling primitives, and they also used PROMELA&lt;/p&gt;
&lt;p&gt;Q: how much is open source or will be?&lt;br /&gt;
A: none as far as speaker knows&lt;/p&gt;
&lt;p&gt;Q: Marius: how are non-deterministic sources composed with the deterministic scheduler?&lt;br /&gt;
A: deterministic scheduler is for testing only, so timeouts also so deterministic.&lt;/p&gt;
&lt;h2&gt;IQ: Functional Reporting&lt;/h2&gt;
&lt;p&gt;Speaker is Edward Kmett on how they got FP in the door at S&amp;amp;P Capital in the door, their extensions to Haskell and generally how they&amp;#8217;re working on opensourcing their tech. SAP is huge and have a number of products (S&amp;amp;P Capital IQ Platform, ClariFI, AlphaWorks, Compustat).&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo6.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1434&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo6-300x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Getting FP in the door:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Monoids (introduced as with the Summingbird talk, for easy parallelisation)&lt;/li&gt;
&lt;li&gt;Reducers are another really powerful abstraction which can take a container full of values and give you back a structure, and it has a comonadic structure that lets you (e.g.) pass it many containers full of structures and generally compose things nicely. Reduction can also be done simultaneously across monoidal structures and essentially &amp;#8220;we dont see the wiring hanging out of our code any more&amp;#8221;.&lt;/li&gt;
&lt;li&gt;Performance attribution: This is a model that breaks down the reasons why you make money (what did you do that was significant). The old and busted model (implemented in Java, full dataset in memory, hard to extend) was horrible, and the new hotness is implemented in Scala, runs in constant space, is really fast and results are flattened elegantly via combinators to a database backend. In other words: better, but some details are glossed over (multipass algorithms, iteratees, caching layers, and handling missing data) &amp;#8212; but all this was sorted out and really sold Scala to the bigger company as a real asset.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;They developed Ermine, which is Haskell with Row Types. It&amp;#8217;s not quite Haskell, but it&amp;#8217;s main feature is that it&amp;#8217;s not Scala either (audience laughter). Writing functional programs in Scala is quite painful (e.g. not blowing stack with monads requires trampolining everything and is labour intensive just to get by day to day). They wrote Ermine in both Scala and Haskell with a portable Core that can run on the JVM.&lt;/p&gt;
&lt;p&gt;Ermine has a strong type system, with novel row types and polymorphic and constraint kinds (&amp;#8220;they were just coming into GHC at the time and I wanted to understand them&amp;#8221;) and Rank-N types via a derivative of HMF. It fit their domain requirements really wel, and has builtin database support, can be exposed to end users, a structured code editor that can only generate type-safe code as you&amp;#8217;re defining, and full control over error messages.&lt;/p&gt;
&lt;p&gt;Row types are a powerful way of describing the presence of a particular field. Its modelled via has, lacks and/or subsumes constraints. This is easily checked, but now inference flows unidirectionally through a join.&lt;br /&gt;
In Ermine, they have existentials in their constraint types &lt;i&gt;(technical explanation follows, not shown here &amp;#8211;editor)&lt;/i&gt;.&lt;/p&gt;
&lt;p&gt;Their reporting layer has one declarative specification to do all the relational algebra specifications they want, and push it into specific backends (SQL Server, etc) and ensure they run their queries as close to the data as possible. They can also create extensive HTML reports that render pretty consistently across different target platforms. Their example of Ermine was written by a functional programmer that had done no functional programming previously, which required a little hand holding to work through some of the more obscure type errors, but generally it worked ok.&lt;/p&gt;
&lt;p&gt;All the code is being stuck onto Hackage/Github etc.&lt;/p&gt;
&lt;p&gt;Q: has it been rolled out to a lot of users?&lt;br /&gt;
A: being used on the main S&amp;amp;P website. One big client facing page for users. The next gen stuff is using Ermine more widely. The desktop app coming soon has Ermine and will be used by a huge number of users. Trend is to use it in an increasing number of their products.&lt;/p&gt;
&lt;h2&gt;Enterprise scheduling with Haskell at skedge.me&lt;/h2&gt;
&lt;p&gt;They have a cloud-based scheduling platform that takes care of complex enterprise scheduling. It has a branded customer experience (like Google Apps does), a flexible workflow and deep integration with backend systems and in-store workflow (e.g. on iPads).&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo7.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1445&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo7-300x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Example is Sephora who do makeup, and their appointment system is integrated via skedge.me that is embedded in an iFrame that looks like a seamless part of their site so that endusers cant tell the difference.&lt;/p&gt;
&lt;p&gt;When speaker started at skedge.me, there was a lot of fire fighting. It was 43k lines of Groovy on Grails, and several major intractable bugs were affecting the business: timezones, double bookings, recurring events not firing and notifications being delayed. Performance was an issue, as things that were interactive were sometime taking minutes to load. There was also a lot of inflexibility &amp;#8212; hilariously, they had to sometimes ask clients to change their business model to fit with the skedge.me model.&lt;/p&gt;
&lt;p&gt;After some careful though, they decided they had to rewrite skedge.me to cope with growth and better service. The author had done Haskell before, but not specifically was with building a website using it.&lt;/p&gt;
&lt;p&gt;Haskell had the perfect model for fixing their scaling problems. At the lowest level, they built a RawDB on top of the IO monad that did everything necessary to maintain ACID guarantees during transactions. An example is that once an effect gets committed (e.g. an email gets sent confirming an appointment and then is cancelled, which happened on their old racy platform). This RawDB layer gives them stronger consistency guarantees with tracked effects and automatic retries on temporary failure.&lt;/p&gt;
&lt;p&gt;On top of the RawDB, they build a DB monad which provides a higher level than SQL via algebraic data types, caching and data validation. They then layer a security monad on top of the DB monad to guarantee that all accesses have been checked. Finally there is a business logic layer to enforce local policy and customise per customer (which was a real problem in the past).&lt;/p&gt;
&lt;p&gt;Security is complex due to all the customization, and they needed roles by client (owner, staff, customer) but also because clients can customise their &lt;i&gt;verbs&lt;/i&gt; that only make sense within the component (Appointments can be joined, rescheduled, or notifications can be sent, edit cancelled). Haskell lets all this fit within a multiparameter type class, instead of doing OO-style inheritance that will rapidly get out of control. They map customisations from the customer onto a more standard schema that they can manipulate generically on a component-by-component basis, and it&amp;#8217;s all statically checked and generally easy to read (important for security critical code).&lt;/p&gt;
&lt;p&gt;Haskell &amp;#8220;lets them build code for the long run&amp;#8221;. Sometimes though, you need to write code quickly and not care about longevity. This was the case for the importer, which is a quick-and-dirty hack to get code into their system. It has a limited set of inputs, the &amp;#8220;end user&amp;#8221; is the developer, and it&amp;#8217;s thrown away once the job&amp;#8217;s done. (shows epic type). Often when people need to do this sort of thing, they resort to bash or dynamically typed systems. In this case, even for this &amp;#8220;quick hack&amp;#8221;, they couldnt have achieved what they did &amp;#8220;as badly as they did, without the help of the type system&amp;#8221;. Generally very positive!&lt;/p&gt;
&lt;p&gt;Libraries help them not have to write code. Haskell is generally lower in terms of package count, but their *use* of Hackage libraries has been a lot higher than Javascript. They use 9 Javascript libraries, and 71 unique Hackage libraries (+87 dependencies). Its a lot harder to find a quality library that works in the dynamically typed land. Only one of their Haskell libraries had to be replaced due to bugs. This is because Hackage is well-organized, and it&amp;#8217;s easier to vet a library since the purely functional ones are less risky (fewer sideeffects through other code). In contrast, Javascript libraries can sideeffect (e.g. on the DOM) very late in the QA process. So: fewer Haskell libraries, but the number of useful libraries seems to be higher.&lt;/p&gt;
&lt;p&gt;Problems: cyclic module dependencies with hs-boot files are unwieldy, so avoid them. Scalability with 4+cores was limited, but they havent tested GHC 7.8 (which apparently fixes a lot of this). Idle GC can cause issues with long pauses, so disable this feature &amp;#8212; it depends on your workload but it was ok for their server based workload.&lt;/p&gt;
&lt;p&gt;Debugging production problems without stack traces is really hard, so consider using profiling mode for all libraries.&lt;/p&gt;
&lt;p&gt;Bottom line: 8200 lines of Haskell from 40k+ lines of Groovy. No recurring bugs and very good performance and flexibility for customer needs. Used daily by thousands of people. Check out the &lt;a href=&quot;http://skedge.me&quot;&gt;website&lt;/a&gt;!.&lt;/p&gt;
&lt;p&gt;Q: what about testing (QuickCheck?)&lt;br /&gt;
A: they&amp;#8217;ve done some QuickCheck on critical components (such as an map from times to events). Overall though, just putting Haskell together in the most obvious way led to improvements over their previous platform. Their QA guys are now writing unit tests in Haskell (because their Selenium bindings were harder).&lt;/p&gt;
&lt;h2&gt;Integration of Mathematica with MapReduce&lt;/h2&gt;
&lt;p&gt;From Paul-Jean Letourneau, a data scientist at Wolfram Research. &lt;i&gt;Started with a show of hands: most of the audience has used Mathematica and had heard of Wolfram.&lt;a href=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo8.jpg&quot;&gt;&lt;img class=&quot;alignright size-medium wp-image-1450&quot; alt=&quot;photo&quot; src=&quot;http://www.syslog.cl.cam.ac.uk/wp-content/uploads/2013/09/photo8-300x300.jpg&quot; /&gt;&lt;/a&gt;&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;The speaker has been responsible for a lot of the personal analytics posts on the Wolfram blog (the email analysis, genomics and several others). The theme of all his projects has been to work on large data. Mathematica has always kept its data oncore, which is a problem with very large data sets, and so this talk is about how they migrate over to a more big-data model to run offcore.&lt;/p&gt;
&lt;p&gt;Fundamental principles of Mathematica: everything is an expression, expressions are transformed until they stop changing, and transformation rules are in the form of patterns. Expressions are data structures (actually m-expressions in Lisp parlance). &lt;i&gt;(full explanation of these in Mathematica demonstrated but omitted here)&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;Expressions in Mathematica are immutable data structures (&amp;#8220;program as data&amp;#8221;) and so expressions can be rebound. Homoiconicity is pervasive as expressions are the data structure, even internally during evaluation (where it&amp;#8217;s represented as a tree).&lt;/p&gt;
&lt;p&gt;&lt;i&gt;&amp;#8220;everything is a one-liner in Mathematica&amp;#8230; for a sufficiently long line&amp;#8221; (Theo Gray).&lt;/i&gt; (audience laughter). He demonstrates some cool oneliners that are Tweetable (&amp;lt;140chars) and demonstrates how to construct an image recursively out of itself (wow).&lt;/p&gt;
&lt;p&gt;He views it as a gateway drug to declarative programming&lt;/p&gt;
&lt;pre&gt;y = 0
For[i=1; i&amp;lt;=10; i++,y+=i^2]; y
385&lt;/pre&gt;
&lt;p&gt;(and then they discover Fold and all the advanced topics such as scoping, evaluation control and the MathLink protocol for IPC).&lt;/p&gt;
&lt;p&gt;HadoopLink is how they link Mathmetica to Hadoop. Example is WordCount, wherein he shows code to do it on a single core first (to test the output), and then an export to HDFS so that Hadoop can see the code. This looks fairly straightforward via a DFSExport command from HadoopLik.&lt;/p&gt;
&lt;p&gt;The Mapper looks something like:&lt;/p&gt;
&lt;pre&gt;Function[{k,v},
  With[{words=ToLowerCase 
    /@ StringSplit [k,RegularExpression[], ...&lt;/pre&gt;
&lt;p&gt;The reduces is similar, as it users an iterator to sum up each of the inputs. It actually communicates to the JVM to ensure that they dont have to load all the values into memory. Running the job is just a special HadoopMapReduceJob along with all the relevant expressions, and it goes ahead and submits it to Hadoop.&lt;/p&gt;
&lt;p&gt;Used this to build a genome search engine using all this. He shows how to prep data using Mitochondrian genomic data. The mapper only knows about a single base in the genome and its position, and the query sequence, how can it possibly align the query sequence with the genome? Algorithm scales with the size of the query, and not the size of the dataset. Hadoop can be used to handle the full dataset so getting local algorithm right in Mathematica can be focussed on rather than the bigger problem.&lt;/p&gt;
&lt;p&gt;Challenges: when this scaled up to search the entire human genome, my Hadoop cluster blows up. Nodes start dying, Nagios alerts, the works! After drilling down on these cryptic errors, the &amp;#8220;garbage collector overhead was exceeded&amp;#8221; which was hard to interpret. The memory consumption on each worker node when running with both Mathematica and the slave is quite high. This is a setting that&amp;#8217;s made on a clusterwide basis and so is problematic to tweak just for this. What he&amp;#8217;d like to do is add job-specific options to run things like heap size.&lt;/p&gt;
&lt;p&gt;Its on GitHub and open source (github.com/shadanan/HadoopLink) so go for it.&lt;/p&gt;
&lt;h2&gt;Announcements&lt;/h2&gt;
&lt;p&gt;Ashish Agarwal is organizing BoFs! On Monday @ 6pm there will be a bioinformatics session with Jeff Hammerbacher with location on the CUFP website.&lt;/p&gt;
&lt;p&gt;On Tuesday there will be a BoF about organizing local events for FP. In the same way that politics is local, this BoF will help you figure out strategies for local events.&lt;/p&gt;
&lt;p&gt;Yaron Minsky announces that 17 organizations have sponsored CUFP this year, which helps students. Industry attention to FP is really amazing to see how FP is moving into the mainstream. Industrial reception at 1830 on Monday downstairs.&lt;/p&gt;
&lt;p&gt;Our thanks to Marius Eriksen and Mike Sperber for an amazing program!&lt;/p&gt;</content:encoded>
	<dc:date>2013-09-23T15:11:09+00:00</dc:date>
	<dc:creator>Anil Madhavapeddy</dc:creator>
</item>
<item rdf:about="http://anil.recoil.org/2013/09/20/opam-1-1-beta">
	<title>Anil Madhavapeddy: OPAM 1.1 beta available, with pretty colours</title>
	<link>http://anil.recoil.org/2013/09/20/opam-1-1-beta.html</link>
	<content:encoded>&lt;p&gt;&lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas&lt;/a&gt; just announced the availability of the &lt;a href=&quot;http://opam.ocamlpro.com&quot;&gt;OPAM&lt;/a&gt; beta release. This has been a huge amount of work for him and &lt;a href=&quot;http://louis.gesbert.fr/&quot;&gt;Louis&lt;/a&gt;, so I&amp;#8217;m excited to see this release! Aside from general stability, the main highlights for me are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;A switch to the &lt;a href=&quot;http://creativecommons.org/publicdomain/zero/1.0/&quot;&gt;CC0&lt;/a&gt; public-domain-like license for the repository, and LGPL2+linking exception for OPAM itself. The &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/issues/955&quot;&gt;cutover to the new license&lt;/a&gt; was the first non-gratuitous use of GitHub&amp;#8217;s fancy issue lists I&amp;#8217;ve seen, too! As part of this, we&amp;#8217;re also beginning a transition over to hosting it at &lt;code&gt;opam.ocaml.org&lt;/code&gt;, to underline our committment to maintaining it as an OCaml community resource.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;Much-improved support for package pinning and updates. This is the feature that makes OPAM work well with &lt;a href=&quot;http://openmirage.org&quot;&gt;MirageOS&lt;/a&gt;, since we often need to do development work on a low-level library (such as a &lt;a href=&quot;https://github.com/mirage/ocaml-xen-block-driver&quot;&gt;device driver&lt;/a&gt; and recompile all the reverse dependencies.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;Support for post-installation messages (e.g. to display &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/pull/1100&quot;&gt;licensing information&lt;/a&gt; or configuration hints) and better support for the external library management issues I explained in an earlier post about &lt;a href=&quot;http://anil.recoil.org/2013/09/09/ocamlot-autotriaging.html&quot;&gt;OCamlot testing&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;Better library structuring to let tools like &lt;a href=&quot;http://github.com/OCamlPro/opam2web&quot;&gt;Opam2web&lt;/a&gt; work with the package metadata. For instance, my group&amp;#8217;s &lt;a href=&quot;http://ocaml.io&quot;&gt;OCaml Labs&lt;/a&gt; has a comprehensive list of &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/pkg/index.html&quot;&gt;the software packages that we work on&lt;/a&gt; generated directly from an OPAM remote.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;A growing set of administration tools (via the &lt;code&gt;opam-admin&lt;/code&gt; binary) that run health checks and compute statistics over package repositories. For example, here&amp;#8217;s the result of running &lt;code&gt;opam-admin stats&lt;/code&gt; over the latest package repository to show various growth curves.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;table align=&quot;center&quot; width=&quot;90%&quot;&gt;
&lt;tr&gt;
&lt;td class=&quot;bimg&quot; width=&quot;30%&quot;&gt;&lt;a href=&quot;http://anil.recoil.org/images/opam11-beta-contributors.png&quot;&gt;&lt;img border=&quot;0&quot; src=&quot;http://anil.recoil.org/images/opam11-beta-contributors.png&quot; width=&quot;220&quot; /&gt;&lt;/a&gt;&lt;br /&gt;Number of unique contributors to the main OPAM package repository.&lt;/td&gt;
&lt;td class=&quot;bimg&quot; width=&quot;30%&quot;&gt;&lt;a href=&quot;http://anil.recoil.org/images/opam11-beta-packages.png&quot;&gt;&lt;img border=&quot;0&quot; src=&quot;http://anil.recoil.org/images/opam11-beta-packages.png&quot; width=&quot;220&quot; /&gt;&lt;/a&gt;&lt;br /&gt;Total number of unique packages (including multiple versions of the same package).&lt;/td&gt;
&lt;td class=&quot;bimg&quot; width=&quot;30%&quot;&gt;&lt;a href=&quot;http://anil.recoil.org/images/opam11-beta-unique-packages.png&quot;&gt;&lt;img border=&quot;0&quot; src=&quot;http://anil.recoil.org/images/opam11-beta-packages.png&quot; width=&quot;220&quot; /&gt;&lt;/a&gt;&lt;br /&gt;Total packages with multiple versions coalesced so you can see new package growth.&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;p&gt;Is it a &lt;a href=&quot;http://www.theatlantic.com/technology/archive/2013/05/the-hockey-stick-the-most-controversial-chart-in-science-explained/275753/&quot;&gt;hockey stick&lt;/a&gt; graph? Only time will tell! See Thomas&amp;#8217; &lt;a href=&quot;https://sympa.inria.fr/sympa/arc/caml-list/2013-09/msg00300.html&quot;&gt;full release announcement&lt;/a&gt; and let us know how you get along with this new release&amp;#8230;&lt;/p&gt;</content:encoded>
	<dc:date>2013-09-19T23:00:00+00:00</dc:date>
</item>
<item rdf:about="http://hh360.user.srcf.net/blog/?p=352">
	<title>Heidi Howard: OCaml Monthly Meeting – Live Blog</title>
	<link>http://hh360.user.srcf.net/blog/2013/09/ocaml-monthly-meeting-live-blog/</link>
	<content:encoded>&lt;p&gt;Today&amp;#8217;s OCaml Labs Monthly Meeting is all about practise talks for OCaml2013 so in that spirit, I&amp;#8217;ll practising a bit of live-blogging too.&lt;/p&gt;
&lt;p&gt;13:53 &amp;#8211; Today&amp;#8217;s SRG Meeting is over and its time for some work before the OCaml Labs meeting at 4:00, see you then &amp;#8230;&lt;/p&gt;
&lt;p&gt;16:02 Techincal difficulties delayed the start&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;16:02 Intro from Anil&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;introducing Gabriel Scherer who is visiting us this week and going we are going to Maypole after this meeting. We had a cash prise from ASPLOS after winning the HiPEAC paper award and the money will go towards SRG wine for XMAS party. Signpost paper was accepted to FOCI and a HotNet paper on Trevi was also just accepted&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;OCL Website&lt;/strong&gt; &amp;#8211; Too much manual management at the moment, moving to an &lt;a href=&quot;http://planet.ocamlcore.org/&quot;&gt;ocaml planet&lt;/a&gt; feed of blog posts. David has been busy hacking on &lt;a href=&quot;https://github.com/OCamlPro/opam2web&quot;&gt;OPAM2web&lt;/a&gt;, OPAM has 512 packages, Opam2web takes a subset of the OPAM packages and makes the metadata into a minisite, like on OPAM. Doesn&amp;#8217;t require manual updates, like an ATOM feed.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Upcoming events&lt;/strong&gt; &amp;#8211; Tomorrow is the 2nd &lt;a href=&quot;http://www.meetup.com/Makespace/events/138103982/&quot;&gt;compiler hacking event&lt;/a&gt;, at the &lt;a href=&quot;http://makespace.org/&quot;&gt;makespace&lt;/a&gt;. Anil will be talking at QCon on Mirage, Mirage 1.0 release date is October 22nd, so maybe a workshop before. We 3 talks for Ocaml2013 (Platform, OcamlOT and Ctypes) so here we go &amp;#8230;&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;16:09 Anil practice talk on OCaml Platform 1.0&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Languages take many difference approaches to platform, but what does platform even mean? As a late mover in this field, we can learn from other languages. A platforms is NOT a group of temporarily motivated hackers to build a replacement standard library. Its hard to adopt a particular approach without a domain specific purpose, there are too many opinions, we need objective way to determine what belongs in the platform, we need a genie community that is sustainable (even if a large party leaves). A platform is a bundle of tools that interoperate, with quantitative metric to judge success, built in agility and supporting developers thought the whole development life cycle. Industrial partners have a range of needs, as each work in different domains.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Tooling&lt;/strong&gt; &amp;#8211; Overview of 5 areas: OPAM from OCamlPro, IDE Tools, OPAM-DOC, OCaml compiler itself and Ocaml.org.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;OPAM&lt;/strong&gt; &amp;#8211; 1.1 released today (maybe), over 100 contributors to OPAM,  500+ packages, 1500+ unique versions, external dependency solver using CUDF&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;IDE Support&lt;/strong&gt; &amp;#8211; OCaml has many intermediate files. In OCaml 4.0 onwards, we have a binary format of an abstract syntax tree with type annotations called cmt (and cmti for interface files), we can now create external tools to query this like opam-doc. ocp-index and ocp-indent from OCamlPro, and Merlin (I thinks this is EPIC) are also now available&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;opam-doc&lt;/strong&gt; &amp;#8211; Now we have cmt files, we need unified documentation across packages, this is much harder than it sounds as it touches every part of the tool stack. Not all packages can be installed at once due to conflicts. Module inclusion is tough to code in static html. (Need to make a demo) bindoc takes the Typed AST (in cmt) and generates cmd, which include the ocamldoc comments, Opamdoc takes the cmt database for opam and output a single website with your universe of packages.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ocaml.org&lt;/strong&gt; - Demo of ocaml.org at &lt;a href=&quot;http://hh360.user.srcf.net/blog/category/pl/ocaml/feed/ocaml-redesign.github.io/pkg/index.html&quot;&gt;ocaml-redesign.github.io/pkg/index.html&lt;/a&gt;, feedback is welcome says amir&lt;/p&gt;
&lt;p&gt;Now we have the tools, what metrics can we extract to see how well our tools are doing.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Portability&lt;/strong&gt; &amp;#8211; windows compatibility ?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Maintainer&lt;/strong&gt; &amp;#8211; is there a place for docs and will people response to issues/comments/emails, where can issues be submitted ?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Tests&lt;/strong&gt; &amp;#8211; code coverage, multi variant benchmarking in &lt;a href=&quot;https://ocaml.janestreet.com/ocaml-core/latest/doc/core_bench/index.html&quot;&gt;core-bench&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Stability&lt;/strong&gt; &amp;#8211; OPAM support pining, how stable are the interfaces of libraries ?&lt;/p&gt;
&lt;p&gt;opam tracks compiler constraint, statically analyses the build system from logs (OCamlOT)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Agility&lt;/strong&gt; &amp;#8211; Building a platform is EXHAUSTING. We want to ask &amp;#8220;WANT IF&amp;#8221; questions: &lt;a href=&quot;http://gallium.inria.fr/blog/monomorphic_let/&quot;&gt;what if let was monomophic&lt;/a&gt;? what if we removed &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-camlp4/manual002.html&quot;&gt;camlp4&lt;/a&gt;? what is the syntax precedence changes ?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Distrusted workflow&lt;/strong&gt; &amp;#8211; build on git, distributing tasks between 3 actors: Author (library writers), OCamlOL workers and maintainers. As we become more stable we move from staging to stable to inclusion in the platform.&lt;/p&gt;
&lt;p&gt;We are building a tussle, we want to launch a game in janurary and let people put standard libraries into the ring, running OCamlOT to discover the winner&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;No clear winner&lt;/strong&gt;: Lwt &amp;#8211; portability, Batteries &amp;#8211; free of syntax extensions, core &amp;#8211; comprehensive.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span&gt;16:36  Discussion over the battle of the standard libraries and talk feedback&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;C: talk is a bit long, not sure what to cut..&lt;/p&gt;
&lt;p&gt;C: OPAM was dicussed last year at OCaml2013, we want to update everyone and follow on without overlapping too much&lt;/p&gt;
&lt;p&gt;Q: Haven&amp;#8217;t we already decided on JS&amp;#8217;s core ?&lt;/p&gt;
&lt;p&gt;A: No, we use all of them, i.e. Mirage used lwt extensively&lt;/p&gt;
&lt;p&gt;Q: What if we don&amp;#8217;t want any of the new standard libraries ? maybe I just want to use domain specific libraries from OPAM as and when I need them&lt;/p&gt;
&lt;p&gt;A: We are not forcing the new standard libraries on anyone, but they are useful for beginners, nice to have consistent style, interoperability and few open statements e.g. Open Core.Std&lt;/p&gt;
&lt;p&gt;Q: What if I have already decided which standard library I want to use ?&lt;/p&gt;
&lt;p&gt;A: Again we are not forcing standard libraries on anyone, we are just trying to force effort more directly. OCaml tools will always be standard library agnoctic&lt;/p&gt;
&lt;p&gt;C: the diagram of OCamlOT is confustion&lt;/p&gt;
&lt;p&gt;C: how to not overlap with david talks&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;16:41 Davids talk on OCamlOT&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;State for the open source OCaml community&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Outline:&lt;/strong&gt; what is quality software? what is the user experience? what is feedback loop for package authors? How do we represent the thing underneath this all? utopian future ?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Quality:&lt;/strong&gt; Work on every core (ANIL: We want multi-core &lt;img src=&quot;http://hh360.user.srcf.net/blog/wp-includes/images/smilies/icon_razz.gif&quot; alt=&quot;:P&quot; class=&quot;wp-smiley&quot; /&gt;  ), consistent results: work or die nicely with obvious solution, not more &amp;#8220;What have I forgotten?&amp;#8221; questions, it should just tell you. We need addictive actions (not sure what they are), consistency, quality functions&amp;#8230;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Universal concerns:&lt;/strong&gt; compiler hypothesis &amp;#8220;what if&amp;#8221; questions (anil already said this), build system hypotheses &amp;#8220;what strange assumuptions is the buid system making?&amp;#8221;, package manager hypothesis and environmner hypothesis&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Workflow:&lt;/strong&gt; Make a pull request, curator observes the proposal, predict the future, proposes amendments, feedback loop and finally agreement is reached. Core is release weekly for example, we are trying to work like linux kernal patches&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;New workflow:&lt;/strong&gt; promote health of OCaml community, preaching compatibility, &amp;#8220;observe, orient, decide and act&amp;#8221;, Computer assisted curator will help a human, to run the loop faster, human can pose questions to the computer assisted curator e.g  &amp;#8221;will this run on ARM ?&amp;#8221;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Repository Observation:&lt;/strong&gt; github binding with web hooks but we are not tied to github. We merge into the world and we need dependences from each possible users prospective of the world&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Dependency Orientation:&lt;/strong&gt; capabilities with environmental dependances, packages with constriant-based dependencies, repositories with revision dependencies and artifact dependencies. example of the android repo&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Triage Decisions:&lt;/strong&gt; taking plain text error and parsing them into categories such as unsatisfiability (can&amp;#8217;t have these two packages), dependencies (if my dependency is broken, then I am broken), transient (network down), system, metadata, external dependences (you forgot to write a dependency), build errors and a combo of many of the above.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;State Action:&lt;/strong&gt; commit intention, build, error analysis and buid results&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Internet res:&lt;/strong&gt; The agents negotiates over REST API on HTTPS, independent metadata layers (not sure about this) ,everythings an s-exp, branch consistent store explained, like git or &lt;a href=&quot;https://github.com/samoht/irminsule&quot;&gt;Irminsule&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Current state:&lt;/strong&gt; github web hooks, we are conservative so one byte changes and we rebuild everything, basic triage heuristics completed, no amendment are proposed by the system atm, we don&amp;#8217;t commit the outcome but the evidence, simple reactions to results, a website with green and red boxes in the large table&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;History:&lt;/strong&gt; we have found lots of metadata issues&lt;span&gt;, many packages bugs, some tool bugs like a non relocatable&lt;/span&gt;&lt;span&gt; compiler and &lt;/span&gt;ocamlbuild&lt;span&gt; PATH &lt;/span&gt;ignorer&lt;span&gt;, we currently have 30+ &lt;/span&gt;x84-64&lt;span&gt; 30+&lt;/span&gt;x84-32&lt;span&gt;, 8 ARMs , many &lt;/span&gt;Linux&lt;span&gt; distros&lt;/span&gt;&lt;span&gt; , &lt;/span&gt;dead &lt;a href=&quot;http://www.raspberrypi.org/&quot;&gt;Raspberry Pi&lt;/a&gt;, panicking&lt;span&gt; *nix &lt;/span&gt;filesystems&lt;span&gt; and lots of people have set warning as error&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Future:&lt;/strong&gt; opamfu for DAG analysis, schema migration overhead, lower overhead for administrating exotic workers contributed to OCamlOT, we need to authenticate machines using ocaml-sodium, we need more advanced automation, proposed amendments, lets have a dialogue, better website integration, benchmarking your upgrades (how much improves cost), run experiments on whole OPAM universe with differential analysis and VM-based test system, to specific the worker finely.&lt;/p&gt;
&lt;p&gt;What I think quantity is, vision of the future, how its represented underneath and what&amp;#8217;s next,&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;Discussions&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;C: that was 20mins, feedback to David regarding content to be cut,&lt;/p&gt;
&lt;p&gt;&lt;span&gt;&lt;strong&gt;17:23 Ctypes by Jeremy &lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This is a update not a practice talk&lt;/p&gt;
&lt;p&gt;An examples of puts from C, how we can write no C and link in OCaml,&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NEW things in Ctypes:&lt;/strong&gt;&lt;br /&gt;
prettyprinting &amp;#8211; for C types and C values, making it much eaiser to examine values for debuygging&lt;/p&gt;
&lt;p&gt;biarray &amp;#8211; support for lump of C memory&lt;/p&gt;
&lt;p&gt;More type &amp;#8211; nullable string, complex numbers&lt;/p&gt;
&lt;p&gt;String conversions &amp;#8211; much faster&lt;/p&gt;
&lt;p&gt;Memory management issues &amp;#8211; ctypes now gives the programmer more control over lifetime of OCaml passed to C,&lt;/p&gt;
&lt;p&gt;finaliser &amp;#8211; which you can attach to memory&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Future&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;stub generation &amp;#8211; instead of dynamically binding, it will generate stub code to act to the API&lt;/p&gt;
&lt;p&gt;capability-style memory safty &amp;#8211; one rogue pointer in a C library, can cause hell, loading each C library in a seperate address space so i library can only kill itself, you can then even run on C library on a foreign host or on a virtual machine&lt;/p&gt;
&lt;p&gt;static strcut/union layout &amp;#8211; checking layout of structures and unions against the API&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;span&gt;17:40 Amir demo of ocaml-resdesign.githuib.io/docs/opam,&lt;/span&gt;&lt;/strong&gt; (its look great :))&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://hh360.user.srcf.net/blog/wp-content/uploads/2013/09/ocaml.png&quot;&gt;&lt;img class=&quot;size-medium wp-image-363 aligncenter&quot; alt=&quot;ocaml&quot; src=&quot;http://hh360.user.srcf.net/blog/wp-content/uploads/2013/09/ocaml-253x300.png&quot; width=&quot;253&quot; height=&quot;300&quot; /&gt;&lt;/a&gt;&lt;/p&gt;</content:encoded>
	<dc:date>2013-09-17T12:54:53+00:00</dc:date>
</item>
<item rdf:about="http://ocamllabs.github.com/compiler-hacking/2013/09/17/compiler-hacking-july-2013">
	<title>Compiler Hacking: Inaugural compiler hackers meeting</title>
	<link>http://ocamllabs.github.com/compiler-hacking/2013/09/17/compiler-hacking-july-2013.html</link>
	<content:encoded>&lt;p&gt;&lt;img src=&quot;http://ocamllabs.github.io/compiler-hacking/imgs/2013-09-17.jpg&quot; alt=&quot;Compiler Hacking&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The first OCaml Labs compiler hacking session brought together around twenty people from &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/&quot;&gt;OCaml Labs&lt;/a&gt;, the wider &lt;a href=&quot;http://www.cl.cam.ac.uk&quot;&gt;Computer Lab&lt;/a&gt;, and &lt;a href=&quot;http://www.citrix.com/&quot;&gt;various&lt;/a&gt; &lt;a href=&quot;http://www.arm.com/&quot;&gt;companies&lt;/a&gt; around Cambridge for an enjoyable few hours learning about and improving the OCaml compiler toolchain, fuelled by &lt;a href=&quot;http://www.cherryboxpizza.co.uk&quot;&gt;pizza&lt;/a&gt; and home-made ice cream (thanks, &lt;a href=&quot;http://philippewang.info/CL/&quot;&gt;Philippe&lt;/a&gt;!).&lt;/p&gt;

&lt;p&gt;We benefited from the presence of a few &lt;a href=&quot;http://www.x9c.fr/&quot;&gt;experienced&lt;/a&gt; &lt;a href=&quot;http://danmey.org/&quot;&gt;compiler&lt;/a&gt; &lt;a href=&quot;http://lpw25.net/&quot;&gt;hackers&lt;/a&gt;, but for most of us it was the first attempt to modify the OCaml compiler internals.&lt;/p&gt;

&lt;p&gt;The first surprise of the day was the discovery that work on the &lt;a href=&quot;https://github.com/ocamllabs/compiler-hacking/wiki/Things-to-work-on&quot;&gt;list of projects&lt;/a&gt; was underway before we even arrived!  Keen collaborators from The Internet had apparently spotted our triaged bug reports and &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=4323&quot;&gt;submitted&lt;/a&gt; &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=4737&quot;&gt;patches&lt;/a&gt; to Mantis.&lt;/p&gt;

&lt;h3&gt;Standard library and runtime&lt;/h3&gt;

&lt;p&gt;There was an exciting moment early on when it emerged that two teams had been working independently on the same issue!  When &lt;a href=&quot;https://github.com/jonludlam&quot;&gt;Jon Ludlam&lt;/a&gt; and &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/euan.html&quot;&gt;Euan Harris&lt;/a&gt; submitted a patch to add a &lt;code&gt;get_extension&lt;/code&gt; function to the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/libref/Filename.html&quot;&gt;&lt;code&gt;Filename&lt;/code&gt;&lt;/a&gt; module they found that they had been pipped to the post by &lt;a href=&quot;https://github.com/mcclurmc/&quot;&gt;Mike McClurg&lt;/a&gt;.  There's still the judging stage to go, though, as the patches wait &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5807&quot;&gt;on Mantis&lt;/a&gt; for official pronouncement from the Inria team. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://github.com/vbmithr&quot;&gt;Vincent Bernardoff&lt;/a&gt; also spent some time improving the standard library, &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=4919&quot;&gt;fleshing out the interface for translating between OCaml and C error codes&lt;/a&gt;, starting from a patch by Goswin von Brederlow.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/stedolan&quot;&gt;Stephen Dolan&lt;/a&gt; looked at a &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=1956&quot;&gt;long-standing issue&lt;/a&gt; with names exported by the OCaml runtime that can clash with other libraries, and submitted a patch which hides the sole remaining offender for the runtime library.  As he noted in the comments, there are still a &lt;a href=&quot;https://gist.github.com/stedolan/6115403&quot;&gt;couple of hundred&lt;/a&gt; global names without the &lt;code&gt;caml_&lt;/code&gt; prefix in the &lt;code&gt;otherlibs&lt;/code&gt; section of the standard library.&lt;/p&gt;

&lt;h3&gt;Tools&lt;/h3&gt;

&lt;p&gt;There was a little flurry of work on new command-line options for the standard toolchain.&lt;/p&gt;

&lt;p&gt;A &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6102&quot;&gt;Mantis issue&lt;/a&gt; submitted by &lt;a href=&quot;http://gallium.inria.fr/%7Escherer/&quot;&gt;Gabriel Scherer&lt;/a&gt; suggests adding options to stop the compiler at certain stages, to better support tools such as &lt;a href=&quot;http://projects.camlcity.org/projects/findlib.html&quot;&gt;OCamlfind&lt;/a&gt; and to make it easier to debug the compiler itself.  The Ludlam / Harris team looked at this, and submitted a patch which provoked further thoughts from Gabriel.&lt;/p&gt;

&lt;p&gt;Vincent looked at extending &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/depend.html&quot;&gt;ocamldep&lt;/a&gt; with support for suffixes other than &lt;code&gt;.ml&lt;/code&gt; and &lt;code&gt;.mli&lt;/code&gt;.  Since &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=3725&quot;&gt;the issue&lt;/a&gt; was originally submitted, &lt;code&gt;ocamldep&lt;/code&gt; has acquired &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/depend.html#sec288&quot;&gt;&lt;code&gt;-ml-synonym&lt;/code&gt; and &lt;code&gt;-mli-synonym&lt;/code&gt; options&lt;/a&gt; that serve this purpose, so Vincent looked at supporting other suffixes in the compiler, and submitted a patch as a &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6110&quot;&gt;new issue&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The OCaml top level has a simple feature for setting up the environment —  when it starts up it looks for the file &lt;code&gt;.ocamlinit&lt;/code&gt;, and executes its contents.  It's sometimes useful to skip this stage and run the top level in a vanilla environment, so &lt;a href=&quot;https://github.com/dsheets&quot;&gt;David Sheets&lt;/a&gt; submitted a &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6071&quot;&gt;patch&lt;/a&gt; that adds a &lt;code&gt;-no-init&lt;/code&gt; option, &lt;a href=&quot;https://github.com/ocaml/ocaml/blob/fadcc73c50b89ca80ecc11131c9a23dbd2c1e67a/Changes#L35&quot;&gt;due for inclusion&lt;/a&gt; in the next release.&lt;/p&gt;

&lt;h3&gt;Error-handling/reporting&lt;/h3&gt;

&lt;p&gt;Error handling issues saw a good deal of activity.  &lt;a href=&quot;http://www.cl.cam.ac.uk/%7Erp452/&quot;&gt;Raphaël Proust&lt;/a&gt; submitted a patch to improve the &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6112&quot;&gt;reporting of error-enabled warnings&lt;/a&gt;; David investigated &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=3582&quot;&gt;handling out-of-range integer literals&lt;/a&gt; and &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5350&quot;&gt;return-code checking of C functions in the runtime&lt;/a&gt;, leading to some discussions on Mantis.  Stephen submitted a patch to improve the &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6182&quot;&gt;diagnostics for misuses of &lt;code&gt;virtual&lt;/code&gt;&lt;/a&gt;.  &lt;a href=&quot;http://www.cl.cam.ac.uk/%7Egk338/&quot;&gt;Gabriel Kerneis&lt;/a&gt; and Wojciech looked at some &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6109&quot;&gt;typos in ocamlbuild error messages&lt;/a&gt;, and Mike opened an &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=6108&quot;&gt;issue to clarify the appropriate use of the &lt;code&gt;compiler-libs&lt;/code&gt; package&lt;/a&gt;.&lt;/p&gt;

&lt;h3&gt;Language&lt;/h3&gt;

&lt;p&gt;The &lt;code&gt;open&lt;/code&gt; operation on modules can make it difficult for readers of a program to see where particular names are introduced, so its use is sometimes discouraged.  The basic feature of making names available without a module prefix is rather useful, though, so various new features (including &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual021.html#toc77&quot;&gt;local opens&lt;/a&gt;, &lt;a href=&quot;https://github.com/ocaml/ocaml/commit/f51bc04b55fbe22533f1075193dd3b2e52721f15&quot;&gt;warnings for shadowing&lt;/a&gt;, and &lt;a href=&quot;https://github.com/ocaml/ocaml/commit/a3b1c67fffd7de640ee9a0791f1fd0fad965b867&quot;&gt;explicit shadowing&lt;/a&gt;) have been introduced to tame its power. Stephen looked at adding a further feature, making it possible to open modules under a particular signature, so that &lt;code&gt;open M : S&lt;/code&gt; will introduce only those names in &lt;code&gt;M&lt;/code&gt; that are specified with &lt;code&gt;S&lt;/code&gt;.  There's an &lt;a href=&quot;https://github.com/lpw25/ocaml/tree/signatured-open&quot;&gt;initial prototype&lt;/a&gt; already, and we're looking forward to seeing the final results.&lt;/p&gt;

&lt;p&gt;The second language feature of the evening was support for infix operators (such as the List constructor, &lt;code&gt;::&lt;/code&gt;) for user-defined types, a feature that is definitely not in any way motivated by envy of Haskell.  Mike's &lt;a href=&quot;https://github.com/mcclurmc/ocaml/tree/infix-constructors&quot;&gt;prototype implementation&lt;/a&gt; is available, and there's an &lt;a href=&quot;https://github.com/mcclurmc/ocaml/pull/1&quot;&gt;additional patch&lt;/a&gt; that brings it closer to completion.&lt;/p&gt;

&lt;h3&gt;Next session&lt;/h3&gt;

&lt;p&gt;The next session is planned for 6pm on Wednesday 18th September 2013 at
&lt;a href=&quot;http://makespace.org/&quot;&gt;Makespace, Cambridge&lt;/a&gt;.  If you're planning to come along it'd be
helpful if you could add yourself to the &lt;a href=&quot;http://doodle.com/k6y2tiihkrb5vuw4&quot;&gt;Doodle Poll&lt;/a&gt;.  Hope to see
you there!&lt;/p&gt;</content:encoded>
	<dc:date>2013-09-17T11:49:04+00:00</dc:date>
	<dc:creator>OCaml Labs</dc:creator>
</item>
<item rdf:about="http://anil.recoil.org/2013/09/16/camlpdf-the-end-of-sucky-pdf-tools">
	<title>Anil Madhavapeddy: Camlpdf, the first good command-line PDF tool I've found</title>
	<link>http://anil.recoil.org/2013/09/16/camlpdf-the-end-of-sucky-pdf-tools.html</link>
	<content:encoded>&lt;p&gt;The fine folks at O&amp;#8217;Reilly have been proof-reading the &lt;a href=&quot;https://realworldocaml.org&quot;&gt;Real World OCaml&lt;/a&gt; book that I&amp;#8217;ve been working on. My heart leapt with joy when the copyeditor commented that she thought it was very well written, but my joy was short-lived when it turns out that all her comments were safely ensconced as PDF comments. A few hundreds comments that required a response from us, too.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&amp;#8220;No problem! MacOS X Preview can handle these!&amp;#8221;&lt;/em&gt; was of course my first response, but it turns out it&amp;#8217;s totally broken with PDF notes. The first note that you select will appear as the content of all the other subsequent notes. Yaron Minsky then experimented with Adobe Acrobat, which I&amp;#8217;ve sworn never to install again after an unfortunate incident involving the uninstaller a couple of years ago. That turned out to be incredibly slow. I tried a few open-source tools such as &lt;a href=&quot;http://en.wikipedia.org/wiki/Skim_(software)&quot;&gt;Skim&lt;/a&gt; which, while otherwise an excellent bit of software, couldn&amp;#8217;t render these particular annotations.&lt;/p&gt;
&lt;table&gt;
&lt;tr&gt;&lt;td&gt;
&lt;a href=&quot;http://anil.recoil.org/images/anil-jumping-acropolis.jpg&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/anil-jumping-acropolis-thumb.jpg&quot; width=&quot;207&quot; /&gt;&lt;/a&gt;
&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td width=&quot;210&quot;&gt;&lt;i&gt;&lt;small&gt;I &lt;a href=&quot;http://www.theguardian.com/media/mind-your-language/2012/jan/29/literally-a-much-misused-word&quot;&gt;literally&lt;/a&gt; jumped off my seat upon discovering cpdf.&lt;/small&gt;&lt;/i&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;p&gt;Meanwhile, John Whitington just announced the release of the &lt;a href=&quot;http://coherentpdf.com/blog/?p=68&quot;&gt;Coherent PDF&lt;/a&gt; command-line tools. Since these are all written in OCaml (and have been developed over quite a few years now), he also sent in an OPAM &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/pull/977&quot;&gt;pull request&lt;/a&gt; to add it to the database. And most conveniently, this ended up solving my little PDF conundrum in less than an hour of hacking, and has almost cured me of my lifelong fear of dealing with anything in a PDF-like format. Here&amp;#8217;s what I did:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;I installed the tools via &lt;code&gt;opam install cpdf&lt;/code&gt;. This installed the library but not the binary (&lt;a href=&quot;https://github.com/OCamlPro/opam-repository/pull/1100&quot;&gt;swiftly fixed&lt;/a&gt;).&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;Reading the license told me that it&amp;#8217;s for non-commercial use only, so I bought a license from the &lt;a href=&quot;http://coherentpdf.com&quot;&gt;Coherent PDF&lt;/a&gt; website (a bargain price, given how much it does!).&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;I ran &lt;code&gt;cpdf -list-annotations&lt;/code&gt; over the PDF, and it dumped out all the comments as a text file to stdout. This wasn&amp;#8217;t quite enough for me, since I needed to match the annotation to a page number. But since John has released it as open-source, I forked the repository and patched the support directly into the command-line tools, and sent a &lt;a href=&quot;https://github.com/johnwhitington/cpdf-source/pull/2&quot;&gt;pull request&lt;/a&gt; back over to John. Since it&amp;#8217;s under a non-standard license, I decided to place my patch in the public domain to make it easier for him to accept it if he chooses.&lt;/p&gt;
&lt;/li&gt;

&lt;li&gt;
&lt;p&gt;My co-authors can just run &lt;code&gt;opam pin cpdf git://github.com/avsm/cpdf-source#annotation-page-numbers&lt;/code&gt; to pin their local copy of CPDF to my forked branch in their own OPAM installations, and easily use my copy until John gets a chance to integrate my changes properly upstream.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Total time including this blog post: 40 minutes. Now, onto fixing the author responses comments for Real World OCaml now. I&amp;#8217;m so happy to have &lt;code&gt;cpdf&lt;/code&gt; as a simple, hackable PDF utility, as it does things like page combining and rotations that have always been a little flaky in other tools for me. It&amp;#8217;s the &lt;a href=&quot;http://johnmacfarlane.net/pandoc/&quot;&gt;Pandoc&lt;/a&gt; of PDFs!&lt;/p&gt;</content:encoded>
	<dc:date>2013-09-15T23:00:00+00:00</dc:date>
</item>
<item rdf:about="http://hh360.user.srcf.net/blog/?p=153">
	<title>Heidi Howard: OCaml Development in Vim</title>
	<link>http://hh360.user.srcf.net/blog/2013/09/ocaml-development-in-vim/</link>
	<content:encoded>&lt;p&gt;This is a quick run-through of how I set up my development environment in vim:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Install pathogen.vim&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot;&gt;&lt;span&gt;mkdir&lt;/span&gt; &lt;span&gt;-p&lt;/span&gt; ~&lt;span&gt;/&lt;/span&gt;.vim&lt;span&gt;/&lt;/span&gt;autoload ~&lt;span&gt;/&lt;/span&gt;.vim&lt;span&gt;/&lt;/span&gt;bundle; \
curl &lt;span&gt;-Sso&lt;/span&gt; ~&lt;span&gt;/&lt;/span&gt;.vim&lt;span&gt;/&lt;/span&gt;autoload&lt;span&gt;/&lt;/span&gt;pathogen.vim \
    https:&lt;span&gt;//&lt;/span&gt;raw.github.com&lt;span&gt;/&lt;/span&gt;tpope&lt;span&gt;/&lt;/span&gt;vim-pathogen&lt;span&gt;/&lt;/span&gt;master&lt;span&gt;/&lt;/span&gt;autoload&lt;span&gt;/&lt;/span&gt;pathogen.vim&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;Add the following to ~/.vimrc:&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;vim&quot;&gt;&lt;span&gt;execute&lt;/span&gt; pathogen#infect&lt;span&gt;&amp;#40;&lt;/span&gt;&lt;span&gt;&amp;#41;&lt;/span&gt;
&lt;span&gt;syntax&lt;/span&gt; &lt;span&gt;on&lt;/span&gt;
&lt;span&gt;filetype&lt;/span&gt; &lt;span&gt;plugin&lt;/span&gt; &lt;span&gt;indent&lt;/span&gt; &lt;span&gt;on&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Install Syntastic &lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot;&gt;&lt;span&gt;cd&lt;/span&gt; ~&lt;span&gt;/&lt;/span&gt;.vim&lt;span&gt;/&lt;/span&gt;bundle
&lt;span&gt;git clone&lt;/span&gt; https:&lt;span&gt;//&lt;/span&gt;github.com&lt;span&gt;/&lt;/span&gt;scrooloose&lt;span&gt;/&lt;/span&gt;syntastic.git&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;Then quit vim and used :Helptags to check installs so far have worked.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Install Merlin&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot;&gt;opam switch 4.01.0dev+trunk
opam update
opam upgrade
opam &lt;span&gt;install&lt;/span&gt; merlin&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;Add the following to ~/.vimrc&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;vim&quot;&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;set&lt;/span&gt; &lt;span&gt;rtp&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;=&lt;span&gt;~/.&lt;/span&gt;opam&lt;span&gt;/&lt;/span&gt;4&lt;span&gt;.&lt;/span&gt;01&lt;span&gt;.&lt;/span&gt;0dev&lt;span&gt;+&lt;/span&gt;trunk&lt;span&gt;/&lt;/span&gt;share&lt;span&gt;/&lt;/span&gt;ocamlmerlin&lt;span&gt;/&lt;/span&gt;vim
&lt;span&gt;:&lt;/span&gt;&lt;span&gt;set&lt;/span&gt; &lt;span&gt;rtp&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;=&lt;span&gt;~/.&lt;/span&gt;opam&lt;span&gt;/&lt;/span&gt;4&lt;span&gt;.&lt;/span&gt;01&lt;span&gt;.&lt;/span&gt;0dev&lt;span&gt;+&lt;/span&gt;trunk&lt;span&gt;/&lt;/span&gt;share&lt;span&gt;/&lt;/span&gt;ocamlmerlin&lt;span&gt;/&lt;/span&gt;vimbufsync
&lt;span&gt;let&lt;/span&gt; g&lt;span&gt;:&lt;/span&gt;syntastic_ocaml_checkers=&lt;span&gt;&amp;#91;&lt;/span&gt;&lt;span&gt;'merlin'&lt;/span&gt;&lt;span&gt;&amp;#93;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;:SyntasticInfo will return a list of syntax checkers available to Syntastic, check that this now includes merlin&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Install OCP Indent&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;bash&quot;&gt;opam &lt;span&gt;install&lt;/span&gt; ocp-indent&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;

&lt;p&gt;Add the following to ~/.vimrc&lt;/p&gt;

&lt;div class=&quot;wp_syntax&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;vim&quot;&gt;&lt;span&gt;autocmd&lt;/span&gt; &lt;span&gt;FileType&lt;/span&gt; ocaml source &lt;span&gt;/&lt;/span&gt;home&lt;span&gt;/&lt;/span&gt;heidi&lt;span&gt;-&lt;/span&gt;ann&lt;span&gt;/.&lt;/span&gt;opam&lt;span&gt;/&lt;/span&gt;4&lt;span&gt;.&lt;/span&gt;01&lt;span&gt;.&lt;/span&gt;0dev&lt;span&gt;+&lt;/span&gt;trunk&lt;span&gt;/&lt;/span&gt;share&lt;span&gt;/&lt;/span&gt;typerex&lt;span&gt;/&lt;/span&gt;ocp&lt;span&gt;-&lt;/span&gt;&lt;span&gt;indent&lt;/span&gt;&lt;span&gt;/&lt;/span&gt;ocp&lt;span&gt;-&lt;/span&gt;&lt;span&gt;indent&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;vim&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;</content:encoded>
	<dc:date>2013-09-09T07:51:03+00:00</dc:date>
</item>
<item rdf:about="http://anil.recoil.org/2013/09/09/ocamlot-autotriaging">
	<title>Anil Madhavapeddy: OCamlot--exploring the edges of OPAM packages</title>
	<link>http://anil.recoil.org/2013/09/09/ocamlot-autotriaging.html</link>
	<content:encoded>&lt;p&gt;The new release of OCaml (4.01.0) was just &lt;a href=&quot;https://sympa.inria.fr/sympa/arc/caml-list/2013-09/msg00173.html&quot;&gt;announced&lt;/a&gt;! The runup to a major release like this is normally a frantic time to test that your favourite applications don&amp;#8217;t break unexpectedly due to some incompatible language feature. This release cycle has a little different though, as we&amp;#8217;ve been working hard on using the &lt;a href=&quot;http://opam.ocamlpro.com&quot;&gt;OPAM&lt;/a&gt; package database to build an online regression testing infrastructure to mechanize much of this process.&lt;/p&gt;

&lt;p&gt;I wanted to share some of what OCamlot does today, some of the results from about 3 months worth of runs that may help OCaml package maintainers, and finally where we&amp;#8217;re going with future developments. This work has been done in collaboration with &lt;a href=&quot;http://www.cl.cam.ac.uk/projects/ocamllabs/people/sheets.html&quot;&gt;David Sheets&lt;/a&gt; (who built the OCamlot daemon) and the OPAM team ably led by &lt;a href=&quot;http://gazagnaire.org&quot;&gt;Thomas Gazagnaire&lt;/a&gt; at &lt;a href=&quot;http://ocamlpro.com&quot;&gt;OCamlPro&lt;/a&gt;. We&amp;#8217;ve also had a lot of help from &lt;a href=&quot;https://github.com/diml&quot;&gt;Jeremie Dimino&lt;/a&gt; and &lt;a href=&quot;https://github.com/ysulsky&quot;&gt;Yury Sulsky&lt;/a&gt; from Jane Street and &lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave Scott&lt;/a&gt; and &lt;a href=&quot;http://jon.recoil.org&quot;&gt;Jon Ludlam&lt;/a&gt; from Citrix acting as guinea pigs for their respective regular releases of the &lt;a href=&quot;https://github.com/janestreet&quot;&gt;Core&lt;/a&gt; and &lt;a href=&quot;https://github.com/xapi-project&quot;&gt;Xen/XAPI&lt;/a&gt; releases to OPAM.&lt;/p&gt;

&lt;h2 id=&quot;towards_a_truely_portable_ocaml&quot;&gt;Towards a truely portable OCaml&lt;/h2&gt;

&lt;p&gt;The upstream OCaml toolchain is built on very UNIX-like principles, with a number of command-line tools that form a build pipeline. This process usually ends with linking the intermediate object files with a &lt;a href=&quot;https://github.com/ocaml/ocaml/tree/trunk/byterun&quot;&gt;runtime library&lt;/a&gt; that provides the garbage collector and other intrinsic OS functions.&lt;/p&gt;

&lt;p&gt;Given these raw compiler tools, it&amp;#8217;s very easy to compile OCaml into all sorts of weird and wonderful architectures. We&amp;#8217;ve seen it run on &lt;a href=&quot;http://www.algo-prog.info/ocaml_for_pic/web/index.php&quot;&gt;8-bit PICs&lt;/a&gt;, several efficient Javascript backends (originally &lt;a href=&quot;http://jaked.github.io/ocamljs/&quot;&gt;ocamljs&lt;/a&gt; and more recently &lt;a href=&quot;http://ocsigen.org/js_of_ocaml&quot;&gt;js_of_ocaml&lt;/a&gt;), and of course my own &lt;a href=&quot;http://openmirage.org&quot;&gt;Mirage&lt;/a&gt; Xen unikernel.&lt;/p&gt;

&lt;p&gt;While the compiler tools themselves are quite portable and work on almost any UNIX-like system, the build system scaffolding around third-party packages is less portable. Some features such as C bindings often contribute to build breakage on some less-used operating systems such as FreeBSD or OpenBSD, as they usually require probing for header file locations or adding custom &lt;code&gt;CFLAGS&lt;/code&gt; before building.&lt;/p&gt;
&lt;table align=&quot;center&quot; width=&quot;90%&quot;&gt;
&lt;tr&gt;
&lt;td class=&quot;bimg&quot; width=&quot;30%&quot;&gt;&lt;a href=&quot;http://anil.recoil.org/images/dreamplug-nest-1.jpg&quot;&gt;&lt;img border=&quot;0&quot; src=&quot;http://anil.recoil.org/images/dreamplug-nest-1-thumb.jpg&quot; width=&quot;200&quot; /&gt;&lt;/a&gt;&lt;br /&gt;Every Internet of Things starts with a tangled pile of ARM Dreamplugs.&lt;/td&gt;
&lt;td class=&quot;bimg&quot; width=&quot;30%&quot;&gt;&lt;a href=&quot;http://anil.recoil.org/images/sparc-macppc-openbsd-1.jpg&quot;&gt;&lt;img border=&quot;0&quot; src=&quot;http://anil.recoil.org/images/sparc-macppc-openbsd-1-thumb.jpg&quot; width=&quot;200&quot; /&gt;&lt;/a&gt;&lt;br /&gt;And in our server room, venerable Sparc and PowerPC G4 OpenBSD boxen still live.&lt;/td&gt;
&lt;td class=&quot;bimg&quot; width=&quot;30%&quot;&gt;&lt;a href=&quot;http://anil.recoil.org/images/macppc-desktop-1.jpg&quot;&gt;&lt;img border=&quot;0&quot; src=&quot;http://anil.recoil.org/images/macppc-desktop-1-thumb.jpg&quot; width=&quot;200&quot; /&gt;&lt;/a&gt;&lt;br /&gt;Finding older machines is getting tough, but here's &lt;a href=&quot;http://dave.recoil.org&quot;&gt;Dave's&lt;/a&gt; old iMac G5 running Linux.&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;p&gt;Most OCaml developers use x86-based machines and so foreign architectures also get less day-to-day testing (OCaml has superb support for fast native code compilation on ARM, PowerPC, Sparc32, and we&amp;#8217;re working on MIPS64 here as part of the &lt;a href=&quot;http://www.cl.cam.ac.uk/research/security/ctsrd/cheri.html&quot;&gt;CHERI&lt;/a&gt; project).&lt;/p&gt;

&lt;p&gt;We want to make sure that OCaml and its package ecosystem works just as well in the embedded ecosystem as well as it does on vanilla x86 Linux. This includes running on my Linux iMac G5, my &lt;a href=&quot;https://wiki.freebsd.org/FreeBSD/arm/Raspberry%20Pi&quot;&gt;FreeBSD Raspberry Pi&lt;/a&gt;, my &lt;a href=&quot;http://www.openbsd.org/beagle.html&quot;&gt;OpenBSD Pandaboard&lt;/a&gt;, or even on a bytecode-only architecture like an &lt;a href=&quot;http://www.openbsd.org/sparc64.html&quot;&gt;OpenBSD/Sparc64&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In the longer term, this paves the way to reliable cross-compiled packages for Windows, &lt;a href=&quot;https://github.com/vouillon/ocaml-android&quot;&gt;Android&lt;/a&gt; and &lt;a href=&quot;http://psellos.com/ocaml/compile-to-iphone.html&quot;&gt;iPhone&lt;/a&gt; (all of which have OCaml ports, but aren&amp;#8217;t heavily tested with the full package database). The only practical way to get started on this is by building an automated test infrastructure for OCaml that explores the feature matrix (which eerily for me, happened in the early days of Xen too, via &lt;a href=&quot;http://blogs.citrix.com/2013/08/30/xenserver-automated-testing-and-lab-orchestration-introducing-xenrt/&quot;&gt;XenRT&lt;/a&gt; to stabilize the hypervisor).&lt;/p&gt;

&lt;h3 id=&quot;why_not_jenkins_or_travis&quot;&gt;Why not Jenkins or Travis?&lt;/h3&gt;

&lt;p&gt;When we first started hacking on the OPAM testing infrastructure earlier this year, I maintained a local &lt;a href=&quot;http://jenkins-ci.org&quot;&gt;Jenkins&lt;/a&gt; installation that monitored the repository. While Jenkins is a superb tool for many continuous integration tasks, it fell over badly when trying to use it on the non-x86 and non-Linux (or Windows) operating systems. Jenkins requires a full Java runtime stack to be available on each of the client machines, which was taking up more time to get up and running than a simple OCaml-based client and server that could compile to both portable bytecode or fast native code.&lt;/p&gt;

&lt;p&gt;The other difficulty with OPAM is selecting which packages actually need to be tested, as it has a constraint-based package solver that supports expressive forwards and backwards version restrictions. While basic tests of the latest packages worked with Jenkins, we needed to increasingly customize it to automate interfacing directly with the OPAM libraries and calculating test schedules based on incoming change requests.&lt;/p&gt;

&lt;p&gt;Another factor that ruled out depending on hosted services such as &lt;a href=&quot;https://travis-ci.org&quot;&gt;Travis&lt;/a&gt; is that they tend to support x86-only architectures, whereas we really want to test the full spectrum of CPU variants supported by OCaml. This doesn&amp;#8217;t mean that there&amp;#8217;s no place for Travis of course, and in fact Mike Lin has already &lt;a href=&quot;http://blog.mlin.net/2013/02/testing-ocaml-projects-on-travis-ci.html&quot;&gt;made this work&lt;/a&gt; with OPAM.&lt;/p&gt;

&lt;p&gt;For our full testing needs though, &lt;a href=&quot;https://github.com/ocamllabs/ocamlot&quot;&gt;OCamlot&lt;/a&gt; was born: an OCaml client and server system which coordinates different versions of the compiler, architectures and OPAM versions and records the results for triage and fixing issues.&lt;/p&gt;

&lt;h3 id=&quot;running_ocamlot&quot;&gt;Running OCamlot&lt;/h3&gt;

&lt;p&gt;The latest alpha release of OCamlot is pretty straightforward to run locally, if you are so inclined. First start a server process:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git clone git://github.com/ocamllabs/ocamlot
$ cd ocamlot
$ ./install_deps.sh
$ oasis setup
# (edit lib/config.ml if you need to change ports)
$ make
$ ./_build/lib/ocamlot_cmd.native --help
$ ./_build/lib/ocamlot_cmd.native serve&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The server listens on localhost only by default, and normally an SSL-to-TCP proxy is deployed to listen for external connections (I use &lt;a href=&quot;https://github.com/bumptech/stud&quot;&gt;stud&lt;/a&gt;, which is fast and easy to configure).&lt;/p&gt;

&lt;p&gt;The OCamlot clients require a local compilation of OCaml, and they autodetect their local CPU architecture and operating system. I&amp;#8217;ve put a &lt;a href=&quot;https://gist.github.com/avsm/6393649&quot;&gt;gist script&lt;/a&gt; together that automates this on most Linux and BSD variants. Just customize the top variables (set &lt;code&gt;MAKE&lt;/code&gt; to &lt;code&gt;gmake&lt;/code&gt; under BSD) and set the hostname to your server process.&lt;/p&gt;

&lt;h3 id=&quot;the_results_repository_and_autotriage&quot;&gt;The results repository and auto-triage&lt;/h3&gt;

&lt;p&gt;Once the client is running, the server dispatches tasks from its test matrix, which is calculated from the OPAM package repository. The server maintains a &lt;a href=&quot;https://github.com/ocamlot/ocamlot-state&quot;&gt;results repository&lt;/a&gt;, which is a Git filesystem database that records the build results and logs via an s-expression per task. It also uses &lt;a href=&quot;https://github.com/mirage/ocaml-cohttp&quot;&gt;Cohttp&lt;/a&gt; to serve up the results for a web browser.&lt;/p&gt;

&lt;p&gt;It&amp;#8217;s very convenient using Git repositories like this since we can use GitHub (or any other Git host) to coordinate and record results, and restart the server without needing any local state. So convenient, in fact, that Thomas and I have been working on a more formal engine for this called &lt;a href=&quot;https://github.com/samoht/irminsule&quot;&gt;Irminsule&lt;/a&gt; (more on that in a later post, though).&lt;/p&gt;

&lt;p&gt;It&amp;#8217;s almost unheard of to have a full OCamlot run go by without some errors, and so David put together the &lt;code&gt;ocamlot triage&lt;/code&gt; command. This takes the state repository and runs a set of regular expressions over it to classify them into common errors. The full file is &lt;a href=&quot;https://github.com/ocamllabs/ocamlot/blob/master/lib/result.ml&quot;&gt;here&lt;/a&gt;, but an excerpt should give you an idea of what we look for:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml&quot;&gt;	&lt;span class=&quot;c&quot;&gt;(* ordered minor to severe *)&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;analysis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solver&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;solver_error&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;option&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Dep&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;analysis&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Transient&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transient_error&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;system_error&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Meta&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;meta_error&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Ext_dep&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ext_dep_error&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Build&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;build_error&lt;/span&gt;
	  &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Multiple&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;analysis&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;list&lt;/span&gt;
	    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sexp&lt;/span&gt;
	
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The errors are ordered by severity to aid in color highlighting. They start with OPAM solver failures and dependency failures (e.g. due to trying to build a package that requires a specific OCaml version that isn&amp;#8217;t available), and move onto missing package dependencies or system libraris.&lt;/p&gt;

&lt;h2 id=&quot;testing_the_run_up_to_ocaml_401&quot;&gt;Testing the run up to OCaml 4.01&lt;/h2&gt;

&lt;p&gt;Of course, running all these tests is useless without taking action on the results. I&amp;#8217;ve been keeping track of them in &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/issues/1029&quot;&gt;issue #1029&lt;/a&gt;. The nice thing about GitHub issues is that when this bug is referenced in commits (even in other repositories) a cross-reference shows up on that webpage and lets everything be tracked nicely.&lt;/p&gt;

&lt;p&gt;So what were the most common failures in the runup to 4.01, and what should you avoid when writing your own code?&lt;/p&gt;

&lt;h3 id=&quot;different_standard_library_module_signatures&quot;&gt;Different standard library module signatures&lt;/h3&gt;

&lt;p&gt;There have been a few changes to some of the functor signatures in the standard library, such as adding a &lt;code&gt;find&lt;/code&gt; function to Set (&lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5864&quot;&gt;mantis #5864&lt;/a&gt;). A third-party library that tries to match the functor signature will fail to compile with a type error, such as this one below for &lt;a href=&quot;http://anil.recoil.org/feeds/atom-ocaml.xml&quot;&gt;zipperposition.0.2&lt;/a&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Error: The implementation src/ptset.ml
       does not match the interface src/ptset.cmi:
       ...
       In module Big:
       The field `find' is required but not provided&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The relevant code in &lt;code&gt;zipperposition&lt;/code&gt; makes it clear what the problem is:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ocaml&quot;&gt;	&lt;span class=&quot;c&quot;&gt;(* Big-endian Patricia trees *)&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Big&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;sig&lt;/span&gt;
	  &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;S&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;
	  &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intersect&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
	
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This particular bug was &lt;a href=&quot;https://github.com/c-cube/zipperposition/issues/1&quot;&gt;reported upstream&lt;/a&gt;, and the fix requires implementing the &lt;code&gt;find&lt;/code&gt; function for the Patricia-tree-based &lt;code&gt;Set&lt;/code&gt;. Since the OPAM package will always be broken on OCaml 4.01, it was marked with a &lt;a href=&quot;https://github.com/ocamlpro/opam-repository/commit/e45530205987f67d4316a958446d3dcc954b19ec&quot;&gt;compiler version constraint&lt;/a&gt; to prevent it being selected for installation under that compiler. When a new version with the fix is uploaded to OPAM, it will always be selected in preference to this broken one.&lt;/p&gt;

&lt;p&gt;One other 4.01 change that temporarily broke most of the bigger networking libraries such as &lt;a href=&quot;https://github.com/janestreet/core&quot;&gt;Core&lt;/a&gt;, &lt;a href=&quot;https://ocsigen.org/lwt&quot;&gt;Lwt&lt;/a&gt; and &lt;a href=&quot;http://batteries.forge.ocamlcore.org&quot;&gt;Batteries&lt;/a&gt; was the addition of the &lt;a href=&quot;http://caml.inria.fr/mantis/view.php?id=5568&quot;&gt;close-on-exec&lt;/a&gt; flag to the &lt;code&gt;Unix&lt;/code&gt; module. This change only affects upstream packages that redefine the UNIX module for their own purposes (such as adding an asynchronous I/O monad as Lwt does), hence it affects the standard library replacement packages.&lt;/p&gt;

&lt;p&gt;The fix here was to locally add patches into the relevant OPAM packages to immediately unbreak things when the fix when into the 4.01 branch of the compiler, and notify upstream maintainers to release new versions of their projects. There&amp;#8217;s a subtle problem here: when a patch such as this goes into an unreleased branch of the compiler (such as &lt;code&gt;4.01.0dev&lt;/code&gt;), it&amp;#8217;s hard to reliably detect if the user has got the very latest version of the compiler or not. If you do have problems like this in the future, try recompiling via &lt;code&gt;opam switch reinstall &amp;lt;version&amp;gt;&lt;/code&gt; to the latest branch.&lt;/p&gt;

&lt;p&gt;It&amp;#8217;s very useful to be able to drop in bleeding-edge compiler tools into the OPAM repository using compiler constraints like this. For an example, see Alain Frisch&amp;#8217;s &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/blob/master/packages/ppx_tools.0.1/opam&quot;&gt;ppx_tools&lt;/a&gt;, that require the very latest 4.02dev trunk release to compile his new extension-points feature.&lt;/p&gt;

&lt;h3 id=&quot;multiple_object_definitions&quot;&gt;Multiple object definitions&lt;/h3&gt;

&lt;p&gt;OCaml 4.01 also restricts multiple method definitions with the same name in the same object. This leaves only inheritance as the way to override method names, but some packages such as OCamlnet and Mlorg had minor uses of the old mechanism.&lt;/p&gt;

&lt;p&gt;You can see this by using &lt;code&gt;opam switch&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ opam switch 4.00.1
$ eval `opam config env`
$ ocaml
# object method x = 1 method x = 2 end;;
- : &amp;lt; x : int &amp;gt; = &amp;lt;obj&amp;gt;
$ opam switch 4.01.0
$ eval `opam config env`
$ ocaml
# object method x = 1 method x = 2 end;;
Error: The method `x' has multiple definitions in this object&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;new_warnings_and_the_dreaded_warningsaserrors&quot;&gt;New warnings, and the dreaded warnings-as-errors&lt;/h3&gt;

&lt;p&gt;After a decade of being deprecated, the &lt;code&gt;(or)&lt;/code&gt; and &lt;code&gt;(&amp;amp;)&lt;/code&gt; operators finally had a warning turned on by default.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ocaml
# true or false;;
Warning 3: deprecated feature: operator (or); you should use (||) instead
- : bool = true&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This wouldn&amp;#8217;t normally be so bad, except that a surprising number of released packages also turn warnings into fatal errors (by using the &lt;code&gt;-w @&lt;/code&gt; flags explained in the &lt;a href=&quot;http://caml.inria.fr/pub/docs/manual-ocaml/comp.html&quot;&gt;manual&lt;/a&gt;). Warnings-as-errors is extremely useful when &lt;em&gt;developing&lt;/em&gt; code but is rather harmful in released code, since a future compiler can choose to emit new warnings that aren&amp;#8217;t necessarily fatal bugs.&lt;/p&gt;

&lt;p&gt;Packages that failed like this include ocamlgraph, spotlib, quickcheck, OPA, Lablgtk-extras and many more. Please do make an effort to not leave this option turned on in your packages, or else it makes life more difficult for testing your code on bleeding edge versions of the compiler in the future.&lt;/p&gt;

&lt;p&gt;It&amp;#8217;s worth noting here that OCaml 4.01 has introduced a fair number of new and very useful warnings across a number of areas, mainly to do with detecting unexpected ambiguation or shadowing of values. I&amp;#8217;ll cover more on these in a future post about the new 4.01 goodies.&lt;/p&gt;

&lt;h3 id=&quot;external_system_dependencies&quot;&gt;External system dependencies&lt;/h3&gt;

&lt;p&gt;While there any many packages in OPAM that are pure OCaml, there are also a substantial number that require other system tools to be installed. The Lablgtk GUI library obviously requires the C &lt;code&gt;gtk&lt;/code&gt; library to be installed.&lt;/p&gt;

&lt;p&gt;Determining if these libraries are installed on a particular OS is well beyond the scope of OPAM, as there are almost as many package managers as there are operating systems. However, it&amp;#8217;s important for automated testing and user-friendly error messages to have some notion of detecting if the environment is ready for the OCaml package or not.&lt;/p&gt;

&lt;p&gt;We&amp;#8217;re solving this by using a &lt;code&gt;depexts&lt;/code&gt; field in OPAM that consists of a set of tags that identify OS-specific packages that need to be present. A separate script can query these tags from OPAM and do the OS-specific tests or installation.&lt;/p&gt;

&lt;p&gt;For example, here&amp;#8217;s the &lt;code&gt;sqlite3-ocaml&lt;/code&gt; OPAM description:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;opam-version: &amp;quot;1&amp;quot;
maintainer: &amp;quot;markus.mottl@gmail.com&amp;quot;
build: [
  [&amp;quot;ocaml&amp;quot; &amp;quot;setup.ml&amp;quot; &amp;quot;-configure&amp;quot;]
  [&amp;quot;ocaml&amp;quot; &amp;quot;setup.ml&amp;quot; &amp;quot;-build&amp;quot;]
  [&amp;quot;ocaml&amp;quot; &amp;quot;setup.ml&amp;quot; &amp;quot;-install&amp;quot;]
]
remove: [ [&amp;quot;ocamlfind&amp;quot; &amp;quot;remove&amp;quot; &amp;quot;sqlite3&amp;quot;] ]
depends: [&amp;quot;ocamlfind&amp;quot;]
depexts: [
  [ [&amp;quot;debian&amp;quot;  ] [ &amp;quot;libsqlite3-dev&amp;quot;]    ]
  [ [&amp;quot;freebsd&amp;quot; ] [ &amp;quot;database/sqlite3&amp;quot;]  ]
  [ [&amp;quot;openbsd&amp;quot; ] [ &amp;quot;database/sqlite3&amp;quot;]  ]
]&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;depexts&lt;/code&gt; field here lists APT package for Debian, and the ports tree locations for FreeBSD and OpenBSD. It could also list more specialised tags for particular versions of an OS. You can query this from OPAM as follows:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ opam install -e debian sqlite3-ocaml
libsqlite3-dev
$ opam install -e openbsd sqlite3-ocaml
database/sqlite3&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;OCamlot therefore needs to query the &lt;code&gt;depexts&lt;/code&gt; field from the package and run the right &lt;code&gt;apt&lt;/code&gt; or &lt;code&gt;pkg_add&lt;/code&gt; commands. I&amp;#8217;ll write about this in more detail when it&amp;#8217;s fully baked, as we&amp;#8217;ve modified the semantics of the tag querying between OPAM 1.0 and OPAM 1.1 to make it easier to use in OCamlot.&lt;/p&gt;

&lt;h3 id=&quot;portable_shell_scripts&quot;&gt;Portable shell scripts&lt;/h3&gt;

&lt;p&gt;Once we&amp;#8217;ve gotten past the hurdle of the compiler version causing failures, there is the small matter of testing non-Linux operating systems, as well as non-x86 CPU architectures. The &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/issues/1029&quot;&gt;#1029 overview&lt;/a&gt; lists many of these failures under the Portability section.&lt;/p&gt;
&lt;a href=&quot;http://www.openbsd.org&quot;&gt;&lt;img src=&quot;http://anil.recoil.org/images/ppuf200X181.gif&quot; /&gt;&lt;/a&gt;
&lt;p&gt;Damien Doligez made some excellent points about how to write &lt;a href=&quot;http://gallium.inria.fr/blog/portable-conditionals-in-makefiles/&quot;&gt;portable Makefiles&lt;/a&gt; that works across both GNU and BSD makes. This is why the carefully crafted OCaml Makefiles do not require GNU make to be installed when compiling on FreeBSD or OpenBSD (MacOS X gave up the fight a long time ago and installs GNU make as its default &lt;code&gt;make&lt;/code&gt; command).&lt;/p&gt;

&lt;p&gt;OPAM tries to help out BSD by providing a &lt;code&gt;make&lt;/code&gt; macro in &lt;code&gt;opam&lt;/code&gt; files that is substituted with either &lt;code&gt;&amp;quot;make&amp;quot;&lt;/code&gt; (by default) or &lt;code&gt;&amp;quot;gmake&amp;quot;&lt;/code&gt; (for BSD). While this works for for the toplevel invocation of the Makefile, it fails if the Makefile recursively invokes further targets without using the &lt;code&gt;$(MAKE)&lt;/code&gt; variable instead of directly calling the command. Patching these sorts of things is easy but tedious: see the &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/blob/master/packages/facile.1.1/files/bsdmake.patch&quot;&gt;patchfile&lt;/a&gt; for the Facile constraint programming library for an example.&lt;/p&gt;

&lt;p&gt;The real problem here, of course, is that package maintainers cannot be reasonably expected to test their code on systems that they don&amp;#8217;t normally use&amp;#8211;if we demanded perfect portability to be present in the main OPAM repository, we would&amp;#8217;t get any submissions!&lt;/p&gt;

&lt;p&gt;OCamlot automates this nicely though, by finding lots of portability bugs automatically, and maintainers are by-and-large very responsive when we report the problem upstream.&lt;/p&gt;

&lt;h2 id=&quot;the_emerging_distributed_workflow&quot;&gt;The emerging distributed workflow&lt;/h2&gt;

&lt;p&gt;The big drawback to OCamlot in its current form is the amount of triage effort it puts on the OPAM maintainers. The package database has now exceeded 500 packages in just a short few months, and has over 1500 unique versions that all need build testing and more accurate constraints. The wider community has been &lt;em&gt;really&lt;/em&gt; keen to participate in helping with triage (just look at all the other people that leapt in on &lt;a href=&quot;https://github.com/OCamlPro/opam-repository/issues/1029&quot;&gt;bug #1029&lt;/a&gt;), so its our immediate priority to make OCamlot more transparent for people that want to use it to improve their own packages, and in the future also use it to test various hypotheses about all the available open-source OCaml code (see Jacques&amp;#8217; experiment with &lt;a href=&quot;http://gallium.inria.fr/blog/monomorphic_let/&quot;&gt;monomorphic let&lt;/a&gt; as an example of something that can benefit from wider automated compilation).&lt;/p&gt;

&lt;p&gt;I&amp;#8217;ll talk more about how we&amp;#8217;re solving this in my upcoming &lt;a href=&quot;http://ocaml.org/meetings/ocaml/2013/&quot;&gt;OCaml 2013 Workshop&lt;/a&gt; talk about the Platform. I don&amp;#8217;t want spoil it too much, but it involves a lovely distributed Git workflow, an enhanced &lt;a href=&quot;https://github.com/OCamlPro/opam2web&quot;&gt;opam2web&lt;/a&gt;, and a brand new metadata overlay system for OPAM that lets us enhance the package database with extra information such as statistics, portability and test results, but without polluting the main Git repository with all this extra non-essential data.&lt;/p&gt;

&lt;p&gt;If you&amp;#8217;re really curious to know right now, then you can see the outline of the new system at Amir&amp;#8217;s &lt;a href=&quot;http://amirchaudhry.com/wireframe-demos-for-ocamlorg/&quot;&gt;new ocaml.org wireframes&lt;/a&gt; blog post, where Part III contains the continuous integration workflow. A lot of infrastructure work has gone into building all of this over the summer, and now it&amp;#8217;s all starting to be deployed in a very satisfying way&amp;#8230;&lt;/p&gt;</content:encoded>
	<dc:date>2013-09-08T23:00:00+00:00</dc:date>
</item>

</rdf:RDF>

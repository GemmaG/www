<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<title>Compiler Projects</title>
<style type="text/css">
</style>
<body>
<div class="ucampas-toc right"></div>
<h1>Compiler Projects</h1>

<p>We are still defining a full set of projects for OCamlLabs, but
here are some that we wish to start off immediately.  We are <a class="icon-community" href="collaboration.html">hiring</a>
if you are interested in any of these! This list is also not intended to
be exhaustive, and there is plenty of room for research and experimentation.</p>
<p>If you are a Part-II or ACS student and want to hack on OCaml for your
project, then there are several good ideas here. Get in touch with <a href="/~am21">Alan Mycroft</a> or
<a href="/~avsm2">Anil Madhavapeddy</a> to discuss concrete projects.</p>

<hr/>

<p>We will help with development of the OCaml compiler and toolchain.
This involves two pieces: facilitating contributions to the
compiler by people outside of the Labs, by taking on the work of maintenance
and integration of changes; and also developing direct compiler improvements
Some of these improvements will be in the form of maintenance work, and others
in the form of new projects with a significant research
component, such as building an LLVM back-end, improving inlining and
whole-program optimisations to reduce garbage collection pressure, and
developing efficient multicore and multiprocess execution models that maintain
the spirit of ML-style programming.</p>

<p>Example of short-term "tactical" improvements include:</p>
<ul>
<li>Better inlining and defunctorization to reduce unnecessary allocations.</li>
<li>Improvements to the GC to reduce movement of short-lived items to the major heap.</li>
<li>Adding more compiler built-ins to improve efficiency of accessing C structures from OCaml.</li>
<li>Integrate the runtime and generated code with third-party profiling tools
such as <tt><a href="https://perf.wiki.kernel.org">perf</a></tt>, and 
<tt><a href="http://en.wikipedia.org/wiki/DTrace">dtrace</a></tt>, including
sampling-based solutions for high-throughput applications.</li>
</ul>

<p>Longer-term projects research projects that have started or are being
planned include:</p>

<h2 id="Multi-core runtime">Multi-core runtime</h2>

<p>Building an efficient multi-core garbage collector remains a challenging
research issue.  We will begin by investigating techniques that do not involve
fine-grained locking, as this has been shown to be error-prone, difficult to
maintain, and impacts sequential performance.  Instead, we prefer to isolate
threads to individual cores, with region-based heaps that can be garbage
collected separately.  This technique has been successfully demonstrated in
<a href="http://multimlton.cs.purdue.edu/mML/Welcome.html">MultiMLton</a>, system
and runtime, and we will implement it in OCaml and its large body of
third-party code.  </p>

<p><a class="icon-pdf" href="http://multimlton.cs.purdue.edu/mML/Publications_files/ParasitesTechReport.pdf">Featherweight Threads for Communication</a>,
<i>   KC Sivaramakrishnan, Lukasz Ziarek, Suresh Jagannathan</i>, Purdue Technical Report, TR-11-018, 2011</p>
<p><a class="icon-pdf" href="http://anil.recoil.org/papers/2012-resolve-fable.pdf">
The Case for Reconfigurable I/O Channels</a>,
<i>Steven Smith, Anil Madhavapeddy, Christopher Smowton, Malte Schwarzkopf, Richard Mortier, Robert M. Watson and Steven Hand</i>,
in Runtime Environments, Systems, Layering and Virtualized Environments 
(<a href="http://www.dcs.gla.ac.uk/conferences/resolve12/">RESoLVE '12</a>).</p>

<h2 id="Modern code generation">Modern code generation with LLVM and GCC</h2>

<p>OCaml has a very good native code generator for a variety of architectures,
including x86 and ARM. However, there are a number of desirable features missing,
such as <a href="http://en.wikipedia.org/wiki/Vectorization_(parallel_computing)">auto-vectorisation</a>,
and <a href="http://en.wikipedia.org/wiki/Link-time_optimization">Link Time Optimisation (LTO)</a>.
One option to explore is the efficient compilation of OCaml code into the
intermediate forms used by <a href="http://llvm.org">LLVM</a> or <a href="http://gcc.gnu.org">GCC</a>.
This would require working with those projects to ensure upstream support for
precisely-garbage-collected languages, as well as propagating type information into the
IRs.</p>

<p><a class="icon-external" href="https://github.com/elliottslaughter/rust-gc-notes">
Notes from implementing precise GC in Rust using LLVM</a>, Mozilla, summer 2012.</p>
<p><a class="icon-pdf" href="http://llvm.org/pubs/2010-03-VEE-VMKit.pdf">VMKit: A Substrate for Managed Runtime Environments</a>,
<i>N. Geoffray, G. Thomas, J. Lawall, G. Muller, and B. Folliot</i>, in the
International Conference on Virtual Execution Environments (VEE 2010).</p>

<h2 id="Linear type systems">Linear type systems</h2>

<p>Linear type systems such as quasi-linear typing to permit more static
scheduling of resources at compilation-time, and make code generation for
heterogeneous architectures such as GPGPUs, VPUs and FPGAs more feasible.
Previous systems developed by our group include Paclang, a C-like quasi-linear
language that compiled to extremely efficient code on many-core Intel network
processing engines.  We now plan to extend normal OCaml to support such
low-latency, high-throughput processing engines (at line rates in excess of
40Gbs with modern hardware such as Arista switches).</p>

<p><a class="icon-pdf" href="http://www.cl.cam.ac.uk/~am21/papers/esop04.pdf">Linear
Types for Packet Processing</a>, <i>Robert Ennals, Richard Sharp and Alan Mycroft</i>,
in proceedings of the 13th European Symposium on Programming (<a href="http://santos.cis.ksu.edu/esop2004/home.html">ESOP '04</a>).</p>
<p><a class="icon-pdf" href="http://gallium.inria.fr/~fpottier/publis/mezzo-tutorial.pdf">Programming with Permissions: an introduction to Mezzo</a>,
Francois Pottier and Jonathan Protzenko, 2012.</p>
<p><a class="icon-pdf" href="http://www.cs.washington.edu/education/courses/cse590p/01wi/quasi-linear-popl.pdf">Quasi-linear Types</a>,
<i>Naoki Kobayashi</i>, in the proceedings of the 26th ACM SIGPLAN-SIGACT Symposium on Principles of Programming Languages (POPL '99).</p>

<p><b>Contact</b>: Alan Mycroft, Anil Madhavapeddy, Raphael Proust</p>

<h2 id="Concurrency and parallelism">Concurrency and parallelism</h2>

<p>We will investigate modern concurrency and parallelism primitives to allow
effective use of emerging parallel architectures. The JoCaml extension is a
good step in this direction, and we plan to optimise its implementation further
to make use of faster transports where possible (such as shared memory for
local communication). In doing so, we will add analyses that make the compiler
more aware of the program's communication pattern. These open up further
possibilities such as reducing the total number of messages sent, and targeting
data parallel hardware such as GPGPUs.</p>

<p>Erlang has demonstrated that isolated shared-state and message passing can
be used to construct very scalable and reliable distributed systems. However,
the language has several drawbacks, including a weak type system and slow
single-core performance.  We will develop an actor system for OCaml which
provides all the components required to deploy an ErlangOTP-like system, but
with the statically-type-checked advantages of OCaml.  These components include
a distributed database (based on Arakoon, a pure OCaml k/v store), a
hierarchical name service, and web-based debugging infrastructure.</p>

<p><a class="icon-pdf" href="http://www.cl.cam.ac.uk/~dgm36/publications/2011-murray2011ciel.pdf">Ciel: a universal execution engine for distributed data-flow computing</a>,
<i>Derek G. Murray, Malte Schwarzkopf, Christopher Smowton, Steven Smith, Anil Madhavapeddy and Steven Hand</i>,
in proceedings of USENIX <a href="http://static.usenix.org/event/nsdi11/cfp/">NSDI 2011</a>, March 2011.</p>
<p><a class="icon-external" href="http://ambassadortothecomputers.blogspot.com/2010/05/how-froc-works.html">How FROC works</a>, Jake Donham, May 2010.</p>
<p><a class="icon-pdf" href="http://hal.inria.fr/inria-00166125/fr/">Programming in JoCaml</a>, Inria research report 6261.</p>
<p><a class="icon-pdf" href="http://thomas.gazagnaire.org/pub/GH09.pdf">OXenstored: An Efficient Hierarchical and Transactional Database using Functional Programming with Reference Cell Comparisons</a>, <i>Thomas Gazagnaire Vincent Hanquez</i>, ICFP 2009.</p>

<h2 id="Types for cross-compilation">Types for Cross-Compilation</h2>

<p>Increasing number of applications are targetting heterogenous execution
environments such as server-side, client-side, GPU, embedded and web.  This is
supported by a number of OCaml compiler backends (JavaScript, Java, ARM, LLVM)
and libraries allowing interoperability. In such a scenario, certain parts of
code may be compiled only for certain platform-specific environments, but some
can be safely shared. We plan to extend the OCaml type system in order to track
execution environments for which an expression can be compiled, and simplify
writing code that cross-compiles for multiple platforms and diverse execution
environments.  </p>

<p><a class="icon-pdf" href="http://groups.inf.ed.ac.uk/links/papers/links-fmco06.pdf">Links: web programming without tiers</a>, <i>Ezra Cooper, Sam Lindley, Philip Wadler, and Jeremy Yallop</i>, 2006.</p>
<p><a class="icon-pdf" href="http://www.cs.cmu.edu/~rwh/papers/ml5/tgc.pdf">Type-safe distributed programming with ML5</a>, <i>Tom Murphy VII, Karl Crary and Robert Harper</i>, 2007</p>

<p><b>Contact:</b> Tomas Petricek</p>

</body>
